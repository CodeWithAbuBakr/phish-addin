/*! For license information please see taskpane.js.LICENSE.txt */
"use strict";(self.webpackChunkoffice_addin_taskpane_react=self.webpackChunkoffice_addin_taskpane_react||[]).push([[926],{3072:function(e,t){var r="function"==typeof Symbol&&Symbol.for,n=r?Symbol.for("react.element"):60103,o=r?Symbol.for("react.portal"):60106,i=r?Symbol.for("react.fragment"):60107,a=r?Symbol.for("react.strict_mode"):60108,s=r?Symbol.for("react.profiler"):60114,c=r?Symbol.for("react.provider"):60109,l=r?Symbol.for("react.context"):60110,u=r?Symbol.for("react.async_mode"):60111,d=r?Symbol.for("react.concurrent_mode"):60111,h=r?Symbol.for("react.forward_ref"):60112,p=r?Symbol.for("react.suspense"):60113,f=r?Symbol.for("react.suspense_list"):60120,g=r?Symbol.for("react.memo"):60115,m=r?Symbol.for("react.lazy"):60116,y=r?Symbol.for("react.block"):60121,v=r?Symbol.for("react.fundamental"):60117,b=r?Symbol.for("react.responder"):60118,w=r?Symbol.for("react.scope"):60119;function C(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case u:case d:case i:case s:case a:case p:return e;default:switch(e=e&&e.$$typeof){case l:case h:case m:case g:case c:return e;default:return t}}case o:return t}}}function A(e){return C(e)===d}t.AsyncMode=u,t.ConcurrentMode=d,t.ContextConsumer=l,t.ContextProvider=c,t.Element=n,t.ForwardRef=h,t.Fragment=i,t.Lazy=m,t.Memo=g,t.Portal=o,t.Profiler=s,t.StrictMode=a,t.Suspense=p,t.isAsyncMode=function(e){return A(e)||C(e)===u},t.isConcurrentMode=A,t.isContextConsumer=function(e){return C(e)===l},t.isContextProvider=function(e){return C(e)===c},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return C(e)===h},t.isFragment=function(e){return C(e)===i},t.isLazy=function(e){return C(e)===m},t.isMemo=function(e){return C(e)===g},t.isPortal=function(e){return C(e)===o},t.isProfiler=function(e){return C(e)===s},t.isStrictMode=function(e){return C(e)===a},t.isSuspense=function(e){return C(e)===p},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===i||e===d||e===s||e===a||e===p||e===f||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===g||e.$$typeof===c||e.$$typeof===l||e.$$typeof===h||e.$$typeof===v||e.$$typeof===b||e.$$typeof===w||e.$$typeof===y)},t.typeOf=C},4146:function(e,t,r){var n=r(73404),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function c(e){return n.isMemo(e)?a:s[e.$$typeof]||o}s[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[n.Memo]=a;var l=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,r,n){if("string"!=typeof r){if(f){var o=p(r);o&&o!==f&&e(t,o,n)}var a=u(r);d&&(a=a.concat(d(r)));for(var s=c(t),g=c(r),m=0;m<a.length;++m){var y=a[m];if(!(i[y]||n&&n[y]||g&&g[y]||s&&s[y])){var v=h(r,y);try{l(t,y,v)}catch(e){}}}}return t}},5338:function(e,t,r){var n=r(40961);t.H=n.createRoot,n.hydrateRoot},6774:function(e,t){Symbol.for("react.transitional.element"),Symbol.for("react.portal");var r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler");Symbol.for("react.provider");var i=Symbol.for("react.consumer"),a=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),l=Symbol.for("react.suspense_list"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),h=(Symbol.for("react.view_transition"),Symbol.for("react.client.reference"));t.Hy=function(e){return"string"==typeof e||"function"==typeof e||e===r||e===o||e===n||e===c||e===l||"object"==typeof e&&null!==e&&(e.$$typeof===d||e.$$typeof===u||e.$$typeof===a||e.$$typeof===i||e.$$typeof===s||e.$$typeof===h||void 0!==e.getModuleId)}},10540:function(e){e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},16069:function(e,t){Object.prototype.toString},21020:function(e,t,r){var n=r(96540),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,r){var n,i={},l=null,u=null;for(n in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,n)&&!c.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===i[n]&&(i[n]=t[n]);return{$$typeof:o,type:e,key:l,ref:u,props:i,_owner:s.current}}t.Fragment=i,t.jsx=l,t.jsxs=l},22799:function(e,t){if("function"==typeof Symbol&&Symbol.for){var r=Symbol.for;r("react.element"),r("react.portal"),r("react.fragment"),r("react.strict_mode"),r("react.profiler"),r("react.provider"),r("react.context"),r("react.forward_ref"),r("react.suspense"),r("react.suspense_list"),r("react.memo"),r("react.lazy"),r("react.block"),r("react.server.block"),r("react.fundamental"),r("react.debug_trace_mode"),r("react.legacy_hidden")}},39046:function(){},41113:function(e){e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},44363:function(e,t,r){r(22799)},55056:function(e,t,r){e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},56839:function(e,t,r){var n=r(96540),o=r.t(n,2),i=r(5338),a=(r(16069),r(64583).Promise);function s(e={}){let t,{initialEntries:r=["/"],initialIndex:n,v5Compat:o=!1}=e;t=r.map(((e,t)=>p(e,"string"==typeof e?null:e.state,0===t?"default":void 0)));let i=c(null==n?t.length-1:n),a="POP",s=null;function c(e){return Math.min(Math.max(e,0),t.length-1)}function h(){return t[i]}function p(e,r=null,n){let o=function(e,t,r=null,n){return{pathname:"string"==typeof e?e:e.pathname,search:"",hash:"",..."string"==typeof t?d(t):t,state:r,key:t&&t.key||n||Math.random().toString(36).substring(2,10)}}(t?h().pathname:"/",e,r,n);return l("/"===o.pathname.charAt(0),`relative pathnames are not supported in memory history: ${JSON.stringify(e)}`),o}function f(e){return"string"==typeof e?e:u(e)}return{get index(){return i},get action(){return a},get location(){return h()},createHref:f,createURL(e){return new URL(f(e),"http://localhost")},encodeLocation(e){let t="string"==typeof e?d(e):e;return{pathname:t.pathname||"",search:t.search||"",hash:t.hash||""}},push(e,r){a="PUSH";let n=p(e,r);i+=1,t.splice(i,t.length,n),o&&s&&s({action:a,location:n,delta:1})},replace(e,r){a="REPLACE";let n=p(e,r);t[i]=n,o&&s&&s({action:a,location:n,delta:0})},go(e){a="POP";let r=c(i+e),n=t[r];i=r,s&&s({action:a,location:n,delta:e})},listen(e){return s=e,()=>{s=null}}}}function c(e,t){if(!1===e||null==e)throw new Error(t)}function l(e,t){if(!e){"undefined"!=typeof console&&console.warn(t);try{throw new Error(t)}catch(e){}}}function u({pathname:e="/",search:t="",hash:r=""}){return t&&"?"!==t&&(e+="?"===t.charAt(0)?t:"?"+t),r&&"#"!==r&&(e+="#"===r.charAt(0)?r:"#"+r),e}function d(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function h(e,t,r="/"){return function(e,t,r,n){let o=I(("string"==typeof t?d(t):t).pathname||"/",r);if(null==o)return null;let i=p(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){return e.length===t.length&&e.slice(0,-1).every(((e,r)=>e===t[r]))?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(i);let a=null;for(let e=0;null==a&&e<i.length;++e){let t=T(o);a=k(i[e],t,n)}return a}(e,t,r,!1)}function p(e,t=[],r=[],n=""){let o=(e,o,i)=>{let a={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:o,route:e};a.relativePath.startsWith("/")&&(c(a.relativePath.startsWith(n),`Absolute route path "${a.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),a.relativePath=a.relativePath.slice(n.length));let s=P([n,a.relativePath]),l=r.concat(a);e.children&&e.children.length>0&&(c(!0!==e.index,`Index routes must not have child routes. Please remove all child routes from route path "${s}".`),p(e.children,t,l,s)),(null!=e.path||e.index)&&t.push({path:s,score:A(s,e.index),routesMeta:l})};return e.forEach(((e,t)=>{if(""!==e.path&&e.path?.includes("?"))for(let r of f(e.path))o(e,t,r);else o(e,t)})),t}function f(e){let t=e.split("/");if(0===t.length)return[];let[r,...n]=t,o=r.endsWith("?"),i=r.replace(/\?$/,"");if(0===n.length)return o?[i,""]:[i];let a=f(n.join("/")),s=[];return s.push(...a.map((e=>""===e?i:[i,e].join("/")))),o&&s.push(...a),s.map((t=>e.startsWith("/")&&""===t?"/":t))}new WeakMap;var g=/^:[\w-]+$/,m=3,y=2,v=1,b=10,w=-2,C=e=>"*"===e;function A(e,t){let r=e.split("/"),n=r.length;return r.some(C)&&(n+=w),t&&(n+=y),r.filter((e=>!C(e))).reduce(((e,t)=>e+(g.test(t)?m:""===t?v:b)),n)}function k(e,t,r=!1){let{routesMeta:n}=e,o={},i="/",a=[];for(let e=0;e<n.length;++e){let s=n[e],c=e===n.length-1,l="/"===i?t:t.slice(i.length)||"/",u=S({path:s.relativePath,caseSensitive:s.caseSensitive,end:c},l),d=s.route;if(!u&&c&&r&&!n[n.length-1].route.index&&(u=S({path:s.relativePath,caseSensitive:s.caseSensitive,end:!1},l)),!u)return null;Object.assign(o,u.params),a.push({params:o,pathname:P([i,u.pathname]),pathnameBase:R(P([i,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(i=P([i,u.pathnameBase]))}return a}function S(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=function(e,t=!1,r=!0){l("*"===e||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,r)=>(n.push({paramName:t,isOptional:null!=r}),r?"/?([^\\/]+)?":"/([^\\/]+)")));return e.endsWith("*")?(n.push({paramName:"*"}),o+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?o+="\\/*$":""!==e&&"/"!==e&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),n]}(e.path,e.caseSensitive,e.end),o=t.match(r);if(!o)return null;let i=o[0],a=i.replace(/(.)\/+$/,"$1"),s=o.slice(1);return{params:n.reduce(((e,{paramName:t,isOptional:r},n)=>{if("*"===t){let e=s[n]||"";a=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const o=s[n];return e[t]=r&&!o?void 0:(o||"").replace(/%2F/g,"/"),e}),{}),pathname:i,pathnameBase:a,pattern:e}}function T(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return l(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function I(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&"/"!==n?null:e.slice(r)||"/"}function x(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function _(e){let t=function(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}(e);return t.map(((e,r)=>r===t.length-1?e.pathname:e.pathnameBase))}function E(e,t,r,n=!1){let o;"string"==typeof e?o=d(e):(o={...e},c(!o.pathname||!o.pathname.includes("?"),x("?","pathname","search",o)),c(!o.pathname||!o.pathname.includes("#"),x("#","pathname","hash",o)),c(!o.search||!o.search.includes("#"),x("#","search","hash",o)));let i,a=""===e||""===o.pathname,s=a?"/":o.pathname;if(null==s)i=r;else{let e=t.length-1;if(!n&&s.startsWith("..")){let t=s.split("/");for(;".."===t[0];)t.shift(),e-=1;o.pathname=t.join("/")}i=e>=0?t[e]:"/"}let l=function(e,t="/"){let{pathname:r,search:n="",hash:o=""}="string"==typeof e?d(e):e,i=r?r.startsWith("/")?r:function(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)})),r.length>1?r.join("/"):"/"}(r,t):t;return{pathname:i,search:O(n),hash:M(o)}}(o,i),u=s&&"/"!==s&&s.endsWith("/"),h=(a||"."===s)&&r.endsWith("/");return l.pathname.endsWith("/")||!u&&!h||(l.pathname+="/"),l}var P=e=>e.join("/").replace(/\/\/+/g,"/"),R=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),O=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",M=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function N(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}var B=["POST","PUT","PATCH","DELETE"],L=(new Set(B),["GET",...B]);new Set(L),Symbol("ResetLoaderData");var H=n.createContext(null);H.displayName="DataRouter";var $=n.createContext(null);$.displayName="DataRouterState";var q=n.createContext({isTransitioning:!1});q.displayName="ViewTransition",n.createContext(new Map).displayName="Fetchers",n.createContext(null).displayName="Await";var F=n.createContext(null);F.displayName="Navigation";var D=n.createContext(null);D.displayName="Location";var U=n.createContext({outlet:null,matches:[],isDataRoute:!1});U.displayName="Route";var j=n.createContext(null);function z(){return null!=n.useContext(D)}function K(){return c(z(),"useLocation() may be used only in the context of a <Router> component."),n.useContext(D).location}j.displayName="RouteError";var W="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function G(e){n.useContext(F).static||n.useLayoutEffect(e)}function V(){let{isDataRoute:e}=n.useContext(U);return e?function(){let{router:e}=function(e){let t=n.useContext(H);return c(t,te(e)),t}("useNavigate"),t=re("useNavigate"),r=n.useRef(!1);G((()=>{r.current=!0}));let o=n.useCallback((async(n,o={})=>{l(r.current,W),r.current&&("number"==typeof n?e.navigate(n):await e.navigate(n,{fromRouteId:t,...o}))}),[e,t]);return o}():function(){c(z(),"useNavigate() may be used only in the context of a <Router> component.");let e=n.useContext(H),{basename:t,navigator:r}=n.useContext(F),{matches:o}=n.useContext(U),{pathname:i}=K(),a=JSON.stringify(_(o)),s=n.useRef(!1);G((()=>{s.current=!0}));let u=n.useCallback(((n,o={})=>{if(l(s.current,W),!s.current)return;if("number"==typeof n)return void r.go(n);let c=E(n,JSON.parse(a),i,"path"===o.relative);null==e&&"/"!==t&&(c.pathname="/"===c.pathname?t:P([t,c.pathname])),(o.replace?r.replace:r.push)(c,o.state,o)}),[t,r,a,i,e]);return u}()}function Y(e,{relative:t}={}){let{matches:r}=n.useContext(U),{pathname:o}=K(),i=JSON.stringify(_(r));return n.useMemo((()=>E(e,JSON.parse(i),o,"path"===t)),[e,i,o,t])}function Q(e,t,r,o){c(z(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=n.useContext(F),{matches:a}=n.useContext(U),s=a[a.length-1],u=s?s.params:{},p=s?s.pathname:"/",f=s?s.pathnameBase:"/",g=s&&s.route;{let e=g&&g.path||"";oe(p,!g||e.endsWith("*")||e.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${e}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="${e}"> to <Route path="${"/"===e?"*":`${e}/*`}">.`)}let m,y=K();if(t){let e="string"==typeof t?d(t):t;c("/"===f||e.pathname?.startsWith(f),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${e.pathname}" was given in the \`location\` prop.`),m=e}else m=y;let v=m.pathname||"/",b=v;if("/"!==f){let e=f.replace(/^\//,"").split("/");b="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let w=h(e,{pathname:b});l(g||null!=w,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),l(null==w||void 0!==w[w.length-1].route.element||void 0!==w[w.length-1].route.Component||void 0!==w[w.length-1].route.lazy,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let C=function(e,t=[],r=null){if(null==e){if(!r)return null;if(r.errors)e=r.matches;else{if(0!==t.length||r.initialized||!(r.matches.length>0))return null;e=r.matches}}let o=e,i=r?.errors;if(null!=i){let e=o.findIndex((e=>e.route.id&&void 0!==i?.[e.route.id]));c(e>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),o=o.slice(0,Math.min(o.length,e+1))}let a=!1,s=-1;if(r)for(let e=0;e<o.length;e++){let t=o[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(s=e),t.route.id){let{loaderData:e,errors:n}=r,i=t.route.loader&&!e.hasOwnProperty(t.route.id)&&(!n||void 0===n[t.route.id]);if(t.route.lazy||i){a=!0,o=s>=0?o.slice(0,s+1):[o[0]];break}}}return o.reduceRight(((e,c,l)=>{let u,d=!1,h=null,p=null;r&&(u=i&&c.route.id?i[c.route.id]:void 0,h=c.route.errorElement||X,a&&(s<0&&0===l?(oe("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,p=null):s===l&&(d=!0,p=c.route.hydrateFallbackElement||null)));let f=t.concat(o.slice(0,l+1)),g=()=>{let t;return t=u?h:d?p:c.route.Component?n.createElement(c.route.Component,null):c.route.element?c.route.element:e,n.createElement(ee,{match:c,routeContext:{outlet:e,matches:f,isDataRoute:null!=r},children:t})};return r&&(c.route.ErrorBoundary||c.route.errorElement||0===l)?n.createElement(Z,{location:r.location,revalidation:r.revalidation,component:h,error:u,children:g(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):g()}),null)}(w&&w.map((e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:P([f,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?f:P([f,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),a,r,o);return t&&C?n.createElement(D.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...m},navigationType:"POP"}},C):C}function J(){let e=function(){let e=n.useContext(j),t=function(e){let t=n.useContext($);return c(t,te(e)),t}("useRouteError"),r=re("useRouteError");return void 0!==e?e:t.errors?.[r]}(),t=N(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,o="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:o},a={padding:"2px 4px",backgroundColor:o},s=null;return console.error("Error handled by React Router default ErrorBoundary:",e),s=n.createElement(n.Fragment,null,n.createElement("p",null,"💿 Hey developer 👋"),n.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",n.createElement("code",{style:a},"ErrorBoundary")," or"," ",n.createElement("code",{style:a},"errorElement")," prop on your route.")),n.createElement(n.Fragment,null,n.createElement("h2",null,"Unexpected Application Error!"),n.createElement("h3",{style:{fontStyle:"italic"}},t),r?n.createElement("pre",{style:i},r):null,s)}n.createContext(null);var X=n.createElement(J,null),Z=class extends n.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?n.createElement(U.Provider,{value:this.props.routeContext},n.createElement(j.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function ee({routeContext:e,match:t,children:r}){let o=n.useContext(H);return o&&o.static&&o.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=t.route.id),n.createElement(U.Provider,{value:e},r)}function te(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function re(e){let t=function(e){let t=n.useContext(U);return c(t,te(e)),t}(e),r=t.matches[t.matches.length-1];return c(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}var ne={};function oe(e,t,r){t||ne[e]||(ne[e]=!0,l(!1,r))}function ie({basename:e,children:t,initialEntries:r,initialIndex:o}){let i=n.useRef();null==i.current&&(i.current=s({initialEntries:r,initialIndex:o,v5Compat:!0}));let a=i.current,[c,l]=n.useState({action:a.action,location:a.location}),u=n.useCallback((e=>{n.startTransition((()=>l(e)))}),[l]);return n.useLayoutEffect((()=>a.listen(u)),[a,u]),n.createElement(se,{basename:e,children:t,location:c.location,navigationType:c.action,navigator:a})}function ae(e){c(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function se({basename:e="/",children:t=null,location:r,navigationType:o="POP",navigator:i,static:a=!1}){c(!z(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=e.replace(/^\/*/,"/"),u=n.useMemo((()=>({basename:s,navigator:i,static:a,future:{}})),[s,i,a]);"string"==typeof r&&(r=d(r));let{pathname:h="/",search:p="",hash:f="",state:g=null,key:m="default"}=r,y=n.useMemo((()=>{let e=I(h,s);return null==e?null:{location:{pathname:e,search:p,hash:f,state:g,key:m},navigationType:o}}),[s,h,p,f,g,m,o]);return l(null!=y,`<Router basename="${s}"> is not able to match the URL "${h}${p}${f}" because it does not start with the basename, so the <Router> won't render anything.`),null==y?null:n.createElement(F.Provider,{value:u},n.createElement(D.Provider,{children:t,value:y}))}function ce({children:e,location:t}){return Q(le(e),t)}function le(e,t=[]){let r=[];return n.Children.forEach(e,((e,o)=>{if(!n.isValidElement(e))return;let i=[...t,o];if(e.type===n.Fragment)return void r.push.apply(r,le(e.props.children,i));c(e.type===ae,`[${"string"==typeof e.type?e.type:e.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),c(!e.props.index||!e.props.children,"An index route cannot have child routes.");let a={id:e.props.id||i.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=le(e.props.children,i)),r.push(a)})),r}n.memo((function({routes:e,future:t,state:r}){return Q(e,void 0,r,t)})),n.Component;var ue="get",de="application/x-www-form-urlencoded";function he(e){return null!=e&&"string"==typeof e.tagName}var pe=null,fe=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function ge(e){return null==e||fe.has(e)?e:(l(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${de}"`),null)}function me(e,t){if(!1===e||null==e)throw new Error(t)}function ye(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"==typeof e.imageSrcSet&&"string"==typeof e.imageSizes:"string"==typeof e.rel&&"string"==typeof e.href)}function ve(e,t,r,n,o,i){let a=(e,t)=>!r[t]||e.route.id!==r[t].route.id,s=(e,t)=>r[t].pathname!==e.pathname||r[t].route.path?.endsWith("*")&&r[t].params["*"]!==e.params["*"];return"assets"===i?t.filter(((e,t)=>a(e,t)||s(e,t))):"data"===i?t.filter(((t,i)=>{let c=n.routes[t.route.id];if(!c||!c.hasLoader)return!1;if(a(t,i)||s(t,i))return!0;if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"==typeof n)return n}return!0})):[]}function be(e,t,{includeHydrateFallback:r}={}){return n=e.map((e=>{let n=t.routes[e.route.id];if(!n)return[];let o=[n.module];return n.clientActionModule&&(o=o.concat(n.clientActionModule)),n.clientLoaderModule&&(o=o.concat(n.clientLoaderModule)),r&&n.hydrateFallbackModule&&(o=o.concat(n.hydrateFallbackModule)),n.imports&&(o=o.concat(n.imports)),o})).flat(1),[...new Set(n)];var n}Object.getOwnPropertyNames(Object.prototype).sort().join("\0"),"undefined"!=typeof window?window:"undefined"!=typeof globalThis&&globalThis,Symbol("SingleFetchRedirect");function we(){let e=n.useContext(H);return me(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Ce(){let e=n.useContext($);return me(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}n.Component;var Ae=n.createContext(void 0);function ke(){let e=n.useContext(Ae);return me(e,"You must render this element inside a <HydratedRouter> element"),e}function Se(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function Te({page:e,...t}){let{router:r}=we(),o=n.useMemo((()=>h(r.routes,e,r.basename)),[r.routes,e,r.basename]);return o?n.createElement(xe,{page:e,matches:o,...t}):null}function Ie(e){let{manifest:t,routeModules:r}=ke(),[o,i]=n.useState([]);return n.useEffect((()=>{let n=!1;return async function(e,t,r){return function(e,t){let r=new Set,n=new Set(t);return e.reduce(((e,o)=>{if(t&&(null==(i=o)||"string"!=typeof i.page)&&"script"===o.as&&o.href&&n.has(o.href))return e;var i;let a=JSON.stringify(function(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}(o));return r.has(a)||(r.add(a),e.push({key:a,link:o})),e}),[])}((await a.all(e.map((async e=>{let n=t.routes[e.route.id];if(n){let e=await async function(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new a((()=>{}))}}(n,r);return e.links?e.links():[]}return[]})))).flat(1).filter(ye).filter((e=>"stylesheet"===e.rel||"preload"===e.rel)).map((e=>"stylesheet"===e.rel?{...e,rel:"prefetch",as:"style"}:{...e,rel:"prefetch"})))}(e,t,r).then((e=>{n||i(e)})),()=>{n=!0}}),[e,t,r]),o}function xe({page:e,matches:t,...r}){let o=K(),{manifest:i,routeModules:a}=ke(),{basename:s}=we(),{loaderData:c,matches:l}=Ce(),u=n.useMemo((()=>ve(e,t,l,i,o,"data")),[e,t,l,i,o]),d=n.useMemo((()=>ve(e,t,l,i,o,"assets")),[e,t,l,i,o]),h=n.useMemo((()=>{if(e===o.pathname+o.search+o.hash)return[];let r=new Set,n=!1;if(t.forEach((e=>{let t=i.routes[e.route.id];t&&t.hasLoader&&(!u.some((t=>t.route.id===e.route.id))&&e.route.id in c&&a[e.route.id]?.shouldRevalidate||t.hasClientLoader?n=!0:r.add(e.route.id))})),0===r.size)return[];let l=function(e,t){let r="string"==typeof e?new URL(e,"undefined"==typeof window?"server://singlefetch/":window.location.origin):e;return"/"===r.pathname?r.pathname="_root.data":t&&"/"===I(r.pathname,t)?r.pathname=`${t.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}(e,s);return n&&r.size>0&&l.searchParams.set("_routes",t.filter((e=>r.has(e.route.id))).map((e=>e.route.id)).join(",")),[l.pathname+l.search]}),[s,c,o,i,u,t,e,a]),p=n.useMemo((()=>be(d,i)),[d,i]),f=Ie(d);return n.createElement(n.Fragment,null,h.map((e=>n.createElement("link",{key:e,rel:"prefetch",as:"fetch",href:e,...r}))),p.map((e=>n.createElement("link",{key:e,rel:"modulepreload",href:e,...r}))),f.map((({key:e,link:t})=>n.createElement("link",{key:e,...t}))))}Ae.displayName="FrameworkContext";function _e(...e){return t=>{e.forEach((e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)}))}}var Ee="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;try{Ee&&(window.__reactRouterVersion="7.6.1")}catch(e){}var Pe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Re=n.forwardRef((function({onClick:e,discover:t="render",prefetch:r="none",relative:o,reloadDocument:i,replace:a,state:s,target:d,to:h,preventScrollReset:p,viewTransition:f,...g},m){let y,{basename:v}=n.useContext(F),b="string"==typeof h&&Pe.test(h),w=!1;if("string"==typeof h&&b&&(y=h,Ee))try{let e=new URL(window.location.href),t=h.startsWith("//")?new URL(e.protocol+h):new URL(h),r=I(t.pathname,v);t.origin===e.origin&&null!=r?h=r+t.search+t.hash:w=!0}catch(e){l(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let C=function(e,{relative:t}={}){c(z(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:o}=n.useContext(F),{hash:i,pathname:a,search:s}=Y(e,{relative:t}),l=a;return"/"!==r&&(l="/"===a?r:P([r,a])),o.createHref({pathname:l,search:s,hash:i})}(h,{relative:o}),[A,k,S]=function(e,t){let r=n.useContext(Ae),[o,i]=n.useState(!1),[a,s]=n.useState(!1),{onFocus:c,onBlur:l,onMouseEnter:u,onMouseLeave:d,onTouchStart:h}=t,p=n.useRef(null);n.useEffect((()=>{if("render"===e&&s(!0),"viewport"===e){let e=new IntersectionObserver((e=>{e.forEach((e=>{s(e.isIntersecting)}))}),{threshold:.5});return p.current&&e.observe(p.current),()=>{e.disconnect()}}}),[e]),n.useEffect((()=>{if(o){let e=setTimeout((()=>{s(!0)}),100);return()=>{clearTimeout(e)}}}),[o]);let f=()=>{i(!0)},g=()=>{i(!1),s(!1)};return r?"intent"!==e?[a,p,{}]:[a,p,{onFocus:Se(c,f),onBlur:Se(l,g),onMouseEnter:Se(u,f),onMouseLeave:Se(d,g),onTouchStart:Se(h,f)}]:[!1,p,{}]}(r,g),T=function(e,{target:t,replace:r,state:o,preventScrollReset:i,relative:a,viewTransition:s}={}){let c=V(),l=K(),d=Y(e,{relative:a});return n.useCallback((n=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(n,t)){n.preventDefault();let t=void 0!==r?r:u(l)===u(d);c(e,{replace:t,state:o,preventScrollReset:i,relative:a,viewTransition:s})}}),[l,c,d,r,o,t,e,i,a,s])}(h,{replace:a,state:s,target:d,preventScrollReset:p,relative:o,viewTransition:f}),x=n.createElement("a",{...g,...S,href:y||C,onClick:w||i?e:function(t){e&&e(t),t.defaultPrevented||T(t)},ref:_e(m,k),target:d,"data-discover":b||"render"!==t?void 0:"true"});return A&&!b?n.createElement(n.Fragment,null,x,n.createElement(Te,{page:C})):x}));Re.displayName="Link";var Oe=n.forwardRef((function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:o=!1,style:i,to:a,viewTransition:s,children:l,...u},d){let h=Y(a,{relative:u.relative}),p=K(),f=n.useContext($),{navigator:g,basename:m}=n.useContext(F),y=null!=f&&function(e,t={}){let r=n.useContext(q);c(null!=r,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:o}=Ne("useViewTransitionState"),i=Y(e,{relative:t.relative});if(!r.isTransitioning)return!1;let a=I(r.currentLocation.pathname,o)||r.currentLocation.pathname,s=I(r.nextLocation.pathname,o)||r.nextLocation.pathname;return null!=S(i.pathname,s)||null!=S(i.pathname,a)}(h)&&!0===s,v=g.encodeLocation?g.encodeLocation(h).pathname:h.pathname,b=p.pathname,w=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;t||(b=b.toLowerCase(),w=w?w.toLowerCase():null,v=v.toLowerCase()),w&&m&&(w=I(w,m)||w);const C="/"!==v&&v.endsWith("/")?v.length-1:v.length;let A,k=b===v||!o&&b.startsWith(v)&&"/"===b.charAt(C),T=null!=w&&(w===v||!o&&w.startsWith(v)&&"/"===w.charAt(v.length)),x={isActive:k,isPending:T,isTransitioning:y},_=k?e:void 0;A="function"==typeof r?r(x):[r,k?"active":null,T?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let E="function"==typeof i?i(x):i;return n.createElement(Re,{...u,"aria-current":_,className:A,ref:d,style:E,to:a,viewTransition:s},"function"==typeof l?l(x):l)}));Oe.displayName="NavLink";var Me=n.forwardRef((({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:o,replace:i,state:a,method:s=ue,action:l,onSubmit:d,relative:h,preventScrollReset:p,viewTransition:f,...g},m)=>{let y=function(){let{router:e}=Ne("useSubmit"),{basename:t}=n.useContext(F),r=re("useRouteId");return n.useCallback((async(n,o={})=>{let{action:i,method:a,encType:s,formData:c,body:l}=function(e,t){let r,n,o,i,a;if(he(s=e)&&"form"===s.tagName.toLowerCase()){let a=e.getAttribute("action");n=a?I(a,t):null,r=e.getAttribute("method")||ue,o=ge(e.getAttribute("enctype"))||de,i=new FormData(e)}else if(function(e){return he(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return he(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let a=e.form;if(null==a)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let s=e.getAttribute("formaction")||a.getAttribute("action");if(n=s?I(s,t):null,r=e.getAttribute("formmethod")||a.getAttribute("method")||ue,o=ge(e.getAttribute("formenctype"))||ge(a.getAttribute("enctype"))||de,i=new FormData(a,e),!function(){if(null===pe)try{new FormData(document.createElement("form"),0),pe=!1}catch(e){pe=!0}return pe}()){let{name:t,type:r,value:n}=e;if("image"===r){let e=t?`${t}.`:"";i.append(`${e}x`,"0"),i.append(`${e}y`,"0")}else t&&i.append(t,n)}}else{if(he(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=ue,n=null,o=de,a=e}var s;return i&&"text/plain"===o&&(a=i,i=void 0),{action:n,method:r.toLowerCase(),encType:o,formData:i,body:a}}(n,t);if(!1===o.navigate){let t=o.fetcherKey||Le();await e.fetch(t,r,o.action||i,{preventScrollReset:o.preventScrollReset,formData:c,body:l,formMethod:o.method||a,formEncType:o.encType||s,flushSync:o.flushSync})}else await e.navigate(o.action||i,{preventScrollReset:o.preventScrollReset,formData:c,body:l,formMethod:o.method||a,formEncType:o.encType||s,replace:o.replace,state:o.state,fromRouteId:r,flushSync:o.flushSync,viewTransition:o.viewTransition})}),[e,t,r])}(),v=function(e,{relative:t}={}){let{basename:r}=n.useContext(F),o=n.useContext(U);c(o,"useFormAction must be used inside a RouteContext");let[i]=o.matches.slice(-1),a={...Y(e||".",{relative:t})},s=K();if(null==e){a.search=s.search;let e=new URLSearchParams(a.search),t=e.getAll("index");if(t.some((e=>""===e))){e.delete("index"),t.filter((e=>e)).forEach((t=>e.append("index",t)));let r=e.toString();a.search=r?`?${r}`:""}}return e&&"."!==e||!i.route.index||(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),"/"!==r&&(a.pathname="/"===a.pathname?r:P([r,a.pathname])),u(a)}(l,{relative:h}),b="get"===s.toLowerCase()?"get":"post",w="string"==typeof l&&Pe.test(l);return n.createElement("form",{ref:m,method:b,action:v,onSubmit:o?d:e=>{if(d&&d(e),e.defaultPrevented)return;e.preventDefault();let n=e.nativeEvent.submitter,o=n?.getAttribute("formmethod")||s;y(n||e.currentTarget,{fetcherKey:t,method:o,navigate:r,replace:i,state:a,relative:h,preventScrollReset:p,viewTransition:f})},...g,"data-discover":w||"render"!==e?void 0:"true"})}));function Ne(e){let t=n.useContext(H);return c(t,function(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}(e)),t}Me.displayName="Form";var Be=0,Le=()=>`__${String(++Be)}__`;function He(e){var t,r,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(r=He(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}var $e=function(){for(var e,t,r=0,n="",o=arguments.length;r<o;r++)(e=arguments[r])&&(t=He(e))&&(n&&(n+=" "),n+=t);return n},qe=r(6774);function Fe(e){if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)}function De(e){if(n.isValidElement(e)||(0,qe.Hy)(e)||!Fe(e))return e;const t={};return Object.keys(e).forEach((r=>{t[r]=De(e[r])})),t}function Ue(e,t,r={clone:!0}){const o=r.clone?{...e}:e;return Fe(e)&&Fe(t)&&Object.keys(t).forEach((i=>{n.isValidElement(t[i])||(0,qe.Hy)(t[i])?o[i]=t[i]:Fe(t[i])&&Object.prototype.hasOwnProperty.call(e,i)&&Fe(e[i])?o[i]=Ue(e[i],t[i],r):r.clone?o[i]=Fe(t[i])?De(t[i]):t[i]:o[i]=t[i]})),o}const je=e=>e;var ze=(()=>{let e=je;return{configure(t){e=t},generate(t){return e(t)},reset(){e=je}}})();const Ke={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function We(e,t,r="Mui"){const n=Ke[t];return n?`${r}-${n}`:`${ze.generate(e)}-${t}`}function Ge(e,t,r=void 0){const n={};for(const o in e){const i=e[o];let a="",s=!0;for(let e=0;e<i.length;e+=1){const n=i[e];n&&(a+=(!0===s?"":" ")+t(n),s=!1,r&&r[n]&&(a+=" "+r[n]))}n[o]=a}return n}function Ve(){return Ve=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ve.apply(null,arguments)}var Ye=function(){function e(e){var t=this;this._insertTag=function(e){var r;r=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,r),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var r=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{r.insertRule(e,r.cssRules.length)}catch(e){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)})),this.tags=[],this.ctr=0},e}(),Qe=Math.abs,Je=String.fromCharCode,Xe=Object.assign;function Ze(e){return e.trim()}function et(e,t,r){return e.replace(t,r)}function tt(e,t){return e.indexOf(t)}function rt(e,t){return 0|e.charCodeAt(t)}function nt(e,t,r){return e.slice(t,r)}function ot(e){return e.length}function it(e){return e.length}function at(e,t){return t.push(e),e}var st=1,ct=1,lt=0,ut=0,dt=0,ht="";function pt(e,t,r,n,o,i,a){return{value:e,root:t,parent:r,type:n,props:o,children:i,line:st,column:ct,length:a,return:""}}function ft(e,t){return Xe(pt("",null,null,"",null,null,0),e,{length:-e.length},t)}function gt(){return dt=ut>0?rt(ht,--ut):0,ct--,10===dt&&(ct=1,st--),dt}function mt(){return dt=ut<lt?rt(ht,ut++):0,ct++,10===dt&&(ct=1,st++),dt}function yt(){return rt(ht,ut)}function vt(){return ut}function bt(e,t){return nt(ht,e,t)}function wt(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Ct(e){return st=ct=1,lt=ot(ht=e),ut=0,[]}function At(e){return ht="",e}function kt(e){return Ze(bt(ut-1,It(91===e?e+2:40===e?e+1:e)))}function St(e){for(;(dt=yt())&&dt<33;)mt();return wt(e)>2||wt(dt)>3?"":" "}function Tt(e,t){for(;--t&&mt()&&!(dt<48||dt>102||dt>57&&dt<65||dt>70&&dt<97););return bt(e,vt()+(t<6&&32==yt()&&32==mt()))}function It(e){for(;mt();)switch(dt){case e:return ut;case 34:case 39:34!==e&&39!==e&&It(dt);break;case 40:41===e&&It(e);break;case 92:mt()}return ut}function xt(e,t){for(;mt()&&e+dt!==57&&(e+dt!==84||47!==yt()););return"/*"+bt(t,ut-1)+"*"+Je(47===e?e:mt())}function _t(e){for(;!wt(yt());)mt();return bt(e,ut)}var Et="-ms-",Pt="-moz-",Rt="-webkit-",Ot="comm",Mt="rule",Nt="decl",Bt="@keyframes";function Lt(e,t){for(var r="",n=it(e),o=0;o<n;o++)r+=t(e[o],o,e,t)||"";return r}function Ht(e,t,r,n){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case Nt:return e.return=e.return||e.value;case Ot:return"";case Bt:return e.return=e.value+"{"+Lt(e.children,n)+"}";case Mt:e.value=e.props.join(",")}return ot(r=Lt(e.children,n))?e.return=e.value+"{"+r+"}":""}function $t(e){return At(qt("",null,null,null,[""],e=Ct(e),0,[0],e))}function qt(e,t,r,n,o,i,a,s,c){for(var l=0,u=0,d=a,h=0,p=0,f=0,g=1,m=1,y=1,v=0,b="",w=o,C=i,A=n,k=b;m;)switch(f=v,v=mt()){case 40:if(108!=f&&58==rt(k,d-1)){-1!=tt(k+=et(kt(v),"&","&\f"),"&\f")&&(y=-1);break}case 34:case 39:case 91:k+=kt(v);break;case 9:case 10:case 13:case 32:k+=St(f);break;case 92:k+=Tt(vt()-1,7);continue;case 47:switch(yt()){case 42:case 47:at(Dt(xt(mt(),vt()),t,r),c);break;default:k+="/"}break;case 123*g:s[l++]=ot(k)*y;case 125*g:case 59:case 0:switch(v){case 0:case 125:m=0;case 59+u:-1==y&&(k=et(k,/\f/g,"")),p>0&&ot(k)-d&&at(p>32?Ut(k+";",n,r,d-1):Ut(et(k," ","")+";",n,r,d-2),c);break;case 59:k+=";";default:if(at(A=Ft(k,t,r,l,u,o,s,b,w=[],C=[],d),i),123===v)if(0===u)qt(k,t,A,A,w,i,d,s,C);else switch(99===h&&110===rt(k,3)?100:h){case 100:case 108:case 109:case 115:qt(e,A,A,n&&at(Ft(e,A,A,0,0,o,s,b,o,w=[],d),C),o,C,d,s,n?w:C);break;default:qt(k,A,A,A,[""],C,0,s,C)}}l=u=p=0,g=y=1,b=k="",d=a;break;case 58:d=1+ot(k),p=f;default:if(g<1)if(123==v)--g;else if(125==v&&0==g++&&125==gt())continue;switch(k+=Je(v),v*g){case 38:y=u>0?1:(k+="\f",-1);break;case 44:s[l++]=(ot(k)-1)*y,y=1;break;case 64:45===yt()&&(k+=kt(mt())),h=yt(),u=d=ot(b=k+=_t(vt())),v++;break;case 45:45===f&&2==ot(k)&&(g=0)}}return i}function Ft(e,t,r,n,o,i,a,s,c,l,u){for(var d=o-1,h=0===o?i:[""],p=it(h),f=0,g=0,m=0;f<n;++f)for(var y=0,v=nt(e,d+1,d=Qe(g=a[f])),b=e;y<p;++y)(b=Ze(g>0?h[y]+" "+v:et(v,/&\f/g,h[y])))&&(c[m++]=b);return pt(e,t,r,0===o?Mt:s,c,l,u)}function Dt(e,t,r){return pt(e,t,r,Ot,Je(dt),nt(e,2,-2),0)}function Ut(e,t,r,n){return pt(e,t,r,Nt,nt(e,0,n),nt(e,n+1,-1),n)}var jt=function(e,t,r){for(var n=0,o=0;n=o,o=yt(),38===n&&12===o&&(t[r]=1),!wt(o);)mt();return bt(e,ut)},zt=new WeakMap,Kt=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,r=e.parent,n=e.column===r.column&&e.line===r.line;"rule"!==r.type;)if(!(r=r.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||zt.get(r))&&!n){zt.set(e,!0);for(var o=[],i=function(e,t){return At(function(e,t){var r=-1,n=44;do{switch(wt(n)){case 0:38===n&&12===yt()&&(t[r]=1),e[r]+=jt(ut-1,t,r);break;case 2:e[r]+=kt(n);break;case 4:if(44===n){e[++r]=58===yt()?"&\f":"",t[r]=e[r].length;break}default:e[r]+=Je(n)}}while(n=mt());return e}(Ct(e),t))}(t,o),a=r.props,s=0,c=0;s<i.length;s++)for(var l=0;l<a.length;l++,c++)e.props[c]=o[s]?i[s].replace(/&\f/g,a[l]):a[l]+" "+i[s]}}},Wt=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function Gt(e,t){switch(function(e,t){return 45^rt(e,0)?(((t<<2^rt(e,0))<<2^rt(e,1))<<2^rt(e,2))<<2^rt(e,3):0}(e,t)){case 5103:return Rt+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Rt+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Rt+e+Pt+e+Et+e+e;case 6828:case 4268:return Rt+e+Et+e+e;case 6165:return Rt+e+Et+"flex-"+e+e;case 5187:return Rt+e+et(e,/(\w+).+(:[^]+)/,Rt+"box-$1$2"+Et+"flex-$1$2")+e;case 5443:return Rt+e+Et+"flex-item-"+et(e,/flex-|-self/,"")+e;case 4675:return Rt+e+Et+"flex-line-pack"+et(e,/align-content|flex-|-self/,"")+e;case 5548:return Rt+e+Et+et(e,"shrink","negative")+e;case 5292:return Rt+e+Et+et(e,"basis","preferred-size")+e;case 6060:return Rt+"box-"+et(e,"-grow","")+Rt+e+Et+et(e,"grow","positive")+e;case 4554:return Rt+et(e,/([^-])(transform)/g,"$1"+Rt+"$2")+e;case 6187:return et(et(et(e,/(zoom-|grab)/,Rt+"$1"),/(image-set)/,Rt+"$1"),e,"")+e;case 5495:case 3959:return et(e,/(image-set\([^]*)/,Rt+"$1$`$1");case 4968:return et(et(e,/(.+:)(flex-)?(.*)/,Rt+"box-pack:$3"+Et+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Rt+e+e;case 4095:case 3583:case 4068:case 2532:return et(e,/(.+)-inline(.+)/,Rt+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ot(e)-1-t>6)switch(rt(e,t+1)){case 109:if(45!==rt(e,t+4))break;case 102:return et(e,/(.+:)(.+)-([^]+)/,"$1"+Rt+"$2-$3$1"+Pt+(108==rt(e,t+3)?"$3":"$2-$3"))+e;case 115:return~tt(e,"stretch")?Gt(et(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==rt(e,t+1))break;case 6444:switch(rt(e,ot(e)-3-(~tt(e,"!important")&&10))){case 107:return et(e,":",":"+Rt)+e;case 101:return et(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Rt+(45===rt(e,14)?"inline-":"")+"box$3$1"+Rt+"$2$3$1"+Et+"$2box$3")+e}break;case 5936:switch(rt(e,t+11)){case 114:return Rt+e+Et+et(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Rt+e+Et+et(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Rt+e+Et+et(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Rt+e+Et+e+e}return e}var Vt=[function(e,t,r,n){if(e.length>-1&&!e.return)switch(e.type){case Nt:e.return=Gt(e.value,e.length);break;case Bt:return Lt([ft(e,{value:et(e.value,"@","@"+Rt)})],n);case Mt:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e){return(e=/(::plac\w+|:read-\w+)/.exec(e))?e[0]:e}(t)){case":read-only":case":read-write":return Lt([ft(e,{props:[et(t,/:(read-\w+)/,":-moz-$1")]})],n);case"::placeholder":return Lt([ft(e,{props:[et(t,/:(plac\w+)/,":"+Rt+"input-$1")]}),ft(e,{props:[et(t,/:(plac\w+)/,":-moz-$1")]}),ft(e,{props:[et(t,/:(plac\w+)/,Et+"input-$1")]})],n)}return""}))}}],Yt=function(e){var t=e.key;if("css"===t){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var n,o,i=e.stylisPlugins||Vt,a={},s=[];n=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),r=1;r<t.length;r++)a[t[r]]=!0;s.push(e)}));var c,l,u,d,h=[Ht,(d=function(e){c.insert(e)},function(e){e.root||(e=e.return)&&d(e)})],p=(l=[Kt,Wt].concat(i,h),u=it(l),function(e,t,r,n){for(var o="",i=0;i<u;i++)o+=l[i](e,t,r,n)||"";return o});o=function(e,t,r,n){c=r,function(e){Lt($t(e),p)}(e?e+"{"+t.styles+"}":t.styles),n&&(f.inserted[t.name]=!0)};var f={key:t,sheet:new Ye({key:t,container:n,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:a,registered:{},insert:o};return f.sheet.hydrate(s),f};function Qt(e,t,r){var n="";return r.split(" ").forEach((function(r){void 0!==e[r]?t.push(e[r]+";"):r&&(n+=r+" ")})),n}var Jt=function(e,t,r){var n=e.key+"-"+t.name;!1===r&&void 0===e.registered[n]&&(e.registered[n]=t.styles)},Xt=function(e,t,r){Jt(e,t,r);var n=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var o=t;do{e.insert(t===o?"."+n:"",o,e.sheet,!0),o=o.next}while(void 0!==o)}};function Zt(e){for(var t,r=0,n=0,o=e.length;o>=4;++n,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))+(59797*(t>>>16)<<16),r=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&r)+(59797*(r>>>16)<<16);switch(o){case 3:r^=(255&e.charCodeAt(n+2))<<16;case 2:r^=(255&e.charCodeAt(n+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(n)))+(59797*(r>>>16)<<16)}return(((r=1540483477*(65535&(r^=r>>>13))+(59797*(r>>>16)<<16))^r>>>15)>>>0).toString(36)}var er={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function tr(e){var t=Object.create(null);return function(r){return void 0===t[r]&&(t[r]=e(r)),t[r]}}var rr=/[A-Z]|^ms/g,nr=/_EMO_([^_]+?)_([^]*?)_EMO_/g,or=function(e){return 45===e.charCodeAt(1)},ir=function(e){return null!=e&&"boolean"!=typeof e},ar=tr((function(e){return or(e)?e:e.replace(rr,"-$&").toLowerCase()})),sr=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(nr,(function(e,t,r){return lr={name:t,styles:r,next:lr},t}))}return 1===er[e]||or(e)||"number"!=typeof t||0===t?t:t+"px"};function cr(e,t,r){if(null==r)return"";var n=r;if(void 0!==n.__emotion_styles)return n;switch(typeof r){case"boolean":return"";case"object":var o=r;if(1===o.anim)return lr={name:o.name,styles:o.styles,next:lr},o.name;var i=r;if(void 0!==i.styles){var a=i.next;if(void 0!==a)for(;void 0!==a;)lr={name:a.name,styles:a.styles,next:lr},a=a.next;return i.styles+";"}return function(e,t,r){var n="";if(Array.isArray(r))for(var o=0;o<r.length;o++)n+=cr(e,t,r[o])+";";else for(var i in r){var a=r[i];if("object"!=typeof a){var s=a;null!=t&&void 0!==t[s]?n+=i+"{"+t[s]+"}":ir(s)&&(n+=ar(i)+":"+sr(i,s)+";")}else if(!Array.isArray(a)||"string"!=typeof a[0]||null!=t&&void 0!==t[a[0]]){var c=cr(e,t,a);switch(i){case"animation":case"animationName":n+=ar(i)+":"+c+";";break;default:n+=i+"{"+c+"}"}}else for(var l=0;l<a.length;l++)ir(a[l])&&(n+=ar(i)+":"+sr(i,a[l])+";")}return n}(e,t,r);case"function":if(void 0!==e){var s=lr,c=r(e);return lr=s,cr(e,t,c)}}var l=r;if(null==t)return l;var u=t[l];return void 0!==u?u:l}var lr,ur=/label:\s*([^\s;{]+)\s*(;|$)/g;function dr(e,t,r){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var n=!0,o="";lr=void 0;var i=e[0];null==i||void 0===i.raw?(n=!1,o+=cr(r,t,i)):o+=i[0];for(var a=1;a<e.length;a++)o+=cr(r,t,e[a]),n&&(o+=i[a]);ur.lastIndex=0;for(var s,c="";null!==(s=ur.exec(o));)c+="-"+s[1];return{name:Zt(o)+c,styles:o,next:lr}}var hr=!!o.useInsertionEffect&&o.useInsertionEffect,pr=hr||function(e){return e()},fr=(hr||n.useLayoutEffect,n.createContext("undefined"!=typeof HTMLElement?Yt({key:"css"}):null)),gr=(fr.Provider,function(e){return(0,n.forwardRef)((function(t,r){var o=(0,n.useContext)(fr);return e(t,o,r)}))}),mr=n.createContext({}),yr={}.hasOwnProperty,vr="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",br=function(e){var t=e.cache,r=e.serialized,n=e.isStringTag;return Jt(t,r,n),pr((function(){return Xt(t,r,n)})),null},wr=gr((function(e,t,r){var o=e.css;"string"==typeof o&&void 0!==t.registered[o]&&(o=t.registered[o]);var i=e[vr],a=[o],s="";"string"==typeof e.className?s=Qt(t.registered,a,e.className):null!=e.className&&(s=e.className+" ");var c=dr(a,void 0,n.useContext(mr));s+=t.key+"-"+c.name;var l={};for(var u in e)yr.call(e,u)&&"css"!==u&&u!==vr&&(l[u]=e[u]);return l.className=s,r&&(l.ref=r),n.createElement(n.Fragment,null,n.createElement(br,{cache:t,serialized:c,isStringTag:"string"==typeof i}),n.createElement(i,l))})),Cr=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Ar=tr((function(e){return Cr.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91})),kr=function(e){return"theme"!==e},Sr=function(e){return"string"==typeof e&&e.charCodeAt(0)>96?Ar:kr},Tr=function(e,t,r){var n;if(t){var o=t.shouldForwardProp;n=e.__emotion_forwardProp&&o?function(t){return e.__emotion_forwardProp(t)&&o(t)}:o}return"function"!=typeof n&&r&&(n=e.__emotion_forwardProp),n},Ir=function(e){var t=e.cache,r=e.serialized,n=e.isStringTag;return Jt(t,r,n),pr((function(){return Xt(t,r,n)})),null},xr=function e(t,r){var o,i,a=t.__emotion_real===t,s=a&&t.__emotion_base||t;void 0!==r&&(o=r.label,i=r.target);var c=Tr(t,r,a),l=c||Sr(s),u=!l("as");return function(){var d=arguments,h=a&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==o&&h.push("label:"+o+";"),null==d[0]||void 0===d[0].raw)h.push.apply(h,d);else{var p=d[0];h.push(p[0]);for(var f=d.length,g=1;g<f;g++)h.push(d[g],p[g])}var m=gr((function(e,t,r){var o=u&&e.as||s,a="",d=[],p=e;if(null==e.theme){for(var f in p={},e)p[f]=e[f];p.theme=n.useContext(mr)}"string"==typeof e.className?a=Qt(t.registered,d,e.className):null!=e.className&&(a=e.className+" ");var g=dr(h.concat(d),t.registered,p);a+=t.key+"-"+g.name,void 0!==i&&(a+=" "+i);var m=u&&void 0===c?Sr(o):l,y={};for(var v in e)u&&"as"===v||m(v)&&(y[v]=e[v]);return y.className=a,r&&(y.ref=r),n.createElement(n.Fragment,null,n.createElement(Ir,{cache:t,serialized:g,isStringTag:"string"==typeof o}),n.createElement(o,y))}));return m.displayName=void 0!==o?o:"Styled("+("string"==typeof s?s:s.displayName||s.name||"Component")+")",m.defaultProps=t.defaultProps,m.__emotion_real=m,m.__emotion_base=s,m.__emotion_styles=h,m.__emotion_forwardProp=c,Object.defineProperty(m,"toString",{value:function(){return"."+i}}),m.withComponent=function(t,n){return e(t,Ve({},r,n,{shouldForwardProp:Tr(m,n,!0)})).apply(void 0,h)},m}}.bind(null);function _r(e,t){return xr(e,t)}["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){xr[e]=xr(e)}));const Er=[];function Pr(e){return Er[0]=e,dr(Er)}function Rr(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:r="px",step:n=5,...o}=e,i=(e=>{const t=Object.keys(e).map((t=>({key:t,val:e[t]})))||[];return t.sort(((e,t)=>e.val-t.val)),t.reduce(((e,t)=>({...e,[t.key]:t.val})),{})})(t),a=Object.keys(i);function s(e){return`@media (min-width:${"number"==typeof t[e]?t[e]:e}${r})`}function c(e){return`@media (max-width:${("number"==typeof t[e]?t[e]:e)-n/100}${r})`}function l(e,o){const i=a.indexOf(o);return`@media (min-width:${"number"==typeof t[e]?t[e]:e}${r}) and (max-width:${(-1!==i&&"number"==typeof t[a[i]]?t[a[i]]:o)-n/100}${r})`}return{keys:a,values:i,up:s,down:c,between:l,only:function(e){return a.indexOf(e)+1<a.length?l(e,a[a.indexOf(e)+1]):s(e)},not:function(e){const t=a.indexOf(e);return 0===t?s(a[1]):t===a.length-1?c(a[t]):l(e,a[a.indexOf(e)+1]).replace("@media","@media not all and")},unit:r,...o}}var Or={borderRadius:4};const Mr={xs:0,sm:600,md:900,lg:1200,xl:1536},Nr={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${Mr[e]}px)`},Br={containerQueries:e=>({up:t=>{let r="number"==typeof t?t:Mr[t]||t;return"number"==typeof r&&(r=`${r}px`),e?`@container ${e} (min-width:${r})`:`@container (min-width:${r})`}})};function Lr(e,t,r){const n=e.theme||{};if(Array.isArray(t)){const e=n.breakpoints||Nr;return t.reduce(((n,o,i)=>(n[e.up(e.keys[i])]=r(t[i]),n)),{})}if("object"==typeof t){const e=n.breakpoints||Nr;return Object.keys(t).reduce(((o,i)=>{if(a=e.keys,"@"===(s=i)||s.startsWith("@")&&(a.some((e=>s.startsWith(`@${e}`)))||s.match(/^@\d/))){const e=function(e,t){const r=t.match(/^@([^/]+)?\/?(.+)?$/);if(!r)return null;const[,n,o]=r,i=Number.isNaN(+n)?n||0:+n;return e.containerQueries(o).up(i)}(n.containerQueries?n:Br,i);e&&(o[e]=r(t[i],i))}else if(Object.keys(e.values||Mr).includes(i))o[e.up(i)]=r(t[i],i);else{const e=i;o[e]=t[e]}var a,s;return o}),{})}return r(t)}function Hr(e={}){const t=e.keys?.reduce(((t,r)=>(t[e.up(r)]={},t)),{});return t||{}}function $r(e,t){return e.reduce(((e,t)=>{const r=e[t];return(!r||0===Object.keys(r).length)&&delete e[t],e}),t)}function qr({values:e,breakpoints:t,base:r}){const n=r||function(e,t){if("object"!=typeof e)return{};const r={},n=Object.keys(t);return Array.isArray(e)?n.forEach(((t,n)=>{n<e.length&&(r[t]=!0)})):n.forEach((t=>{null!=e[t]&&(r[t]=!0)})),r}(e,t),o=Object.keys(n);if(0===o.length)return e;let i;return o.reduce(((t,r,n)=>(Array.isArray(e)?(t[r]=null!=e[n]?e[n]:e[i],i=n):"object"==typeof e?(t[r]=null!=e[r]?e[r]:e[i],i=r):t[r]=e,t)),{})}function Fr(e,...t){const r=new URL(`https://mui.com/production-error/?code=${e}`);return t.forEach((e=>r.searchParams.append("args[]",e))),`Minified MUI error #${e}; visit ${r} for the full message.`}function Dr(e){if("string"!=typeof e)throw new Error(Fr(7));return e.charAt(0).toUpperCase()+e.slice(1)}function Ur(e,t,r=!0){if(!t||"string"!=typeof t)return null;if(e&&e.vars&&r){const r=`vars.${t}`.split(".").reduce(((e,t)=>e&&e[t]?e[t]:null),e);if(null!=r)return r}return t.split(".").reduce(((e,t)=>e&&null!=e[t]?e[t]:null),e)}function jr(e,t,r,n=r){let o;return o="function"==typeof e?e(r):Array.isArray(e)?e[r]||n:Ur(e,r)||n,t&&(o=t(o,n,e)),o}var zr=function(e){const{prop:t,cssProperty:r=e.prop,themeKey:n,transform:o}=e,i=e=>{if(null==e[t])return null;const i=e[t],a=Ur(e.theme,n)||{};return Lr(e,i,(e=>{let n=jr(a,o,e);return e===n&&"string"==typeof e&&(n=jr(a,o,`${t}${"default"===e?"":Dr(e)}`,e)),!1===r?n:{[r]:n}}))};return i.propTypes={},i.filterProps=[t],i},Kr=function(e,t){return t?Ue(e,t,{clone:!1}):e};const Wr={m:"margin",p:"padding"},Gr={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},Vr={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Yr=function(){const e={};return t=>(void 0===e[t]&&(e[t]=(e=>{if(e.length>2){if(!Vr[e])return[e];e=Vr[e]}const[t,r]=e.split(""),n=Wr[t],o=Gr[r]||"";return Array.isArray(o)?o.map((e=>n+e)):[n+o]})(t)),e[t])}(),Qr=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],Jr=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],Xr=[...Qr,...Jr];function Zr(e,t,r,n){const o=Ur(e,t,!0)??r;return"number"==typeof o||"string"==typeof o?e=>"string"==typeof e?e:"string"==typeof o?o.startsWith("var(")&&0===e?0:o.startsWith("var(")&&1===e?o:`calc(${e} * ${o})`:o*e:Array.isArray(o)?e=>{if("string"==typeof e)return e;const t=Math.abs(e),r=o[t];return e>=0?r:"number"==typeof r?-r:"string"==typeof r&&r.startsWith("var(")?`calc(-1 * ${r})`:`-${r}`}:"function"==typeof o?o:()=>{}}function en(e){return Zr(e,"spacing",8)}function tn(e,t){return"string"==typeof t||null==t?t:e(t)}function rn(e,t){const r=en(e.theme);return Object.keys(e).map((n=>function(e,t,r,n){if(!t.includes(r))return null;const o=function(e,t){return r=>e.reduce(((e,n)=>(e[n]=tn(t,r),e)),{})}(Yr(r),n);return Lr(e,e[r],o)}(e,t,n,r))).reduce(Kr,{})}function nn(e){return rn(e,Qr)}function on(e){return rn(e,Jr)}function an(e){return rn(e,Xr)}function sn(e=8,t=en({spacing:e})){if(e.mui)return e;const r=(...e)=>(0===e.length?[1]:e).map((e=>{const r=t(e);return"number"==typeof r?`${r}px`:r})).join(" ");return r.mui=!0,r}nn.propTypes={},nn.filterProps=Qr,on.propTypes={},on.filterProps=Jr,an.propTypes={},an.filterProps=Xr;var cn=function(...e){const t=e.reduce(((e,t)=>(t.filterProps.forEach((r=>{e[r]=t})),e)),{}),r=e=>Object.keys(e).reduce(((r,n)=>t[n]?Kr(r,t[n](e)):r),{});return r.propTypes={},r.filterProps=e.reduce(((e,t)=>e.concat(t.filterProps)),[]),r};function ln(e){return"number"!=typeof e?e:`${e}px solid`}function un(e,t){return zr({prop:e,themeKey:"borders",transform:t})}const dn=un("border",ln),hn=un("borderTop",ln),pn=un("borderRight",ln),fn=un("borderBottom",ln),gn=un("borderLeft",ln),mn=un("borderColor"),yn=un("borderTopColor"),vn=un("borderRightColor"),bn=un("borderBottomColor"),wn=un("borderLeftColor"),Cn=un("outline",ln),An=un("outlineColor"),kn=e=>{if(void 0!==e.borderRadius&&null!==e.borderRadius){const t=Zr(e.theme,"shape.borderRadius",4),r=e=>({borderRadius:tn(t,e)});return Lr(e,e.borderRadius,r)}return null};kn.propTypes={},kn.filterProps=["borderRadius"],cn(dn,hn,pn,fn,gn,mn,yn,vn,bn,wn,kn,Cn,An);const Sn=e=>{if(void 0!==e.gap&&null!==e.gap){const t=Zr(e.theme,"spacing",8),r=e=>({gap:tn(t,e)});return Lr(e,e.gap,r)}return null};Sn.propTypes={},Sn.filterProps=["gap"];const Tn=e=>{if(void 0!==e.columnGap&&null!==e.columnGap){const t=Zr(e.theme,"spacing",8),r=e=>({columnGap:tn(t,e)});return Lr(e,e.columnGap,r)}return null};Tn.propTypes={},Tn.filterProps=["columnGap"];const In=e=>{if(void 0!==e.rowGap&&null!==e.rowGap){const t=Zr(e.theme,"spacing",8),r=e=>({rowGap:tn(t,e)});return Lr(e,e.rowGap,r)}return null};function xn(e,t){return"grey"===t?t:e}function _n(e){return e<=1&&0!==e?100*e+"%":e}In.propTypes={},In.filterProps=["rowGap"],cn(Sn,Tn,In,zr({prop:"gridColumn"}),zr({prop:"gridRow"}),zr({prop:"gridAutoFlow"}),zr({prop:"gridAutoColumns"}),zr({prop:"gridAutoRows"}),zr({prop:"gridTemplateColumns"}),zr({prop:"gridTemplateRows"}),zr({prop:"gridTemplateAreas"}),zr({prop:"gridArea"})),cn(zr({prop:"color",themeKey:"palette",transform:xn}),zr({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:xn}),zr({prop:"backgroundColor",themeKey:"palette",transform:xn}));const En=zr({prop:"width",transform:_n}),Pn=e=>{if(void 0!==e.maxWidth&&null!==e.maxWidth){const t=t=>{const r=e.theme?.breakpoints?.values?.[t]||Mr[t];return r?"px"!==e.theme?.breakpoints?.unit?{maxWidth:`${r}${e.theme.breakpoints.unit}`}:{maxWidth:r}:{maxWidth:_n(t)}};return Lr(e,e.maxWidth,t)}return null};Pn.filterProps=["maxWidth"];const Rn=zr({prop:"minWidth",transform:_n}),On=zr({prop:"height",transform:_n}),Mn=zr({prop:"maxHeight",transform:_n}),Nn=zr({prop:"minHeight",transform:_n});zr({prop:"size",cssProperty:"width",transform:_n}),zr({prop:"size",cssProperty:"height",transform:_n}),cn(En,Pn,Rn,On,Mn,Nn,zr({prop:"boxSizing"}));var Bn={border:{themeKey:"borders",transform:ln},borderTop:{themeKey:"borders",transform:ln},borderRight:{themeKey:"borders",transform:ln},borderBottom:{themeKey:"borders",transform:ln},borderLeft:{themeKey:"borders",transform:ln},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:ln},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:kn},color:{themeKey:"palette",transform:xn},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:xn},backgroundColor:{themeKey:"palette",transform:xn},p:{style:on},pt:{style:on},pr:{style:on},pb:{style:on},pl:{style:on},px:{style:on},py:{style:on},padding:{style:on},paddingTop:{style:on},paddingRight:{style:on},paddingBottom:{style:on},paddingLeft:{style:on},paddingX:{style:on},paddingY:{style:on},paddingInline:{style:on},paddingInlineStart:{style:on},paddingInlineEnd:{style:on},paddingBlock:{style:on},paddingBlockStart:{style:on},paddingBlockEnd:{style:on},m:{style:nn},mt:{style:nn},mr:{style:nn},mb:{style:nn},ml:{style:nn},mx:{style:nn},my:{style:nn},margin:{style:nn},marginTop:{style:nn},marginRight:{style:nn},marginBottom:{style:nn},marginLeft:{style:nn},marginX:{style:nn},marginY:{style:nn},marginInline:{style:nn},marginInlineStart:{style:nn},marginInlineEnd:{style:nn},marginBlock:{style:nn},marginBlockStart:{style:nn},marginBlockEnd:{style:nn},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Sn},rowGap:{style:In},columnGap:{style:Tn},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:_n},maxWidth:{style:Pn},minWidth:{transform:_n},height:{transform:_n},maxHeight:{transform:_n},minHeight:{transform:_n},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};const Ln=function(){function e(e,t,r,n){const o={[e]:t,theme:r},i=n[e];if(!i)return{[e]:t};const{cssProperty:a=e,themeKey:s,transform:c,style:l}=i;if(null==t)return null;if("typography"===s&&"inherit"===t)return{[e]:t};const u=Ur(r,s)||{};return l?l(o):Lr(o,t,(t=>{let r=jr(u,c,t);return t===r&&"string"==typeof t&&(r=jr(u,c,`${e}${"default"===t?"":Dr(t)}`,t)),!1===a?r:{[a]:r}}))}return function t(r){const{sx:n,theme:o={}}=r||{};if(!n)return null;const i=o.unstable_sxConfig??Bn;function a(r){let n=r;if("function"==typeof r)n=r(o);else if("object"!=typeof r)return r;if(!n)return null;const a=Hr(o.breakpoints),s=Object.keys(a);let c=a;return Object.keys(n).forEach((r=>{const a=function(e,t){return"function"==typeof e?e(t):e}(n[r],o);if(null!=a)if("object"==typeof a)if(i[r])c=Kr(c,e(r,a,o,i));else{const e=Lr({theme:o},a,(e=>({[r]:e})));!function(...e){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]),r=new Set(t);return e.every((e=>r.size===Object.keys(e).length))}(e,a)?c=Kr(c,e):c[r]=t({sx:a,theme:o})}else c=Kr(c,e(r,a,o,i))})),function(e,t){if(!e.containerQueries)return t;const r=Object.keys(t).filter((e=>e.startsWith("@container"))).sort(((e,t)=>{const r=/min-width:\s*([0-9.]+)/;return+(e.match(r)?.[1]||0)-+(t.match(r)?.[1]||0)}));return r.length?r.reduce(((e,r)=>{const n=t[r];return delete e[r],e[r]=n,e}),{...t}):t}(o,$r(s,c))}return Array.isArray(n)?n.map(a):a(n)}}();Ln.filterProps=["sx"];var Hn=Ln;function $n(e,t){const r=this;if(r.vars){if(!r.colorSchemes?.[e]||"function"!=typeof r.getColorSchemeSelector)return{};let n=r.getColorSchemeSelector(e);return"&"===n?t:((n.includes("data-")||n.includes("."))&&(n=`*:where(${n.replace(/\s*&$/,"")}) &`),{[n]:t})}return r.palette.mode===e?t:{}}var qn=function(e={},...t){const{breakpoints:r={},palette:n={},spacing:o,shape:i={},...a}=e;let s=Ue({breakpoints:Rr(r),direction:"ltr",components:{},palette:{mode:"light",...n},spacing:sn(o),shape:{...Or,...i}},a);return s=function(e){const t=(e,t)=>e.replace("@media",t?`@container ${t}`:"@container");function r(r,n){r.up=(...r)=>t(e.breakpoints.up(...r),n),r.down=(...r)=>t(e.breakpoints.down(...r),n),r.between=(...r)=>t(e.breakpoints.between(...r),n),r.only=(...r)=>t(e.breakpoints.only(...r),n),r.not=(...r)=>{const o=t(e.breakpoints.not(...r),n);return o.includes("not all and")?o.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):o}}const n={},o=e=>(r(n,e),n);return r(o),{...e,containerQueries:o}}(s),s.applyStyles=$n,s=t.reduce(((e,t)=>Ue(e,t)),s),s.unstable_sxConfig={...Bn,...a?.unstable_sxConfig},s.unstable_sx=function(e){return Hn({sx:e,theme:this})},s};function Fn(e){const{variants:t,...r}=e,n={variants:t,style:Pr(r),isProcessed:!0};return n.style===r||t&&t.forEach((e=>{"function"!=typeof e.style&&(e.style=Pr(e.style))})),n}const Dn=qn();function Un(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}function jn(e){return e?(t,r)=>r[e]:null}function zn(e,t){const r="function"==typeof t?t(e):t;if(Array.isArray(r))return r.flatMap((t=>zn(e,t)));if(Array.isArray(r?.variants)){let t;if(r.isProcessed)t=r.style;else{const{variants:e,...n}=r;t=n}return Kn(e,r.variants,[t])}return r?.isProcessed?r.style:r}function Kn(e,t,r=[]){let n;e:for(let o=0;o<t.length;o+=1){const i=t[o];if("function"==typeof i.props){if(n??={...e,...e.ownerState,ownerState:e.ownerState},!i.props(n))continue}else for(const t in i.props)if(e[t]!==i.props[t]&&e.ownerState?.[t]!==i.props[t])continue e;"function"==typeof i.style?(n??={...e,...e.ownerState,ownerState:e.ownerState},r.push(i.style(n))):r.push(i.style)}return r}function Wn(e={}){const{themeId:t,defaultTheme:r=Dn,rootShouldForwardProp:n=Un,slotShouldForwardProp:o=Un}=e;function i(e){!function(e,t,r){e.theme=function(e){for(const t in e)return!1;return!0}(e.theme)?r:e.theme[t]||e.theme}(e,t,r)}return(e,t={})=>{!function(e){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=(e=>e.filter((e=>e!==Hn)))(e.__emotion_styles))}(e);const{name:r,slot:a,skipVariantsResolver:s,skipSx:c,overridesResolver:l=jn(Gn(a)),...u}=t,d=void 0!==s?s:a&&"Root"!==a&&"root"!==a||!1,h=c||!1;let p=Un;"Root"===a||"root"===a?p=n:a?p=o:function(e){return"string"==typeof e&&e.charCodeAt(0)>96}(e)&&(p=void 0);const f=_r(e,{shouldForwardProp:p,label:void 0,...u}),g=e=>{if("function"==typeof e&&e.__emotion_real!==e)return function(t){return zn(t,e)};if(Fe(e)){const t=Fn(e);return t.variants?function(e){return zn(e,t)}:t.style}return e},m=(...t)=>{const n=[],o=t.map(g),a=[];if(n.push(i),r&&l&&a.push((function(e){const t=e.theme,n=t.components?.[r]?.styleOverrides;if(!n)return null;const o={};for(const t in n)o[t]=zn(e,n[t]);return l(e,o)})),r&&!d&&a.push((function(e){const t=e.theme,n=t?.components?.[r]?.variants;return n?Kn(e,n):null})),h||a.push(Hn),Array.isArray(o[0])){const e=o.shift(),t=new Array(n.length).fill(""),r=new Array(a.length).fill("");let i;i=[...t,...e,...r],i.raw=[...t,...e.raw,...r],n.unshift(i)}const s=[...n,...o,...a],c=f(...s);return e.muiName&&(c.muiName=e.muiName),c};return f.withConfig&&(m.withConfig=f.withConfig),m}}function Gn(e){return e?e.charAt(0).toLowerCase()+e.slice(1):e}var Vn=Wn();function Yn(e,t){const r={...t};for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const o=n;if("components"===o||"slots"===o)r[o]={...e[o],...r[o]};else if("componentsProps"===o||"slotProps"===o){const n=e[o],i=t[o];if(i)if(n){r[o]={...i};for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)){const t=e;r[o][t]=Yn(n[t],i[t])}}else r[o]=i;else r[o]=n||{}}else void 0===r[o]&&(r[o]=e[o])}return r}const Qn=qn();var Jn=function(e=Qn){return function(e=null){const t=n.useContext(mr);return t&&(r=t,0!==Object.keys(r).length)?t:e;var r}(e)};function Xn(e){const{sx:t,...r}=e,{systemProps:n,otherProps:o}=(e=>{const t={systemProps:{},otherProps:{}},r=e?.theme?.unstable_sxConfig??Bn;return Object.keys(e).forEach((n=>{r[n]?t.systemProps[n]=e[n]:t.otherProps[n]=e[n]})),t})(r);let i;return i=Array.isArray(t)?[n,...t]:"function"==typeof t?(...e)=>{const r=t(...e);return Fe(r)?{...n,...r}:n}:{...n,...t},{...o,sx:i}}var Zn=r(74848),eo=r.t(Zn,2);const to=qn(),ro=Vn("div",{name:"MuiStack",slot:"Root"});function no(e){return function({props:e,name:t,defaultTheme:r,themeId:n}){let o=Jn(r);return n&&(o=o[n]||o),function(e){const{theme:t,name:r,props:n}=e;return t&&t.components&&t.components[r]&&t.components[r].defaultProps?Yn(t.components[r].defaultProps,n):n}({theme:o,name:t,props:e})}({props:e,name:"MuiStack",defaultTheme:to})}function oo(e,t){const r=n.Children.toArray(e).filter(Boolean);return r.reduce(((e,o,i)=>(e.push(o),i<r.length-1&&e.push(n.cloneElement(t,{key:`separator-${i}`})),e)),[])}const io=({ownerState:e,theme:t})=>{let r={display:"flex",flexDirection:"column",...Lr({theme:t},qr({values:e.direction,breakpoints:t.breakpoints.values}),(e=>({flexDirection:e})))};if(e.spacing){const n=en(t),o=Object.keys(t.breakpoints.values).reduce(((t,r)=>(("object"==typeof e.spacing&&null!=e.spacing[r]||"object"==typeof e.direction&&null!=e.direction[r])&&(t[r]=!0),t)),{}),i=qr({values:e.direction,base:o}),a=qr({values:e.spacing,base:o});"object"==typeof i&&Object.keys(i).forEach(((e,t,r)=>{if(!i[e]){const n=t>0?i[r[t-1]]:"column";i[e]=n}})),r=Ue(r,Lr({theme:t},a,((t,r)=>{return e.useFlexGap?{gap:tn(n,t)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${o=r?i[r]:e.direction,{row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"}[o]}`]:tn(n,t)}};var o})))}return r=function(e,...t){const r=Hr(e),n=[r,...t].reduce(((e,t)=>Ue(e,t)),{});return $r(Object.keys(r),n)}(t.breakpoints,r),r};function ao(e,t=0,r=1){return function(e,t=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(e,r))}(e,t,r)}function so(e){if(e.type)return e;if("#"===e.charAt(0))return so(function(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let r=e.match(t);return r&&1===r[0].length&&(r=r.map((e=>e+e))),r?`rgb${4===r.length?"a":""}(${r.map(((e,t)=>t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3)).join(", ")})`:""}(e));const t=e.indexOf("("),r=e.substring(0,t);if(!["rgb","rgba","hsl","hsla","color"].includes(r))throw new Error(Fr(9,e));let n,o=e.substring(t+1,e.length-1);if("color"===r){if(o=o.split(" "),n=o.shift(),4===o.length&&"/"===o[3].charAt(0)&&(o[3]=o[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(n))throw new Error(Fr(10,n))}else o=o.split(",");return o=o.map((e=>parseFloat(e))),{type:r,values:o,colorSpace:n}}const co=(e,t)=>{try{return(e=>{const t=so(e);return t.values.slice(0,3).map(((e,r)=>t.type.includes("hsl")&&0!==r?`${e}%`:e)).join(" ")})(e)}catch(t){return e}};function lo(e){const{type:t,colorSpace:r}=e;let{values:n}=e;return t.includes("rgb")?n=n.map(((e,t)=>t<3?parseInt(e,10):e)):t.includes("hsl")&&(n[1]=`${n[1]}%`,n[2]=`${n[2]}%`),n=t.includes("color")?`${r} ${n.join(" ")}`:`${n.join(", ")}`,`${t}(${n})`}function uo(e){e=so(e);const{values:t}=e,r=t[0],n=t[1]/100,o=t[2]/100,i=n*Math.min(o,1-o),a=(e,t=(e+r/30)%12)=>o-i*Math.max(Math.min(t-3,9-t,1),-1);let s="rgb";const c=[Math.round(255*a(0)),Math.round(255*a(8)),Math.round(255*a(4))];return"hsla"===e.type&&(s+="a",c.push(t[3])),lo({type:s,values:c})}function ho(e){let t="hsl"===(e=so(e)).type||"hsla"===e.type?so(uo(e)).values:e.values;return t=t.map((t=>("color"!==e.type&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4))),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function po(e,t){return e=so(e),t=ao(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),"color"===e.type?e.values[3]=`/${t}`:e.values[3]=t,lo(e)}function fo(e,t,r){try{return po(e,t)}catch(t){return e}}function go(e,t){if(e=so(e),t=ao(t),e.type.includes("hsl"))e.values[2]*=1-t;else if(e.type.includes("rgb")||e.type.includes("color"))for(let r=0;r<3;r+=1)e.values[r]*=1-t;return lo(e)}function mo(e,t,r){try{return go(e,t)}catch(t){return e}}function yo(e,t){if(e=so(e),t=ao(t),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*t;else if(e.type.includes("rgb"))for(let r=0;r<3;r+=1)e.values[r]+=(255-e.values[r])*t;else if(e.type.includes("color"))for(let r=0;r<3;r+=1)e.values[r]+=(1-e.values[r])*t;return lo(e)}function vo(e,t,r){try{return yo(e,t)}catch(t){return e}}function bo(e,t,r){try{return function(e,t=.15){return ho(e)>.5?go(e,t):yo(e,t)}(e,t)}catch(t){return e}}var wo={black:"#000",white:"#fff"},Co={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Ao="#f3e5f5",ko="#ce93d8",So="#ba68c8",To="#ab47bc",Io="#9c27b0",xo="#7b1fa2",_o="#e57373",Eo="#ef5350",Po="#f44336",Ro="#d32f2f",Oo="#c62828",Mo="#ffb74d",No="#ffa726",Bo="#ff9800",Lo="#f57c00",Ho="#e65100",$o="#e3f2fd",qo="#90caf9",Fo="#42a5f5",Do="#1976d2",Uo="#1565c0",jo="#4fc3f7",zo="#29b6f6",Ko="#03a9f4",Wo="#0288d1",Go="#01579b",Vo="#81c784",Yo="#66bb6a",Qo="#4caf50",Jo="#388e3c",Xo="#2e7d32",Zo="#1b5e20";function ei(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:wo.white,default:wo.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const ti=ei();function ri(){return{text:{primary:wo.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:wo.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const ni=ri();function oi(e,t,r,n){const o=n.light||n,i=n.dark||1.5*n;e[t]||(e.hasOwnProperty(r)?e[t]=e[r]:"light"===t?e.light=yo(e.main,o):"dark"===t&&(e.dark=go(e.main,i)))}function ii(e){const{mode:t="light",contrastThreshold:r=3,tonalOffset:n=.2,...o}=e,i=e.primary||function(e="light"){return"dark"===e?{main:qo,light:$o,dark:Fo}:{main:Do,light:Fo,dark:Uo}}(t),a=e.secondary||function(e="light"){return"dark"===e?{main:ko,light:Ao,dark:To}:{main:Io,light:So,dark:xo}}(t),s=e.error||function(e="light"){return"dark"===e?{main:Po,light:_o,dark:Ro}:{main:Ro,light:Eo,dark:Oo}}(t),c=e.info||function(e="light"){return"dark"===e?{main:zo,light:jo,dark:Wo}:{main:Wo,light:Ko,dark:Go}}(t),l=e.success||function(e="light"){return"dark"===e?{main:Yo,light:Vo,dark:Jo}:{main:Xo,light:Qo,dark:Zo}}(t),u=e.warning||function(e="light"){return"dark"===e?{main:No,light:Mo,dark:Lo}:{main:"#ed6c02",light:Bo,dark:Ho}}(t);function d(e){const t=function(e,t){const r=ho(e),n=ho(t);return(Math.max(r,n)+.05)/(Math.min(r,n)+.05)}(e,ni.text.primary)>=r?ni.text.primary:ti.text.primary;return t}const h=({color:e,name:t,mainShade:r=500,lightShade:o=300,darkShade:i=700})=>{if(!(e={...e}).main&&e[r]&&(e.main=e[r]),!e.hasOwnProperty("main"))throw new Error(Fr(11,t?` (${t})`:"",r));if("string"!=typeof e.main)throw new Error(Fr(12,t?` (${t})`:"",JSON.stringify(e.main)));return oi(e,"light",o,n),oi(e,"dark",i,n),e.contrastText||(e.contrastText=d(e.main)),e};let p;return"light"===t?p=ei():"dark"===t&&(p=ri()),Ue({common:{...wo},mode:t,primary:h({color:i,name:"primary"}),secondary:h({color:a,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:h({color:s,name:"error"}),warning:h({color:u,name:"warning"}),info:h({color:c,name:"info"}),success:h({color:l,name:"success"}),grey:Co,contrastThreshold:r,getContrastText:d,augmentColor:h,tonalOffset:n,...p},o)}function ai(e=""){function t(...r){if(!r.length)return"";const n=r[0];return"string"!=typeof n||n.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, ${n}`:`, var(--${e?`${e}-`:""}${n}${t(...r.slice(1))})`}return(r,...n)=>`var(--${e?`${e}-`:""}${r}${t(...n)})`}function si(e){const t={};return Object.entries(e).forEach((e=>{const[r,n]=e;"object"==typeof n&&(t[r]=`${n.fontStyle?`${n.fontStyle} `:""}${n.fontVariant?`${n.fontVariant} `:""}${n.fontWeight?`${n.fontWeight} `:""}${n.fontStretch?`${n.fontStretch} `:""}${n.fontSize||""}${n.lineHeight?`/${n.lineHeight} `:""}${n.fontFamily||""}`)})),t}const ci=(e,t,r,n=[])=>{let o=e;t.forEach(((e,i)=>{i===t.length-1?Array.isArray(o)?o[Number(e)]=r:o&&"object"==typeof o&&(o[e]=r):o&&"object"==typeof o&&(o[e]||(o[e]=n.includes(e)?[]:{}),o=o[e])}))};function li(e,t){const{prefix:r,shouldSkipGeneratingVar:n}=t||{},o={},i={},a={};var s,c;return s=(e,t,s)=>{if(!("string"!=typeof t&&"number"!=typeof t||n&&n(e,t))){const n=`--${r?`${r}-`:""}${e.join("-")}`,c=((e,t)=>"number"==typeof t?["lineHeight","fontWeight","opacity","zIndex"].some((t=>e.includes(t)))||e[e.length-1].toLowerCase().includes("opacity")?t:`${t}px`:t)(e,t);Object.assign(o,{[n]:c}),ci(i,e,`var(${n})`,s),ci(a,e,`var(${n}, ${c})`,s)}},c=e=>"vars"===e[0],function e(t,r=[],n=[]){Object.entries(t).forEach((([t,o])=>{(!c||c&&!c([...r,t]))&&null!=o&&("object"==typeof o&&Object.keys(o).length>0?e(o,[...r,t],Array.isArray(o)?[...n,t]:n):s([...r,t],o,n))}))}(e),{css:o,vars:i,varsWithDefaults:a}}const ui={textTransform:"uppercase"},di='"Roboto", "Helvetica", "Arial", sans-serif';function hi(e,t){const{fontFamily:r=di,fontSize:n=14,fontWeightLight:o=300,fontWeightRegular:i=400,fontWeightMedium:a=500,fontWeightBold:s=700,htmlFontSize:c=16,allVariants:l,pxToRem:u,...d}="function"==typeof t?t(e):t,h=n/14,p=u||(e=>e/c*h+"rem"),f=(e,t,n,o,i)=>{return{fontFamily:r,fontWeight:e,fontSize:p(t),lineHeight:n,...r===di?{letterSpacing:(a=o/t,Math.round(1e5*a)/1e5+"em")}:{},...i,...l};var a},g={h1:f(o,96,1.167,-1.5),h2:f(o,60,1.2,-.5),h3:f(i,48,1.167,0),h4:f(i,34,1.235,.25),h5:f(i,24,1.334,0),h6:f(a,20,1.6,.15),subtitle1:f(i,16,1.75,.15),subtitle2:f(a,14,1.57,.1),body1:f(i,16,1.5,.15),body2:f(i,14,1.43,.15),button:f(a,14,1.75,.4,ui),caption:f(i,12,1.66,.4),overline:f(i,12,2.66,1,ui),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Ue({htmlFontSize:c,pxToRem:p,fontFamily:r,fontSize:n,fontWeightLight:o,fontWeightRegular:i,fontWeightMedium:a,fontWeightBold:s,...g},d,{clone:!1})}function pi(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,0.2)`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,0.14)`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,0.12)`].join(",")}var fi=["none",pi(0,2,1,-1,0,1,1,0,0,1,3,0),pi(0,3,1,-2,0,2,2,0,0,1,5,0),pi(0,3,3,-2,0,3,4,0,0,1,8,0),pi(0,2,4,-1,0,4,5,0,0,1,10,0),pi(0,3,5,-1,0,5,8,0,0,1,14,0),pi(0,3,5,-1,0,6,10,0,0,1,18,0),pi(0,4,5,-2,0,7,10,1,0,2,16,1),pi(0,5,5,-3,0,8,10,1,0,3,14,2),pi(0,5,6,-3,0,9,12,1,0,3,16,2),pi(0,6,6,-3,0,10,14,1,0,4,18,3),pi(0,6,7,-4,0,11,15,1,0,4,20,3),pi(0,7,8,-4,0,12,17,2,0,5,22,4),pi(0,7,8,-4,0,13,19,2,0,5,24,4),pi(0,7,9,-4,0,14,21,2,0,5,26,4),pi(0,8,9,-5,0,15,22,2,0,6,28,5),pi(0,8,10,-5,0,16,24,2,0,6,30,5),pi(0,8,11,-5,0,17,26,2,0,6,32,5),pi(0,9,11,-5,0,18,28,2,0,7,34,6),pi(0,9,12,-6,0,19,29,2,0,7,36,6),pi(0,10,13,-6,0,20,31,3,0,8,38,7),pi(0,10,13,-6,0,21,33,3,0,8,40,7),pi(0,10,14,-6,0,22,35,3,0,8,42,7),pi(0,11,14,-7,0,23,36,3,0,9,44,8),pi(0,11,15,-7,0,24,38,3,0,9,46,8)];const gi={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},mi={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function yi(e){return`${Math.round(e)}ms`}function vi(e){if(!e)return 0;const t=e/36;return Math.min(Math.round(10*(4+15*t**.25+t/5)),3e3)}function bi(e){const t={...gi,...e.easing},r={...mi,...e.duration};return{getAutoHeightDuration:vi,create:(e=["all"],n={})=>{const{duration:o=r.standard,easing:i=t.easeInOut,delay:a=0,...s}=n;return(Array.isArray(e)?e:[e]).map((e=>`${e} ${"string"==typeof o?o:yi(o)} ${i} ${"string"==typeof a?a:yi(a)}`)).join(",")},...e,easing:t,duration:r}}var wi={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function Ci(e={}){const t={...e};return function e(t){const r=Object.entries(t);for(let o=0;o<r.length;o++){const[i,a]=r[o];!Fe(n=a)&&void 0!==n&&"string"!=typeof n&&"boolean"!=typeof n&&"number"!=typeof n&&!Array.isArray(n)||i.startsWith("unstable_")?delete t[i]:Fe(a)&&(t[i]={...a},e(t[i]))}var n}(t),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';\n\nconst theme = ${JSON.stringify(t,null,2)};\n\ntheme.breakpoints = createBreakpoints(theme.breakpoints || {});\ntheme.transitions = createTransitions(theme.transitions || {});\n\nexport default theme;`}var Ai=function(e={},...t){const{breakpoints:r,mixins:n={},spacing:o,palette:i={},transitions:a={},typography:s={},shape:c,...l}=e;if(e.vars&&void 0===e.generateThemeVars)throw new Error(Fr(20));const u=ii(i),d=qn(e);let h=Ue(d,{mixins:(p=d.breakpoints,f=n,{toolbar:{minHeight:56,[p.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[p.up("sm")]:{minHeight:64}},...f}),palette:u,shadows:fi.slice(),typography:hi(u,s),transitions:bi(a),zIndex:{...wi}});var p,f;return h=Ue(h,l),h=t.reduce(((e,t)=>Ue(e,t)),h),h.unstable_sxConfig={...Bn,...l?.unstable_sxConfig},h.unstable_sx=function(e){return Hn({sx:e,theme:this})},h.toRuntimeSource=Ci,h};function ki(e){let t;return t=e<1?5.11916*e**2:4.5*Math.log(e+1)+2,Math.round(10*t)/1e3}const Si=[...Array(25)].map(((e,t)=>{if(0===t)return"none";const r=ki(t);return`linear-gradient(rgba(255 255 255 / ${r}), rgba(255 255 255 / ${r}))`}));function Ti(e){return{inputPlaceholder:"dark"===e?.5:.42,inputUnderline:"dark"===e?.7:.42,switchTrackDisabled:"dark"===e?.2:.12,switchTrack:"dark"===e?.3:.38}}function Ii(e){return"dark"===e?Si:[]}function xi(e){return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||"palette"===e[0]&&!!e[1]?.match(/(mode|contrastThreshold|tonalOffset)/)}var _i=e=>(t,r)=>{const n=e.rootSelector||":root",o=e.colorSchemeSelector;let i=o;if("class"===o&&(i=".%s"),"data"===o&&(i="[data-%s]"),o?.startsWith("data-")&&!o.includes("%s")&&(i=`[${o}="%s"]`),e.defaultColorScheme===t){if("dark"===t){const o={};return(a=e.cssVarPrefix,[...[...Array(25)].map(((e,t)=>`--${a?`${a}-`:""}overlays-${t}`)),`--${a?`${a}-`:""}palette-AppBar-darkBg`,`--${a?`${a}-`:""}palette-AppBar-darkColor`]).forEach((e=>{o[e]=r[e],delete r[e]})),"media"===i?{[n]:r,"@media (prefers-color-scheme: dark)":{[n]:o}}:i?{[i.replace("%s",t)]:o,[`${n}, ${i.replace("%s",t)}`]:r}:{[n]:{...r,...o}}}if(i&&"media"!==i)return`${n}, ${i.replace("%s",String(t))}`}else if(t){if("media"===i)return{[`@media (prefers-color-scheme: ${String(t)})`]:{[n]:r}};if(i)return i.replace("%s",String(t))}var a;return n};function Ei(e,t,r){!e[t]&&r&&(e[t]=r)}function Pi(e){return"string"==typeof e&&e.startsWith("hsl")?uo(e):e}function Ri(e,t){`${t}Channel`in e||(e[`${t}Channel`]=co(Pi(e[t])))}const Oi=e=>{try{return e()}catch(e){}};function Mi(e,t,r,n){if(!t)return;t=!0===t?{}:t;const o="dark"===n?"dark":"light";if(!r)return void(e[n]=function(e){const{palette:t={mode:"light"},opacity:r,overlays:n,...o}=e,i=ii(t);return{palette:i,opacity:{...Ti(i.mode),...r},overlays:n||Ii(i.mode),...o}}({...t,palette:{mode:o,...t?.palette}}));const{palette:i,...a}=Ai({...r,palette:{mode:o,...t?.palette}});return e[n]={...t,palette:i,opacity:{...Ti(o),...t?.opacity},overlays:t?.overlays||Ii(o)},a}function Ni(e={},...t){const{colorSchemes:r={light:!0},defaultColorScheme:n,disableCssColorScheme:o=!1,cssVarPrefix:i="mui",shouldSkipGeneratingVar:a=xi,colorSchemeSelector:s=(r.light&&r.dark?"media":void 0),rootSelector:c=":root",...l}=e,u=Object.keys(r)[0],d=n||(r.light&&"light"!==u?"light":u),h=((e="mui")=>ai(e))(i),{[d]:p,light:f,dark:g,...m}=r,y={...m};let v=p;if(("dark"===d&&!("dark"in r)||"light"===d&&!("light"in r))&&(v=!0),!v)throw new Error(Fr(21,d));const b=Mi(y,v,l,d);f&&!y.light&&Mi(y,f,void 0,"light"),g&&!y.dark&&Mi(y,g,void 0,"dark");let w={defaultColorScheme:d,...b,cssVarPrefix:i,colorSchemeSelector:s,rootSelector:c,getCssVar:h,colorSchemes:y,font:{...si(b.typography),...b.font},spacing:(C=l.spacing,"number"==typeof C?`${C}px`:"string"==typeof C||"function"==typeof C||Array.isArray(C)?C:"8px")};var C;Object.keys(w.colorSchemes).forEach((e=>{const t=w.colorSchemes[e].palette,r=e=>{const r=e.split("-"),n=r[1],o=r[2];return h(e,t[n][o])};var n;if("light"===t.mode&&(Ei(t.common,"background","#fff"),Ei(t.common,"onBackground","#000")),"dark"===t.mode&&(Ei(t.common,"background","#000"),Ei(t.common,"onBackground","#fff")),n=t,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"].forEach((e=>{n[e]||(n[e]={})})),"light"===t.mode){Ei(t.Alert,"errorColor",mo(t.error.light,.6)),Ei(t.Alert,"infoColor",mo(t.info.light,.6)),Ei(t.Alert,"successColor",mo(t.success.light,.6)),Ei(t.Alert,"warningColor",mo(t.warning.light,.6)),Ei(t.Alert,"errorFilledBg",r("palette-error-main")),Ei(t.Alert,"infoFilledBg",r("palette-info-main")),Ei(t.Alert,"successFilledBg",r("palette-success-main")),Ei(t.Alert,"warningFilledBg",r("palette-warning-main")),Ei(t.Alert,"errorFilledColor",Oi((()=>t.getContrastText(t.error.main)))),Ei(t.Alert,"infoFilledColor",Oi((()=>t.getContrastText(t.info.main)))),Ei(t.Alert,"successFilledColor",Oi((()=>t.getContrastText(t.success.main)))),Ei(t.Alert,"warningFilledColor",Oi((()=>t.getContrastText(t.warning.main)))),Ei(t.Alert,"errorStandardBg",vo(t.error.light,.9)),Ei(t.Alert,"infoStandardBg",vo(t.info.light,.9)),Ei(t.Alert,"successStandardBg",vo(t.success.light,.9)),Ei(t.Alert,"warningStandardBg",vo(t.warning.light,.9)),Ei(t.Alert,"errorIconColor",r("palette-error-main")),Ei(t.Alert,"infoIconColor",r("palette-info-main")),Ei(t.Alert,"successIconColor",r("palette-success-main")),Ei(t.Alert,"warningIconColor",r("palette-warning-main")),Ei(t.AppBar,"defaultBg",r("palette-grey-100")),Ei(t.Avatar,"defaultBg",r("palette-grey-400")),Ei(t.Button,"inheritContainedBg",r("palette-grey-300")),Ei(t.Button,"inheritContainedHoverBg",r("palette-grey-A100")),Ei(t.Chip,"defaultBorder",r("palette-grey-400")),Ei(t.Chip,"defaultAvatarColor",r("palette-grey-700")),Ei(t.Chip,"defaultIconColor",r("palette-grey-700")),Ei(t.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Ei(t.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Ei(t.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Ei(t.LinearProgress,"primaryBg",vo(t.primary.main,.62)),Ei(t.LinearProgress,"secondaryBg",vo(t.secondary.main,.62)),Ei(t.LinearProgress,"errorBg",vo(t.error.main,.62)),Ei(t.LinearProgress,"infoBg",vo(t.info.main,.62)),Ei(t.LinearProgress,"successBg",vo(t.success.main,.62)),Ei(t.LinearProgress,"warningBg",vo(t.warning.main,.62)),Ei(t.Skeleton,"bg",`rgba(${r("palette-text-primaryChannel")} / 0.11)`),Ei(t.Slider,"primaryTrack",vo(t.primary.main,.62)),Ei(t.Slider,"secondaryTrack",vo(t.secondary.main,.62)),Ei(t.Slider,"errorTrack",vo(t.error.main,.62)),Ei(t.Slider,"infoTrack",vo(t.info.main,.62)),Ei(t.Slider,"successTrack",vo(t.success.main,.62)),Ei(t.Slider,"warningTrack",vo(t.warning.main,.62));const e=bo(t.background.default,.8);Ei(t.SnackbarContent,"bg",e),Ei(t.SnackbarContent,"color",Oi((()=>t.getContrastText(e)))),Ei(t.SpeedDialAction,"fabHoverBg",bo(t.background.paper,.15)),Ei(t.StepConnector,"border",r("palette-grey-400")),Ei(t.StepContent,"border",r("palette-grey-400")),Ei(t.Switch,"defaultColor",r("palette-common-white")),Ei(t.Switch,"defaultDisabledColor",r("palette-grey-100")),Ei(t.Switch,"primaryDisabledColor",vo(t.primary.main,.62)),Ei(t.Switch,"secondaryDisabledColor",vo(t.secondary.main,.62)),Ei(t.Switch,"errorDisabledColor",vo(t.error.main,.62)),Ei(t.Switch,"infoDisabledColor",vo(t.info.main,.62)),Ei(t.Switch,"successDisabledColor",vo(t.success.main,.62)),Ei(t.Switch,"warningDisabledColor",vo(t.warning.main,.62)),Ei(t.TableCell,"border",vo(fo(t.divider,1),.88)),Ei(t.Tooltip,"bg",fo(t.grey[700],.92))}if("dark"===t.mode){Ei(t.Alert,"errorColor",vo(t.error.light,.6)),Ei(t.Alert,"infoColor",vo(t.info.light,.6)),Ei(t.Alert,"successColor",vo(t.success.light,.6)),Ei(t.Alert,"warningColor",vo(t.warning.light,.6)),Ei(t.Alert,"errorFilledBg",r("palette-error-dark")),Ei(t.Alert,"infoFilledBg",r("palette-info-dark")),Ei(t.Alert,"successFilledBg",r("palette-success-dark")),Ei(t.Alert,"warningFilledBg",r("palette-warning-dark")),Ei(t.Alert,"errorFilledColor",Oi((()=>t.getContrastText(t.error.dark)))),Ei(t.Alert,"infoFilledColor",Oi((()=>t.getContrastText(t.info.dark)))),Ei(t.Alert,"successFilledColor",Oi((()=>t.getContrastText(t.success.dark)))),Ei(t.Alert,"warningFilledColor",Oi((()=>t.getContrastText(t.warning.dark)))),Ei(t.Alert,"errorStandardBg",mo(t.error.light,.9)),Ei(t.Alert,"infoStandardBg",mo(t.info.light,.9)),Ei(t.Alert,"successStandardBg",mo(t.success.light,.9)),Ei(t.Alert,"warningStandardBg",mo(t.warning.light,.9)),Ei(t.Alert,"errorIconColor",r("palette-error-main")),Ei(t.Alert,"infoIconColor",r("palette-info-main")),Ei(t.Alert,"successIconColor",r("palette-success-main")),Ei(t.Alert,"warningIconColor",r("palette-warning-main")),Ei(t.AppBar,"defaultBg",r("palette-grey-900")),Ei(t.AppBar,"darkBg",r("palette-background-paper")),Ei(t.AppBar,"darkColor",r("palette-text-primary")),Ei(t.Avatar,"defaultBg",r("palette-grey-600")),Ei(t.Button,"inheritContainedBg",r("palette-grey-800")),Ei(t.Button,"inheritContainedHoverBg",r("palette-grey-700")),Ei(t.Chip,"defaultBorder",r("palette-grey-700")),Ei(t.Chip,"defaultAvatarColor",r("palette-grey-300")),Ei(t.Chip,"defaultIconColor",r("palette-grey-300")),Ei(t.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Ei(t.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Ei(t.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Ei(t.LinearProgress,"primaryBg",mo(t.primary.main,.5)),Ei(t.LinearProgress,"secondaryBg",mo(t.secondary.main,.5)),Ei(t.LinearProgress,"errorBg",mo(t.error.main,.5)),Ei(t.LinearProgress,"infoBg",mo(t.info.main,.5)),Ei(t.LinearProgress,"successBg",mo(t.success.main,.5)),Ei(t.LinearProgress,"warningBg",mo(t.warning.main,.5)),Ei(t.Skeleton,"bg",`rgba(${r("palette-text-primaryChannel")} / 0.13)`),Ei(t.Slider,"primaryTrack",mo(t.primary.main,.5)),Ei(t.Slider,"secondaryTrack",mo(t.secondary.main,.5)),Ei(t.Slider,"errorTrack",mo(t.error.main,.5)),Ei(t.Slider,"infoTrack",mo(t.info.main,.5)),Ei(t.Slider,"successTrack",mo(t.success.main,.5)),Ei(t.Slider,"warningTrack",mo(t.warning.main,.5));const e=bo(t.background.default,.98);Ei(t.SnackbarContent,"bg",e),Ei(t.SnackbarContent,"color",Oi((()=>t.getContrastText(e)))),Ei(t.SpeedDialAction,"fabHoverBg",bo(t.background.paper,.15)),Ei(t.StepConnector,"border",r("palette-grey-600")),Ei(t.StepContent,"border",r("palette-grey-600")),Ei(t.Switch,"defaultColor",r("palette-grey-300")),Ei(t.Switch,"defaultDisabledColor",r("palette-grey-600")),Ei(t.Switch,"primaryDisabledColor",mo(t.primary.main,.55)),Ei(t.Switch,"secondaryDisabledColor",mo(t.secondary.main,.55)),Ei(t.Switch,"errorDisabledColor",mo(t.error.main,.55)),Ei(t.Switch,"infoDisabledColor",mo(t.info.main,.55)),Ei(t.Switch,"successDisabledColor",mo(t.success.main,.55)),Ei(t.Switch,"warningDisabledColor",mo(t.warning.main,.55)),Ei(t.TableCell,"border",mo(fo(t.divider,1),.68)),Ei(t.Tooltip,"bg",fo(t.grey[700],.92))}Ri(t.background,"default"),Ri(t.background,"paper"),Ri(t.common,"background"),Ri(t.common,"onBackground"),Ri(t,"divider"),Object.keys(t).forEach((e=>{const r=t[e];"tonalOffset"!==e&&r&&"object"==typeof r&&(r.main&&Ei(t[e],"mainChannel",co(Pi(r.main))),r.light&&Ei(t[e],"lightChannel",co(Pi(r.light))),r.dark&&Ei(t[e],"darkChannel",co(Pi(r.dark))),r.contrastText&&Ei(t[e],"contrastTextChannel",co(Pi(r.contrastText))),"text"===e&&(Ri(t[e],"primary"),Ri(t[e],"secondary")),"action"===e&&(r.active&&Ri(t[e],"active"),r.selected&&Ri(t[e],"selected")))}))})),w=t.reduce(((e,t)=>Ue(e,t)),w);const A={prefix:i,disableCssColorScheme:o,shouldSkipGeneratingVar:a,getSelector:_i(w)},{vars:k,generateThemeVars:S,generateStyleSheets:T}=function(e,t={}){const{getSelector:r=m,disableCssColorScheme:n,colorSchemeSelector:o}=t,{colorSchemes:i={},components:a,defaultColorScheme:s="light",...c}=e,{vars:l,css:u,varsWithDefaults:d}=li(c,t);let h=d;const p={},{[s]:f,...g}=i;if(Object.entries(g||{}).forEach((([e,r])=>{const{vars:n,css:o,varsWithDefaults:i}=li(r,t);h=Ue(h,i),p[e]={css:o,vars:n}})),f){const{css:e,vars:r,varsWithDefaults:n}=li(f,t);h=Ue(h,n),p[s]={css:e,vars:r}}function m(t,r){let n=o;if("class"===o&&(n=".%s"),"data"===o&&(n="[data-%s]"),o?.startsWith("data-")&&!o.includes("%s")&&(n=`[${o}="%s"]`),t){if("media"===n){if(e.defaultColorScheme===t)return":root";const n=i[t]?.palette?.mode||t;return{[`@media (prefers-color-scheme: ${n})`]:{":root":r}}}if(n)return e.defaultColorScheme===t?`:root, ${n.replace("%s",String(t))}`:n.replace("%s",String(t))}return":root"}return{vars:h,generateThemeVars:()=>{let e={...l};return Object.entries(p).forEach((([,{vars:t}])=>{e=Ue(e,t)})),e},generateStyleSheets:()=>{const t=[],o=e.defaultColorScheme||"light";function a(e,r){Object.keys(r).length&&t.push("string"==typeof e?{[e]:{...r}}:e)}a(r(void 0,{...u}),u);const{[o]:s,...c}=p;if(s){const{css:e}=s,t=i[o]?.palette?.mode,c=!n&&t?{colorScheme:t,...e}:{...e};a(r(o,{...c}),c)}return Object.entries(c).forEach((([e,{css:t}])=>{const o=i[e]?.palette?.mode,s=!n&&o?{colorScheme:o,...t}:{...t};a(r(e,{...s}),s)})),t}}}(w,A);return w.vars=k,Object.entries(w.colorSchemes[w.defaultColorScheme]).forEach((([e,t])=>{w[e]=t})),w.generateThemeVars=S,w.generateStyleSheets=T,w.generateSpacing=function(){return sn(l.spacing,en(this))},w.getColorSchemeSelector=function(e){return function(t){return"media"===e?`@media (prefers-color-scheme: ${t})`:e?e.startsWith("data-")&&!e.includes("%s")?`[${e}="${t}"] &`:"class"===e?`.${t} &`:"data"===e?`[data-${t}] &`:`${e.replace("%s",t)} &`:"&"}}(s),w.spacing=w.generateSpacing(),w.shouldSkipGeneratingVar=a,w.unstable_sxConfig={...Bn,...l?.unstable_sxConfig},w.unstable_sx=function(e){return Hn({sx:e,theme:this})},w.toRuntimeSource=Ci,w}function Bi(e,t,r){e.colorSchemes&&r&&(e.colorSchemes[t]={...!0!==r&&r,palette:ii({...!0===r?{}:r.palette,mode:t})})}function Li(e={},...t){const{palette:r,cssVariables:n=!1,colorSchemes:o=(r?void 0:{light:!0}),defaultColorScheme:i=r?.mode,...a}=e,s=i||"light",c=o?.[s],l={...o,...r?{[s]:{..."boolean"!=typeof c&&c,palette:r}}:void 0};if(!1===n){if(!("colorSchemes"in e))return Ai(e,...t);let n=r;"palette"in e||l[s]&&(!0!==l[s]?n=l[s].palette:"dark"===s&&(n={mode:"dark"}));const o=Ai({...e,palette:n},...t);return o.defaultColorScheme=s,o.colorSchemes=l,"light"===o.palette.mode&&(o.colorSchemes.light={...!0!==l.light&&l.light,palette:o.palette},Bi(o,"dark",l.dark)),"dark"===o.palette.mode&&(o.colorSchemes.dark={...!0!==l.dark&&l.dark,palette:o.palette},Bi(o,"light",l.light)),o}return r||"light"in l||"light"!==s||(l.light=!0),Ni({...a,colorSchemes:l,defaultColorScheme:s,..."boolean"!=typeof n&&n},...t)}var Hi=Li(),$i="$$material",qi=e=>function(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}(e)&&"classes"!==e,Fi=Wn({themeId:$i,defaultTheme:Hi,rootShouldForwardProp:qi});const Di=n.createContext(void 0);function Ui(e){return function({props:e,name:t}){return function(e){const{theme:t,name:r,props:n}=e;if(!t||!t.components||!t.components[r])return n;const o=t.components[r];return o.defaultProps?Yn(o.defaultProps,n):o.styleOverrides||o.variants?n:Yn(o,n)}({props:e,name:t,theme:{components:n.useContext(Di)}})}(e)}const ji=function(e={}){const{createStyledComponent:t=ro,useThemeProps:r=no,componentName:o="MuiStack"}=e,i=t(io),a=n.forwardRef((function(e,t){const n=Xn(r(e)),{component:a="div",direction:s="column",spacing:c=0,divider:l,children:u,className:d,useFlexGap:h=!1,...p}=n,f={direction:s,spacing:c,useFlexGap:h},g=Ge({root:["root"]},(e=>We(o,e)),{});return(0,Zn.jsx)(i,{as:a,ownerState:f,ref:t,className:$e(g.root,d),...p,children:l?oo(u,l):u})}));return a}({createStyledComponent:Fi("div",{name:"MuiStack",slot:"Root"}),useThemeProps:e=>Ui({props:e,name:"MuiStack"})});var zi=ji;const Ki={theme:void 0};var Wi=function(e){let t,r;return function(n){let o=t;return void 0!==o&&n.theme===r||(Ki.theme=n.theme,o=Fn(e(Ki)),t=o,r=n.theme),o}},Gi=Dr;function Vi(e=[]){return([,t])=>t&&function(e,t=[]){if(!function(e){return"string"==typeof e.main}(e))return!1;for(const r of t)if(!e.hasOwnProperty(r)||"string"!=typeof e[r])return!1;return!0}(t,e)}function Yi(e,t,r="Mui"){const n={};return t.forEach((t=>{n[t]=We(e,t,r)})),n}function Qi(e){return We("MuiTypography",e)}Yi("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const Ji={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},Xi=Xn,Zi=Fi("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.variant&&t[r.variant],"inherit"!==r.align&&t[`align${Gi(r.align)}`],r.noWrap&&t.noWrap,r.gutterBottom&&t.gutterBottom,r.paragraph&&t.paragraph]}})(Wi((({theme:e})=>({margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(e.typography).filter((([e,t])=>"inherit"!==e&&t&&"object"==typeof t)).map((([e,t])=>({props:{variant:e},style:t}))),...Object.entries(e.palette).filter(Vi()).map((([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}}))),...Object.entries(e.palette?.text||{}).filter((([,e])=>"string"==typeof e)).map((([t])=>({props:{color:`text${Gi(t)}`},style:{color:(e.vars||e).palette.text[t]}}))),{props:({ownerState:e})=>"inherit"!==e.align,style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:e})=>e.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:e})=>e.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:e})=>e.paragraph,style:{marginBottom:16}}]})))),ea={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"};var ta=n.forwardRef((function(e,t){const{color:r,...n}=Ui({props:e,name:"MuiTypography"}),o=Xi({...n,...!Ji[r]&&{color:r}}),{align:i="inherit",className:a,component:s,gutterBottom:c=!1,noWrap:l=!1,paragraph:u=!1,variant:d="body1",variantMapping:h=ea,...p}=o,f={...o,align:i,color:r,className:a,component:s,gutterBottom:c,noWrap:l,paragraph:u,variant:d,variantMapping:h},g=s||(u?"p":h[d]||ea[d])||"span",m=(e=>{const{align:t,gutterBottom:r,noWrap:n,paragraph:o,variant:i,classes:a}=e;return Ge({root:["root",i,"inherit"!==e.align&&`align${Gi(t)}`,r&&"gutterBottom",n&&"noWrap",o&&"paragraph"]},Qi,a)})(f);return(0,Zn.jsx)(Zi,{as:g,ref:t,className:$e(m.root,a),...p,ownerState:f,style:{..."inherit"!==i&&{"--Typography-textAlign":i},...p.style}})}));let ra=0;const na={...o}.useId;var oa=function(e){if(void 0!==na){const t=na();return e??t}return function(e){const[t,r]=n.useState(e),o=e||t;return n.useEffect((()=>{null==t&&(ra+=1,r(`mui-${ra}`))}),[t]),o}(e)};function ia(e){try{return e.matches(":focus-visible")}catch(e){}return!1}function aa(...e){const t=n.useRef(void 0),r=n.useCallback((t=>{const r=e.map((e=>{if(null==e)return null;if("function"==typeof e){const r=e,n=r(t);return"function"==typeof n?n:()=>{r(null)}}return e.current=t,()=>{e.current=null}}));return()=>{r.forEach((e=>e?.()))}}),e);return n.useMemo((()=>e.every((e=>null==e))?null:e=>{t.current&&(t.current(),t.current=void 0),null!=e&&(t.current=r(e))}),e)}var sa=aa,ca="undefined"!=typeof window?n.useLayoutEffect:n.useEffect,la=function(e){const t=n.useRef(e);return ca((()=>{t.current=e})),n.useRef(((...e)=>(0,t.current)(...e))).current};const ua={};function da(e,t){const r=n.useRef(ua);return r.current===ua&&(r.current=e(t)),r}var ha=r(64583).Promise;class pa{static create(){return new pa}static use(){const e=da(pa.create).current,[t,r]=n.useState(!1);return e.shouldMount=t,e.setShouldMount=r,n.useEffect(e.mountEffect,[t]),e}constructor(){this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}mount(){return this.mounted||(this.mounted=function(){let e,t;const r=new ha(((r,n)=>{e=r,t=n}));return r.resolve=e,r.reject=t,r}(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}mountEffect=()=>{this.shouldMount&&!this.didMount&&null!==this.ref.current&&(this.didMount=!0,this.mounted.resolve())};start(...e){this.mount().then((()=>this.ref.current?.start(...e)))}stop(...e){this.mount().then((()=>this.ref.current?.stop(...e)))}pulsate(...e){this.mount().then((()=>this.ref.current?.pulsate(...e)))}}function fa(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}function ga(e,t){return ga=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ga(e,t)}function ma(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,ga(e,t)}var ya=n.createContext(null);function va(e,t){var r=Object.create(null);return e&&n.Children.map(e,(function(e){return e})).forEach((function(e){r[e.key]=function(e){return t&&(0,n.isValidElement)(e)?t(e):e}(e)})),r}function ba(e,t,r){return null!=r[t]?r[t]:e.props[t]}function wa(e,t,r){var o=va(e.children),i=function(e,t){function r(r){return r in t?t[r]:e[r]}e=e||{},t=t||{};var n,o=Object.create(null),i=[];for(var a in e)a in t?i.length&&(o[a]=i,i=[]):i.push(a);var s={};for(var c in t){if(o[c])for(n=0;n<o[c].length;n++){var l=o[c][n];s[o[c][n]]=r(l)}s[c]=r(c)}for(n=0;n<i.length;n++)s[i[n]]=r(i[n]);return s}(t,o);return Object.keys(i).forEach((function(a){var s=i[a];if((0,n.isValidElement)(s)){var c=a in t,l=a in o,u=t[a],d=(0,n.isValidElement)(u)&&!u.props.in;!l||c&&!d?l||!c||d?l&&c&&(0,n.isValidElement)(u)&&(i[a]=(0,n.cloneElement)(s,{onExited:r.bind(null,s),in:u.props.in,exit:ba(s,"exit",e),enter:ba(s,"enter",e)})):i[a]=(0,n.cloneElement)(s,{in:!1}):i[a]=(0,n.cloneElement)(s,{onExited:r.bind(null,s),in:!0,exit:ba(s,"exit",e),enter:ba(s,"enter",e)})}})),i}var Ca=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},Aa=function(e){function t(t,r){var n,o=(n=e.call(this,t,r)||this).handleExited.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n));return n.state={contextValue:{isMounting:!0},handleExited:o,firstRender:!0},n}ma(t,e);var r=t.prototype;return r.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},r.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,t){var r,o,i=t.children,a=t.handleExited;return{children:t.firstRender?(r=e,o=a,va(r.children,(function(e){return(0,n.cloneElement)(e,{onExited:o.bind(null,e),in:!0,appear:ba(e,"appear",r),enter:ba(e,"enter",r),exit:ba(e,"exit",r)})}))):wa(e,i,a),firstRender:!1}},r.handleExited=function(e,t){var r=va(this.props.children);e.key in r||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var r=Ve({},t.children);return delete r[e.key],{children:r}})))},r.render=function(){var e=this.props,t=e.component,r=e.childFactory,o=fa(e,["component","childFactory"]),i=this.state.contextValue,a=Ca(this.state.children).map(r);return delete o.appear,delete o.enter,delete o.exit,null===t?n.createElement(ya.Provider,{value:i},a):n.createElement(ya.Provider,{value:i},n.createElement(t,o,a))},t}(n.Component);Aa.propTypes={},Aa.defaultProps={component:"div",childFactory:function(e){return e}};var ka=Aa;const Sa=[];class Ta{static create(){return new Ta}currentId=null;start(e,t){this.clear(),this.currentId=setTimeout((()=>{this.currentId=null,t()}),e)}clear=()=>{null!==this.currentId&&(clearTimeout(this.currentId),this.currentId=null)};disposeEffect=()=>this.clear}function Ia(){const e=da(Ta.create).current;var t;return t=e.disposeEffect,n.useEffect(t,Sa),e}r(4146);var xa,_a,Ea=function(e,t){var r=arguments;if(null==t||!yr.call(t,"css"))return n.createElement.apply(void 0,r);var o=r.length,i=new Array(o);i[0]=wr,i[1]=function(e,t){var r={};for(var n in t)yr.call(t,n)&&(r[n]=t[n]);return r[vr]=e,r}(e,t);for(var a=2;a<o;a++)i[a]=r[a];return n.createElement.apply(null,i)};function Pa(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return dr(t)}function Ra(){var e=Pa.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}xa=Ea||(Ea={}),_a||(_a=xa.JSX||(xa.JSX={}));var Oa=Yi("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]);const Ma=Ra`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,Na=Ra`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,Ba=Ra`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,La=Fi("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),Ha=Fi((function(e){const{className:t,classes:r,pulsate:o=!1,rippleX:i,rippleY:a,rippleSize:s,in:c,onExited:l,timeout:u}=e,[d,h]=n.useState(!1),p=$e(t,r.ripple,r.rippleVisible,o&&r.ripplePulsate),f={width:s,height:s,top:-s/2+a,left:-s/2+i},g=$e(r.child,d&&r.childLeaving,o&&r.childPulsate);return c||d||h(!0),n.useEffect((()=>{if(!c&&null!=l){const e=setTimeout(l,u);return()=>{clearTimeout(e)}}}),[l,c,u]),(0,Zn.jsx)("span",{className:p,style:f,children:(0,Zn.jsx)("span",{className:g})})}),{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${Oa.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${Ma};
    animation-duration: ${550}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  &.${Oa.ripplePulsate} {
    animation-duration: ${({theme:e})=>e.transitions.duration.shorter}ms;
  }

  & .${Oa.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${Oa.childLeaving} {
    opacity: 0;
    animation-name: ${Na};
    animation-duration: ${550}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  & .${Oa.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${Ba};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,$a=n.forwardRef((function(e,t){const r=Ui({props:e,name:"MuiTouchRipple"}),{center:o=!1,classes:i={},className:a,...s}=r,[c,l]=n.useState([]),u=n.useRef(0),d=n.useRef(null);n.useEffect((()=>{d.current&&(d.current(),d.current=null)}),[c]);const h=n.useRef(!1),p=Ia(),f=n.useRef(null),g=n.useRef(null),m=n.useCallback((e=>{const{pulsate:t,rippleX:r,rippleY:n,rippleSize:o,cb:a}=e;l((e=>[...e,(0,Zn.jsx)(Ha,{classes:{ripple:$e(i.ripple,Oa.ripple),rippleVisible:$e(i.rippleVisible,Oa.rippleVisible),ripplePulsate:$e(i.ripplePulsate,Oa.ripplePulsate),child:$e(i.child,Oa.child),childLeaving:$e(i.childLeaving,Oa.childLeaving),childPulsate:$e(i.childPulsate,Oa.childPulsate)},timeout:550,pulsate:t,rippleX:r,rippleY:n,rippleSize:o},u.current)])),u.current+=1,d.current=a}),[i]),y=n.useCallback(((e={},t={},r=()=>{})=>{const{pulsate:n=!1,center:i=o||t.pulsate,fakeElement:a=!1}=t;if("mousedown"===e?.type&&h.current)return void(h.current=!1);"touchstart"===e?.type&&(h.current=!0);const s=a?null:g.current,c=s?s.getBoundingClientRect():{width:0,height:0,left:0,top:0};let l,u,d;if(i||void 0===e||0===e.clientX&&0===e.clientY||!e.clientX&&!e.touches)l=Math.round(c.width/2),u=Math.round(c.height/2);else{const{clientX:t,clientY:r}=e.touches&&e.touches.length>0?e.touches[0]:e;l=Math.round(t-c.left),u=Math.round(r-c.top)}if(i)d=Math.sqrt((2*c.width**2+c.height**2)/3),d%2==0&&(d+=1);else{const e=2*Math.max(Math.abs((s?s.clientWidth:0)-l),l)+2,t=2*Math.max(Math.abs((s?s.clientHeight:0)-u),u)+2;d=Math.sqrt(e**2+t**2)}e?.touches?null===f.current&&(f.current=()=>{m({pulsate:n,rippleX:l,rippleY:u,rippleSize:d,cb:r})},p.start(80,(()=>{f.current&&(f.current(),f.current=null)}))):m({pulsate:n,rippleX:l,rippleY:u,rippleSize:d,cb:r})}),[o,m,p]),v=n.useCallback((()=>{y({},{pulsate:!0})}),[y]),b=n.useCallback(((e,t)=>{if(p.clear(),"touchend"===e?.type&&f.current)return f.current(),f.current=null,void p.start(0,(()=>{b(e,t)}));f.current=null,l((e=>e.length>0?e.slice(1):e)),d.current=t}),[p]);return n.useImperativeHandle(t,(()=>({pulsate:v,start:y,stop:b})),[v,y,b]),(0,Zn.jsx)(La,{className:$e(Oa.root,i.root,a),ref:g,...s,children:(0,Zn.jsx)(ka,{component:null,exit:!0,children:c})})}));var qa=$a;function Fa(e){return We("MuiButtonBase",e)}var Da=Yi("MuiButtonBase",["root","disabled","focusVisible"]);const Ua=Fi("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${Da.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}});function ja(e,t,r,n=!1){return la((o=>(r&&r(o),n||e[t](o),!0)))}var za=n.forwardRef((function(e,t){const r=Ui({props:e,name:"MuiButtonBase"}),{action:o,centerRipple:i=!1,children:a,className:s,component:c="button",disabled:l=!1,disableRipple:u=!1,disableTouchRipple:d=!1,focusRipple:h=!1,focusVisibleClassName:p,LinkComponent:f="a",onBlur:g,onClick:m,onContextMenu:y,onDragLeave:v,onFocus:b,onFocusVisible:w,onKeyDown:C,onKeyUp:A,onMouseDown:k,onMouseLeave:S,onMouseUp:T,onTouchEnd:I,onTouchMove:x,onTouchStart:_,tabIndex:E=0,TouchRippleProps:P,touchRippleRef:R,type:O,...M}=r,N=n.useRef(null),B=pa.use(),L=sa(B.ref,R),[H,$]=n.useState(!1);l&&H&&$(!1),n.useImperativeHandle(o,(()=>({focusVisible:()=>{$(!0),N.current.focus()}})),[]);const q=B.shouldMount&&!u&&!l;n.useEffect((()=>{H&&h&&!u&&B.pulsate()}),[u,h,H,B]);const F=ja(B,"start",k,d),D=ja(B,"stop",y,d),U=ja(B,"stop",v,d),j=ja(B,"stop",T,d),z=ja(B,"stop",(e=>{H&&e.preventDefault(),S&&S(e)}),d),K=ja(B,"start",_,d),W=ja(B,"stop",I,d),G=ja(B,"stop",x,d),V=ja(B,"stop",(e=>{ia(e.target)||$(!1),g&&g(e)}),!1),Y=la((e=>{N.current||(N.current=e.currentTarget),ia(e.target)&&($(!0),w&&w(e)),b&&b(e)})),Q=()=>{const e=N.current;return c&&"button"!==c&&!("A"===e.tagName&&e.href)},J=la((e=>{h&&!e.repeat&&H&&" "===e.key&&B.stop(e,(()=>{B.start(e)})),e.target===e.currentTarget&&Q()&&" "===e.key&&e.preventDefault(),C&&C(e),e.target===e.currentTarget&&Q()&&"Enter"===e.key&&!l&&(e.preventDefault(),m&&m(e))})),X=la((e=>{h&&" "===e.key&&H&&!e.defaultPrevented&&B.stop(e,(()=>{B.pulsate(e)})),A&&A(e),m&&e.target===e.currentTarget&&Q()&&" "===e.key&&!e.defaultPrevented&&m(e)}));let Z=c;"button"===Z&&(M.href||M.to)&&(Z=f);const ee={};"button"===Z?(ee.type=void 0===O?"button":O,ee.disabled=l):(M.href||M.to||(ee.role="button"),l&&(ee["aria-disabled"]=l));const te=sa(t,N),re={...r,centerRipple:i,component:c,disabled:l,disableRipple:u,disableTouchRipple:d,focusRipple:h,tabIndex:E,focusVisible:H},ne=(e=>{const{disabled:t,focusVisible:r,focusVisibleClassName:n,classes:o}=e,i=Ge({root:["root",t&&"disabled",r&&"focusVisible"]},Fa,o);return r&&n&&(i.root+=` ${n}`),i})(re);return(0,Zn.jsxs)(Ua,{as:Z,className:$e(ne.root,s),ownerState:re,onBlur:V,onClick:m,onContextMenu:D,onFocus:Y,onKeyDown:J,onKeyUp:X,onMouseDown:F,onMouseLeave:z,onMouseUp:j,onDragLeave:U,onTouchEnd:W,onTouchMove:G,onTouchStart:K,ref:te,tabIndex:l?-1:E,type:O,...ee,...M,children:[a,q?(0,Zn.jsx)(qa,{ref:L,center:i,...P}):null]})}));function Ka(e){return We("MuiCircularProgress",e)}var Wa=Yi("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const Ga=Ra`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,Va=Ra`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,Ya="string"!=typeof Ga?Pa`
        animation: ${Ga} 1.4s linear infinite;
      `:null,Qa="string"!=typeof Va?Pa`
        animation: ${Va} 1.4s ease-in-out infinite;
      `:null,Ja=Fi("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[r.variant],t[`color${Gi(r.color)}`]]}})(Wi((({theme:e})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("transform")}},{props:{variant:"indeterminate"},style:Ya||{animation:`${Ga} 1.4s linear infinite`}},...Object.entries(e.palette).filter(Vi()).map((([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}})))]})))),Xa=Fi("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),Za=Fi("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.circle,t[`circle${Gi(r.variant)}`],r.disableShrink&&t.circleDisableShrink]}})(Wi((({theme:e})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:e})=>"indeterminate"===e.variant&&!e.disableShrink,style:Qa||{animation:`${Va} 1.4s ease-in-out infinite`}}]}))));var es=n.forwardRef((function(e,t){const r=Ui({props:e,name:"MuiCircularProgress"}),{className:n,color:o="primary",disableShrink:i=!1,size:a=40,style:s,thickness:c=3.6,value:l=0,variant:u="indeterminate",...d}=r,h={...r,color:o,disableShrink:i,size:a,thickness:c,value:l,variant:u},p=(e=>{const{classes:t,variant:r,color:n,disableShrink:o}=e;return Ge({root:["root",r,`color${Gi(n)}`],svg:["svg"],circle:["circle",`circle${Gi(r)}`,o&&"circleDisableShrink"]},Ka,t)})(h),f={},g={},m={};if("determinate"===u){const e=2*Math.PI*((44-c)/2);f.strokeDasharray=e.toFixed(3),m["aria-valuenow"]=Math.round(l),f.strokeDashoffset=`${((100-l)/100*e).toFixed(3)}px`,g.transform="rotate(-90deg)"}return(0,Zn.jsx)(Ja,{className:$e(p.root,n),style:{width:a,height:a,...g,...s},ownerState:h,ref:t,role:"progressbar",...m,...d,children:(0,Zn.jsx)(Xa,{className:p.svg,ownerState:h,viewBox:"22 22 44 44",children:(0,Zn.jsx)(Za,{className:p.circle,style:f,ownerState:h,cx:44,cy:44,r:(44-c)/2,fill:"none",strokeWidth:c})})})}));function ts(e){return We("MuiButton",e)}var rs=Yi("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),ns=n.createContext({}),os=n.createContext(void 0);const is=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],as=Fi(za,{shouldForwardProp:e=>qi(e)||"classes"===e,name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[r.variant],t[`${r.variant}${Gi(r.color)}`],t[`size${Gi(r.size)}`],t[`${r.variant}Size${Gi(r.size)}`],"inherit"===r.color&&t.colorInherit,r.disableElevation&&t.disableElevation,r.fullWidth&&t.fullWidth,r.loading&&t.loading]}})(Wi((({theme:e})=>{const t="light"===e.palette.mode?e.palette.grey[300]:e.palette.grey[800],r="light"===e.palette.mode?e.palette.grey.A100:e.palette.grey[700];return{...e.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create(["background-color","box-shadow","border-color","color"],{duration:e.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${rs.disabled}`]:{color:(e.vars||e).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(e.vars||e).shadows[2],"&:hover":{boxShadow:(e.vars||e).shadows[4],"@media (hover: none)":{boxShadow:(e.vars||e).shadows[2]}},"&:active":{boxShadow:(e.vars||e).shadows[8]},[`&.${rs.focusVisible}`]:{boxShadow:(e.vars||e).shadows[6]},[`&.${rs.disabled}`]:{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${rs.disabled}`]:{border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(e.palette).filter(Vi()).map((([t])=>({props:{color:t},style:{"--variant-textColor":(e.vars||e).palette[t].main,"--variant-outlinedColor":(e.vars||e).palette[t].main,"--variant-outlinedBorder":e.vars?`rgba(${e.vars.palette[t].mainChannel} / 0.5)`:po(e.palette[t].main,.5),"--variant-containedColor":(e.vars||e).palette[t].contrastText,"--variant-containedBg":(e.vars||e).palette[t].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(e.vars||e).palette[t].dark,"--variant-textBg":e.vars?`rgba(${e.vars.palette[t].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:po(e.palette[t].main,e.palette.action.hoverOpacity),"--variant-outlinedBorder":(e.vars||e).palette[t].main,"--variant-outlinedBg":e.vars?`rgba(${e.vars.palette[t].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:po(e.palette[t].main,e.palette.action.hoverOpacity)}}}}))),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":e.vars?e.vars.palette.Button.inheritContainedBg:t,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":e.vars?e.vars.palette.Button.inheritContainedHoverBg:r,"--variant-textBg":e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:po(e.palette.text.primary,e.palette.action.hoverOpacity),"--variant-outlinedBg":e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:po(e.palette.text.primary,e.palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:e.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:e.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:e.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${rs.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${rs.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),[`&.${rs.loading}`]:{color:"transparent"}}}]}}))),ss=Fi("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.startIcon,r.loading&&t.startIconLoadingStart,t[`iconSize${Gi(r.size)}`]]}})((({theme:e})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...is]}))),cs=Fi("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.endIcon,r.loading&&t.endIconLoadingEnd,t[`iconSize${Gi(r.size)}`]]}})((({theme:e})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...is]}))),ls=Fi("span",{name:"MuiButton",slot:"LoadingIndicator"})((({theme:e})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(e.vars||e).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]}))),us=Fi("span",{name:"MuiButton",slot:"LoadingIconPlaceholder"})({display:"inline-block",width:"1em",height:"1em"});var ds=n.forwardRef((function(e,t){const r=n.useContext(ns),o=n.useContext(os),i=Ui({props:Yn(r,e),name:"MuiButton"}),{children:a,color:s="primary",component:c="button",className:l,disabled:u=!1,disableElevation:d=!1,disableFocusRipple:h=!1,endIcon:p,focusVisibleClassName:f,fullWidth:g=!1,id:m,loading:y=null,loadingIndicator:v,loadingPosition:b="center",size:w="medium",startIcon:C,type:A,variant:k="text",...S}=i,T=oa(m),I=v??(0,Zn.jsx)(es,{"aria-labelledby":T,color:"inherit",size:16}),x={...i,color:s,component:c,disabled:u,disableElevation:d,disableFocusRipple:h,fullWidth:g,loading:y,loadingIndicator:I,loadingPosition:b,size:w,type:A,variant:k},_=(e=>{const{color:t,disableElevation:r,fullWidth:n,size:o,variant:i,loading:a,loadingPosition:s,classes:c}=e,l=Ge({root:["root",a&&"loading",i,`${i}${Gi(t)}`,`size${Gi(o)}`,`${i}Size${Gi(o)}`,`color${Gi(t)}`,r&&"disableElevation",n&&"fullWidth",a&&`loadingPosition${Gi(s)}`],startIcon:["icon","startIcon",`iconSize${Gi(o)}`],endIcon:["icon","endIcon",`iconSize${Gi(o)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},ts,c);return{...c,...l}})(x),E=(C||y&&"start"===b)&&(0,Zn.jsx)(ss,{className:_.startIcon,ownerState:x,children:C||(0,Zn.jsx)(us,{className:_.loadingIconPlaceholder,ownerState:x})}),P=(p||y&&"end"===b)&&(0,Zn.jsx)(cs,{className:_.endIcon,ownerState:x,children:p||(0,Zn.jsx)(us,{className:_.loadingIconPlaceholder,ownerState:x})}),R=o||"",O="boolean"==typeof y?(0,Zn.jsx)("span",{className:_.loadingWrapper,style:{display:"contents"},children:y&&(0,Zn.jsx)(ls,{className:_.loadingIndicator,ownerState:x,children:I})}):null;return(0,Zn.jsxs)(as,{ownerState:x,className:$e(r.className,_.root,l,R),component:c,disabled:u||y,focusRipple:!h,focusVisibleClassName:$e(_.focusVisible,f),ref:t,type:A,id:y?T:m,...S,classes:_,children:[E,"end"!==b&&O,a,"end"===b&&O,P]})})),hs={description:"This is a Phish! – Protect against phishing attacks, enforce email policies, and ensure compliance with seamless Microsoft 365 integration.",login_with_microsoft:"Login with Microsoft"},ps={title:"Report Phishing Email",description:"You are about to report the following email as suspicious:",from:"From:",subject:"Subject:",received:"Received:",report_email:"Are you sure you want to report this as a phishing email?",button:"Report as Phishing",success:{title:"Suspected Phishing Attempt",loading:{title:"Processing Report...",description:"Please wait while we process your report."},success_msg:"Thank you for reporting this email.",description:"The email will automatically include the correct email address to report this to. It will also attach the reported email and include the email headers for analysis. After sending, the email will be reviewed and actioned accordingly.",buttons:{done:"Done",deleting:"Deleting..."}}},fs=Yi("MuiBox",["root"]);const gs=Li(),ms=function(e={}){const{themeId:t,defaultTheme:r,defaultClassName:o="MuiBox-root",generateClassName:i}=e,a=_r("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(Hn);return n.forwardRef((function(e,n){const s=Jn(r),{className:c,component:l="div",...u}=Xn(e);return(0,Zn.jsx)(a,{as:l,ref:n,className:$e(c,i?i(o):o),theme:t&&s[t]||s,...u})}))}({themeId:$i,defaultTheme:gs,defaultClassName:fs.root,generateClassName:ze.generate});var ys=ms,vs=function(){var e;return n.createElement(n.Fragment,null,n.createElement("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(246, 246, 246, 0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:9999}},n.createElement(ys,{sx:{position:"relative"}},n.createElement(es,{variant:"determinate",sx:{color:function(e){return e.palette.grey["light"===e.palette.mode?200:800]}},size:40,thickness:4,value:100}),n.createElement(es,{variant:"indeterminate",disableShrink:!0,sx:(e={color:"transparent",animationDuration:"550ms",position:"absolute",left:0},e["& .".concat(Wa.circle)]={strokeLinecap:"round",stroke:"url(#linearColors)"},e),size:40,thickness:4}),n.createElement("svg",{width:"0",height:"0"},n.createElement("defs",null,n.createElement("linearGradient",{id:"linearColors",x1:"1",y1:"0",x2:"0",y2:"1"},n.createElement("stop",{offset:"0%",stopColor:"#1B5EBE"}),n.createElement("stop",{offset:"100%",stopColor:"#1B5EBE"})))))))};const bs={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},ws=[bs.OPENID_SCOPE,bs.PROFILE_SCOPE,bs.OFFLINE_ACCESS_SCOPE],Cs=[...ws,bs.EMAIL_SCOPE],As="Content-Type",ks="Retry-After",Ss="X-AnchorMailbox",Ts="x-ms-request-id",Is="x-ms-httpver",xs="active-account-filters",_s="common",Es="organizations",Ps="consumers",Rs="access_token",Os={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},Ms={PLAIN:"plain",S256:"S256"},Ns="query",Bs="Generic",Ls="-",Hs={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},$s="appmetadata",qs="1",Fs="authority-metadata",Ds="config",Us="cache",js="network",zs="hardcoded_values",Ks={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},Ws={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},Gs="throttling";var Vs;!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(Vs||(Vs={}));class Ys{constructor(e,t,r){this.level=Vs.Info;const n=e||Ys.createDefaultLoggerOptions();this.localCallback=n.loggerCallback||(()=>{}),this.piiLoggingEnabled=n.piiLoggingEnabled||!1,this.level="number"==typeof n.logLevel?n.logLevel:Vs.Info,this.correlationId=n.correlationId||bs.EMPTY_STRING,this.packageName=t||bs.EMPTY_STRING,this.packageVersion=r||bs.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Vs.Info}}clone(e,t,r){return new Ys({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const r=`[${(new Date).toUTCString()}] : [${t.correlationId||this.correlationId||""}] : ${this.packageName}@${this.packageVersion} : ${Vs[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,r,t.containsPii||!1)}executeCallback(e,t,r){this.localCallback&&this.localCallback(e,t,r)}error(e,t){this.logMessage(e,{logLevel:Vs.Error,containsPii:!1,correlationId:t||bs.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:Vs.Error,containsPii:!0,correlationId:t||bs.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:Vs.Warning,containsPii:!1,correlationId:t||bs.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:Vs.Warning,containsPii:!0,correlationId:t||bs.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:Vs.Info,containsPii:!1,correlationId:t||bs.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:Vs.Info,containsPii:!0,correlationId:t||bs.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:Vs.Verbose,containsPii:!1,correlationId:t||bs.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:Vs.Verbose,containsPii:!0,correlationId:t||bs.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:Vs.Trace,containsPii:!1,correlationId:t||bs.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:Vs.Trace,containsPii:!0,correlationId:t||bs.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}const Qs="OIDC",Js="EAR",Xs="none",Zs="unexpected_error",ec="post_request_failed",tc={[Zs]:"Unexpected error in authentication.",[ec]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class rc extends Error{constructor(e,t,r){super(t?`${e}: ${t}`:e),Object.setPrototypeOf(this,rc.prototype),this.errorCode=e||bs.EMPTY_STRING,this.errorMessage=t||bs.EMPTY_STRING,this.subError=r||bs.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function nc(e,t){return new rc(e,t?`${tc[e]} ${t}`:tc[e])}const oc="client_info_decoding_error",ic="client_info_empty_error",ac="token_parsing_error",sc="null_or_empty_token",cc="endpoints_resolution_error",lc="network_error",uc="openid_config_error",dc="hash_not_deserialized",hc="invalid_state",pc="state_mismatch",fc="state_not_found",gc="nonce_mismatch",mc="auth_time_not_found",yc="max_age_transpired",vc="multiple_matching_tokens",bc="multiple_matching_accounts",wc="multiple_matching_appMetadata",Cc="request_cannot_be_made",Ac="cannot_remove_empty_scope",kc="cannot_append_scopeset",Sc="empty_input_scopeset",Tc="device_code_polling_cancelled",Ic="device_code_expired",xc="device_code_unknown_error",_c="no_account_in_silent_request",Ec="invalid_cache_record",Pc="invalid_cache_environment",Rc="no_account_found",Oc="no_crypto_object",Mc="unexpected_credential_type",Nc="invalid_assertion",Bc="invalid_client_credential",Lc="token_refresh_required",Hc="user_timeout_reached",$c="token_claims_cnf_required_for_signedjwt",qc="authorization_code_missing_from_server_response",Fc="binding_key_not_removed",Dc="end_session_endpoint_not_supported",Uc="key_id_missing",jc="no_network_connectivity",zc="user_canceled",Kc="missing_tenant_id_error",Wc="method_not_implemented",Gc="nested_app_auth_bridge_disabled",Vc={[oc]:"The client info could not be parsed/decoded correctly",[ic]:"The client info was empty",[ac]:"Token cannot be parsed",[sc]:"The token is null or empty",[cc]:"Endpoints cannot be resolved",[lc]:"Network request failed",[uc]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[dc]:"The hash parameters could not be deserialized",[hc]:"State was not the expected format",[pc]:"State mismatch error",[fc]:"State not found",[gc]:"Nonce mismatch error",[mc]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[yc]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[vc]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[bc]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[wc]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[Cc]:"Token request cannot be made without authorization code or refresh token.",[Ac]:"Cannot remove null or empty scope from ScopeSet",[kc]:"Cannot append ScopeSet",[Sc]:"Empty input ScopeSet cannot be processed",[Tc]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[Ic]:"Device code is expired.",[xc]:"Device code stopped polling for unknown reasons.",[_c]:"Please pass an account object, silent flow is not supported without account information",[Ec]:"Cache record object was null or undefined.",[Pc]:"Invalid environment when attempting to create cache entry",[Rc]:"No account found in cache for given key.",[Oc]:"No crypto object detected.",[Mc]:"Unexpected credential type.",[Nc]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[Bc]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Lc]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[Hc]:"User defined timeout for device code polling reached",[$c]:"Cannot generate a POP jwt if the token_claims are not populated",[qc]:"Server response does not contain an authorization code to proceed",[Fc]:"Could not remove the credential's binding key from storage.",[Dc]:"The provided authority does not support logout",[Uc]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[jc]:"No network connectivity. Check your internet connection.",[zc]:"User cancelled the flow.",[Kc]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[Wc]:"This method has not been implemented",[Gc]:"The nested app auth bridge is disabled"};class Yc extends rc{constructor(e,t){super(e,t?`${Vc[e]}: ${t}`:Vc[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,Yc.prototype)}}function Qc(e,t){return new Yc(e,t)}const Jc={createNewGuid:()=>{throw Qc(Wc)},base64Decode:()=>{throw Qc(Wc)},base64Encode:()=>{throw Qc(Wc)},base64UrlEncode:()=>{throw Qc(Wc)},encodeKid:()=>{throw Qc(Wc)},async getPublicKeyThumbprint(){throw Qc(Wc)},async removeTokenBindingKey(){throw Qc(Wc)},async clearKeystore(){throw Qc(Wc)},async signJwt(){throw Qc(Wc)},async hashString(){throw Qc(Wc)}},Xc="@azure/msal-common",Zc="15.6.0";function el(e,t){const r=function(e){if(!e)throw Qc(sc);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw Qc(ac);return t[2]}(e);try{const e=t(r);return JSON.parse(e)}catch(e){throw Qc(ac)}}function tl(e,t){if(0===t||Date.now()-3e5>e+t)throw Qc(yc)}function rl(){return Math.round((new Date).getTime()/1e3)}function nl(e){return e.getTime()/1e3}function ol(e){return e?new Date(1e3*Number(e)):new Date}function il(e,t){const r=Number(e)||0;return rl()+t>r}function al(e){return[dl(e),hl(e),pl(e),fl(e),gl(e)].join(Ls).toLowerCase()}function sl(e,t,r,n,o){return{credentialType:Hs.ID_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r,realm:o}}function cl(e,t,r,n,o,i,a,s,c,l,u,d,h,p,f){const g={homeAccountId:e,credentialType:Hs.ACCESS_TOKEN,secret:r,cachedAt:rl().toString(),expiresOn:a.toString(),extendedExpiresOn:s.toString(),environment:t,clientId:n,realm:o,target:i,tokenType:u||Ws.BEARER};if(d&&(g.userAssertionHash=d),l&&(g.refreshOn=l.toString()),p&&(g.requestedClaims=p,g.requestedClaimsHash=f),g.tokenType?.toLowerCase()!==Ws.BEARER.toLowerCase())switch(g.credentialType=Hs.ACCESS_TOKEN_WITH_AUTH_SCHEME,g.tokenType){case Ws.POP:const e=el(r,c);if(!e?.cnf?.kid)throw Qc($c);g.keyId=e.cnf.kid;break;case Ws.SSH:g.keyId=h}return g}function ll(e,t,r,n,o,i,a){const s={credentialType:Hs.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r};return i&&(s.userAssertionHash=i),o&&(s.familyId=o),a&&(s.expiresOn=a.toString()),s}function ul(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function dl(e){return[e.homeAccountId,e.environment].join(Ls).toLowerCase()}function hl(e){const t=e.credentialType===Hs.REFRESH_TOKEN&&e.familyId||e.clientId;return[e.credentialType,t,e.realm||""].join(Ls).toLowerCase()}function pl(e){return(e.target||"").toLowerCase()}function fl(e){return(e.requestedClaimsHash||"").toLowerCase()}function gl(e){return e.tokenType&&e.tokenType.toLowerCase()!==Ws.BEARER.toLowerCase()?e.tokenType.toLowerCase():""}function ml(){return rl()+86400}function yl(e,t,r){e.authorization_endpoint=t.authorization_endpoint,e.token_endpoint=t.token_endpoint,e.end_session_endpoint=t.end_session_endpoint,e.issuer=t.issuer,e.endpointsFromNetwork=r,e.jwks_uri=t.jwks_uri}function vl(e,t,r){e.aliases=t.aliases,e.preferred_cache=t.preferred_cache,e.preferred_network=t.preferred_network,e.aliasesFromNetwork=r}function bl(e){return e.expiresAt<=rl()}r(64583).Promise;const wl="redirect_uri_empty",Cl="claims_request_parsing_error",Al="authority_uri_insecure",kl="url_parse_error",Sl="empty_url_error",Tl="empty_input_scopes_error",Il="invalid_prompt_value",xl="invalid_claims",_l="token_request_empty",El="logout_request_empty",Pl="invalid_code_challenge_method",Rl="pkce_params_missing",Ol="invalid_cloud_discovery_metadata",Ml="invalid_authority_metadata",Nl="untrusted_authority",Bl="missing_ssh_jwk",Ll="missing_ssh_kid",Hl="missing_nonce_authentication_header",$l="invalid_authentication_header",ql="cannot_set_OIDCOptions",Fl="cannot_allow_platform_broker",Dl="authority_mismatch",Ul={[wl]:"A redirect URI is required for all calls, and none has been set.",[Cl]:"Could not parse the given claims request object.",[Al]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[kl]:"URL could not be parsed into appropriate segments.",[Sl]:"URL was empty or null.",[Tl]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[Il]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[xl]:"Given claims parameter must be a stringified JSON object.",[_l]:"Token request was empty and not found in cache.",[El]:"The logout request was null or undefined.",[Pl]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[Rl]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[Ol]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[Ml]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[Nl]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[Bl]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[Ll]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[Hl]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[$l]:"Invalid authentication header provided",[ql]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[Fl]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[Dl]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class jl extends rc{constructor(e){super(e,Ul[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,jl.prototype)}}function zl(e){return new jl(e)}class Kl{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return 0===Object.keys(t).length}catch(e){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},r=e.split("&"),n=e=>decodeURIComponent(e.replace(/\+/g," "));return r.forEach((e=>{if(e.trim()){const[r,o]=e.split(/=(.+)/g,2);r&&o&&(t[n(r)]=n(o))}})),t}static trimArrayEntries(e){return e.map((e=>e.trim()))}static removeEmptyStringsFromArray(e){return e.filter((e=>!!e))}static jsonParseHelper(e){try{return JSON.parse(e)}catch(e){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}class Wl{constructor(e){const t=e?Kl.trimArrayEntries([...e]):[],r=t?Kl.removeEmptyStringsFromArray(t):[];if(!r||!r.length)throw zl(Tl);this.scopes=new Set,r.forEach((e=>this.scopes.add(e)))}static fromString(e){const t=(e||bs.EMPTY_STRING).split(" ");return new Wl(t)}static createSearchScopes(e){const t=new Wl(e);return t.containsOnlyOIDCScopes()?t.removeScope(bs.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}containsScope(e){const t=this.printScopesLowerCase().split(" "),r=new Wl(t);return!!e&&r.scopes.has(e.toLowerCase())}containsScopeSet(e){return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every((e=>this.containsScope(e)))}containsOnlyOIDCScopes(){let e=0;return Cs.forEach((t=>{this.containsScope(t)&&(e+=1)})),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach((e=>this.appendScope(e)))}catch(e){throw Qc(kc)}}removeScope(e){if(!e)throw Qc(Ac);this.scopes.delete(e.trim())}removeOIDCScopes(){Cs.forEach((e=>{this.scopes.delete(e)}))}unionScopeSets(e){if(!e)throw Qc(Sc);const t=new Set;return e.scopes.forEach((e=>t.add(e.toLowerCase()))),this.scopes.forEach((e=>t.add(e.toLowerCase()))),t}intersectingScopeSets(e){if(!e)throw Qc(Sc);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach((t=>e.push(t))),e}printScopes(){return this.scopes?this.asArray().join(" "):bs.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}function Gl(e,t){if(!e)throw Qc(ic);try{const r=t(e);return JSON.parse(r)}catch(e){throw Qc(oc)}}function Vl(e){if(!e)throw Qc(oc);const t=e.split(".",2);return{uid:t[0],utid:t.length<2?bs.EMPTY_STRING:t[1]}}function Yl(e,t){return!!e&&!!t&&e===t.split(".")[1]}function Ql(e,t,r,n){if(n){const{oid:t,sub:r,tid:o,name:i,tfp:a,acr:s}=n,c=o||a||s||"";return{tenantId:c,localAccountId:t||r||"",name:i,isHomeTenant:Yl(c,e)}}return{tenantId:r,localAccountId:t,isHomeTenant:Yl(r,e)}}function Jl(e,t,r,n){let o=e;if(t){const{isHomeTenant:r,...n}=t;o={...e,...n}}if(r){const{isHomeTenant:t,...i}=Ql(e.homeAccountId,e.localAccountId,e.tenantId,r);return o={...o,...i,idTokenClaims:r,idToken:n},o}return o}function Xl(e){return e&&(e.tid||e.tfp||e.acr)||null}class Zl{generateAccountId(){return[this.homeAccountId,this.environment].join(Ls).toLowerCase()}generateAccountKey(){return Zl.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map((e=>[e.tenantId,e])))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(Ls).toLowerCase()}static createAccount(e,t,r){const n=new Zl;let o;1===t.authorityType?n.authorityType="ADFS":t.protocolMode===Qs?n.authorityType=Bs:n.authorityType="MSSTS",e.clientInfo&&r&&(o=Gl(e.clientInfo,r)),n.clientInfo=e.clientInfo,n.homeAccountId=e.homeAccountId,n.nativeAccountId=e.nativeAccountId;const i=e.environment||t&&t.getPreferredCache();if(!i)throw Qc(Pc);n.environment=i,n.realm=o?.utid||Xl(e.idTokenClaims)||"",n.localAccountId=o?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";const a=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,s=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(n.username=a||s||"",n.name=e.idTokenClaims?.name||"",n.cloudGraphHostName=e.cloudGraphHostName,n.msGraphHost=e.msGraphHost,e.tenantProfiles)n.tenantProfiles=e.tenantProfiles;else{const t=Ql(e.homeAccountId,n.localAccountId,n.realm,e.idTokenClaims);n.tenantProfiles=[t]}return n}static createFromAccountInfo(e,t,r){const n=new Zl;return n.authorityType=e.authorityType||Bs,n.homeAccountId=e.homeAccountId,n.localAccountId=e.localAccountId,n.nativeAccountId=e.nativeAccountId,n.realm=e.tenantId,n.environment=e.environment,n.username=e.username,n.name=e.name,n.cloudGraphHostName=t,n.msGraphHost=r,n.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),n}static generateHomeAccountId(e,t,r,n,o){if(1!==t&&2!==t){if(e)try{const t=Gl(e,n.base64Decode);if(t.uid&&t.utid)return`${t.uid}.${t.utid}`}catch(e){}r.warning("No client info in response")}return o?.sub||""}static isAccountEntity(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")}static accountInfoIsEqual(e,t,r){if(!e||!t)return!1;let n=!0;if(r){const r=e.idTokenClaims||{},o=t.idTokenClaims||{};n=r.iat===o.iat&&r.nonce===o.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&n}}function eu(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}function tu(e){if(!e||e.indexOf("=")<0)return null;try{const t=eu(e),r=Object.fromEntries(new URLSearchParams(t));if(r.code||r.ear_jwe||r.error||r.error_description||r.state)return r}catch(e){throw Qc(dc)}return null}function ru(e,t=!0,r){const n=new Array;return e.forEach(((e,o)=>{!t&&r&&o in r?n.push(`${o}=${e}`):n.push(`${o}=${encodeURIComponent(e)}`)})),n.join("&")}class nu{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw zl(Sl);e.includes("#")||(this._urlString=nu.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return Kl.endsWith(t,"?")?t=t.slice(0,-1):Kl.endsWith(t,"?/")&&(t=t.slice(0,-2)),Kl.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(e){throw zl(kl)}if(!e.HostNameAndPort||!e.PathSegments)throw zl(kl);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw zl(Al)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return nu.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),r=t.PathSegments;return!e||0===r.length||r[0]!==_s&&r[0]!==Es||(r[0]=e),nu.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw zl(kl);const r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let n=r.AbsolutePath.split("/");return n=n.filter((e=>e&&e.length>0)),r.PathSegments=n,r.QueryString&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw zl(kl);return r[2]}static getAbsoluteUrl(e,t){if(e[0]===bs.FORWARD_SLASH){const r=new nu(t).getUrlComponents();return r.Protocol+"//"+r.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new nu(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!tu(e)}}const ou={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},iu={tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},au=new Set;function su(e,t,r,n){if(n?.trace(`getAliasesFromMetadata called with source: ${r}`),e&&t){const o=cu(t,e);if(o)return n?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${r}, returning aliases`),o.aliases;n?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${r}`)}return null}function cu(e,t){for(let r=0;r<e.length;r++){const n=e[r];if(n.aliases.includes(t))return n}return null}iu.metadata.forEach((e=>{e.aliases.forEach((e=>{au.add(e)}))}));const lu="cache_quota_exceeded",uu="cache_error_unknown",du={[lu]:"Exceeded cache storage capacity.",[uu]:"Unexpected error occurred when using cache storage."};class hu extends Error{constructor(e,t){const r=t||(du[e]?du[e]:du[uu]);super(`${e}: ${r}`),Object.setPrototypeOf(this,hu.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=r}}var pu=r(64583).Promise;class fu{constructor(e,t,r,n){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone(Xc,Zc),this.staticAuthorityOptions=n}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){const t=this.getAllAccounts(e);return t.length>1?t.sort((e=>e.idTokenClaims?-1:1))[0]:1===t.length?t[0]:null}getBaseAccountInfo(e){const t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}buildTenantProfiles(e,t){return e.flatMap((e=>this.getTenantProfilesFromAccountEntity(e,t?.tenantId,t)))}getTenantedAccountInfoByFilter(e,t,r,n){let o,i=null;if(n&&!this.tenantProfileMatchesFilter(r,n))return null;const a=this.getIdToken(e,t,r.tenantId);return a&&(o=el(a.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(o,n))?null:(i=Jl(e,r,o,a?.secret),i)}getTenantProfilesFromAccountEntity(e,t,r){const n=e.getAccountInfo();let o=n.tenantProfiles||new Map;const i=this.getTokenKeys();if(t){const e=o.get(t);if(!e)return[];o=new Map([[t,e]])}const a=[];return o.forEach((e=>{const t=this.getTenantedAccountInfoByFilter(n,i,e,r);t&&a.push(t)})),a}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||void 0!==t.isHomeTenant&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){if(t){if(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId))return!1;if(t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint))return!1;if(t.username&&!this.matchUsername(e.preferred_username,t.username))return!1;if(t.name&&!this.matchName(e,t.name))return!1;if(t.sid&&!this.matchSid(e,t.sid))return!1}return!0}async saveCacheRecord(e,t,r){if(!e)throw Qc(Ec);try{e.account&&await this.setAccount(e.account,t),e.idToken&&!1!==r?.idToken&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&!1!==r?.accessToken&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&!1!==r?.refreshToken&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(e){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),e instanceof Error?(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${e.message}`,t),"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||e.message.includes("exceeded the quota")?(this.commonLogger?.error("CacheManager.saveCacheRecord: exceeded storage quota",t),new hu(lu)):new hu(e.name,e.message)):(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${e}`,t),new hu(uu))}}async saveAccessToken(e,t){const r={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},n=this.getTokenKeys(),o=Wl.fromString(e.target),i=[];n.accessToken.forEach((e=>{if(!this.accessTokenKeyMatchesFilter(e,r,!1))return;const t=this.getAccessTokenCredential(e);t&&this.credentialMatchesFilter(t,r)&&Wl.fromString(t.target).intersectingScopeSets(o)&&i.push(this.removeAccessToken(e))})),await pu.all(i),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e){const t=this.getAccountKeys(),r=[];return t.forEach((t=>{if(!this.isAccountKey(t,e.homeAccountId))return;const n=this.getAccount(t,this.commonLogger);if(!n)return;if(e.homeAccountId&&!this.matchHomeAccountId(n,e.homeAccountId))return;if(e.username&&!this.matchUsername(n.username,e.username))return;if(e.environment&&!this.matchEnvironment(n,e.environment))return;if(e.realm&&!this.matchRealm(n,e.realm))return;if(e.nativeAccountId&&!this.matchNativeAccountId(n,e.nativeAccountId))return;if(e.authorityType&&!this.matchAuthorityType(n,e.authorityType))return;const o={localAccountId:e?.localAccountId,name:e?.name},i=n.tenantProfiles?.filter((e=>this.tenantProfileMatchesFilter(e,o)));i&&0===i.length||r.push(n)})),r}isAccountKey(e,t,r){return!(e.split(Ls).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||r&&!e.toLowerCase().includes(r.toLowerCase()))}isCredentialKey(e){if(e.split(Ls).length<6)return!1;const t=e.toLowerCase();if(-1===t.indexOf(Hs.ID_TOKEN.toLowerCase())&&-1===t.indexOf(Hs.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(Hs.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(Hs.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(Hs.REFRESH_TOKEN.toLowerCase())>-1){const e=`${Hs.REFRESH_TOKEN}${Ls}${this.clientId}${Ls}`,r=`${Hs.REFRESH_TOKEN}${Ls}${qs}${Ls}`;if(-1===t.indexOf(e.toLowerCase())&&-1===t.indexOf(r.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0}credentialMatchesFilter(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"==typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===Hs.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===Ws.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0}getAppMetadataFilteredBy(e){const t=this.getKeys(),r={};return t.forEach((t=>{if(!this.isAppMetadata(t))return;const n=this.getAppMetadata(t);n&&(e.environment&&!this.matchEnvironment(n,e.environment)||e.clientId&&!this.matchClientId(n,e.clientId)||(r[t]=n))})),r}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let r=null;return t.forEach((t=>{if(!this.isAuthorityMetadata(t)||-1===t.indexOf(this.clientId))return;const n=this.getAuthorityMetadata(t);n&&-1!==n.aliases.indexOf(e)&&(r=n)})),r}async removeAllAccounts(){const e=this.getAccountKeys(),t=[];e.forEach((e=>{t.push(this.removeAccount(e))})),await pu.all(t)}async removeAccount(e){const t=this.getAccount(e,this.commonLogger);t&&(await this.removeAccountContext(t),this.removeItem(e))}async removeAccountContext(e){const t=this.getTokenKeys(),r=e.generateAccountId(),n=[];t.idToken.forEach((e=>{0===e.indexOf(r)&&this.removeIdToken(e)})),t.accessToken.forEach((e=>{0===e.indexOf(r)&&n.push(this.removeAccessToken(e))})),t.refreshToken.forEach((e=>{0===e.indexOf(r)&&this.removeRefreshToken(e)})),await pu.all(n)}async removeAccessToken(e){const t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===Hs.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===Ws.POP){const e=t.keyId;if(e)try{await this.cryptoImpl.removeTokenBindingKey(e)}catch(e){throw Qc(Fc)}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach((e=>{this.isAppMetadata(e)&&this.removeItem(e)})),!0}readAccountFromCache(e){const t=Zl.generateAccountCacheKey(e);return this.getAccount(t,this.commonLogger)}getIdToken(e,t,r,n,o){this.commonLogger.trace("CacheManager - getIdToken called");const i={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Hs.ID_TOKEN,clientId:this.clientId,realm:r},a=this.getIdTokensByFilter(i,t),s=a.size;if(s<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(s>1){let t=a;if(!r){const r=new Map;a.forEach(((t,n)=>{t.realm===e.tenantId&&r.set(n,t)}));const n=r.size;if(n<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(1===n)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),r.values().next().value;t=r}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),t.forEach(((e,t)=>{this.removeIdToken(t)})),n&&o&&n.addFields({multiMatchedID:a.size},o),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,t){const r=t&&t.idToken||this.getTokenKeys().idToken,n=new Map;return r.forEach((t=>{if(!this.idTokenKeyMatchesFilter(t,{clientId:this.clientId,...e}))return;const r=this.getIdTokenCredential(t);r&&this.credentialMatchesFilter(r,e)&&n.set(t,r)})),n}idTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return!(t.clientId&&-1===r.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,r,n,o,i){this.commonLogger.trace("CacheManager - getAccessToken called");const a=Wl.createSearchScopes(t.scopes),s=t.authenticationScheme||Ws.BEARER,c=s&&s.toLowerCase()!==Ws.BEARER.toLowerCase()?Hs.ACCESS_TOKEN_WITH_AUTH_SCHEME:Hs.ACCESS_TOKEN,l={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:c,clientId:this.clientId,realm:n||e.tenantId,target:a,tokenType:s,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},u=r&&r.accessToken||this.getTokenKeys().accessToken,d=[];u.forEach((e=>{if(this.accessTokenKeyMatchesFilter(e,l,!0)){const t=this.getAccessTokenCredential(e);t&&this.credentialMatchesFilter(t,l)&&d.push(t)}}));const h=d.length;return h<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):h>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),d.forEach((e=>{this.removeAccessToken(al(e))})),o&&i&&o.addFields({multiMatchedAT:d.length},i),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),d[0])}accessTokenKeyMatchesFilter(e,t,r){const n=e.toLowerCase();if(t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===n.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===n.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target){const e=t.target.asArray();for(let t=0;t<e.length;t++){if(r&&!n.includes(e[t].toLowerCase()))return!1;if(!r&&n.includes(e[t].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){const t=this.getTokenKeys(),r=[];return t.accessToken.forEach((t=>{if(!this.accessTokenKeyMatchesFilter(t,e,!0))return;const n=this.getAccessTokenCredential(t);n&&this.credentialMatchesFilter(n,e)&&r.push(n)})),r}getRefreshToken(e,t,r,n,o){this.commonLogger.trace("CacheManager - getRefreshToken called");const i=t?qs:void 0,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Hs.REFRESH_TOKEN,clientId:this.clientId,familyId:i},s=r&&r.refreshToken||this.getTokenKeys().refreshToken,c=[];s.forEach((e=>{if(this.refreshTokenKeyMatchesFilter(e,a)){const t=this.getRefreshTokenCredential(e);t&&this.credentialMatchesFilter(t,a)&&c.push(t)}}));const l=c.length;return l<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(l>1&&n&&o&&n.addFields({multiMatchedRT:l},o),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),c[0])}refreshTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return!(t.familyId&&-1===r.indexOf(t.familyId.toLowerCase())||!t.familyId&&t.clientId&&-1===r.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),n=Object.keys(r).map((e=>r[e])),o=n.length;if(o<1)return null;if(o>1)throw Qc(wc);return n[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==qs)}matchHomeAccountId(e,t){return!("string"!=typeof e.homeAccountId||t!==e.homeAccountId)}matchLocalAccountIdFromTokenClaims(e,t){return t===(e.oid||e.sub)}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return!(t.toLowerCase()!==e.name?.toLowerCase())}matchUsername(e,t){return!(!e||"string"!=typeof e||t?.toLowerCase()!==e.toLowerCase())}matchUserAssertionHash(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const r=function(e,t){let r;const n=e.canonicalAuthority;if(n){const o=new nu(n).getUrlComponents().HostNameAndPort;r=su(o,e.cloudDiscoveryMetadata?.metadata,Ds,t)||su(o,iu.metadata,zs,t)||e.knownAuthorities}return r||[]}(this.staticAuthorityOptions,this.commonLogger);if(r.includes(t)&&r.includes(e.environment))return!0}const r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!(!e.clientId||t!==e.clientId)}matchFamilyId(e,t){return!(!e.familyId||t!==e.familyId)}matchRealm(e,t){return!(e.realm?.toLowerCase()!==t.toLowerCase())}matchNativeAccountId(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!(!e.authorityType||t.toLowerCase()!==e.authorityType.toLowerCase())}matchTarget(e,t){return!(e.credentialType!==Hs.ACCESS_TOKEN&&e.credentialType!==Hs.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)&&Wl.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!(!e.tokenType||e.tokenType!==t)}matchKeyId(e,t){return!(!e.keyId||e.keyId!==t)}isAppMetadata(e){return-1!==e.indexOf($s)}isAuthorityMetadata(e){return-1!==e.indexOf(Fs)}generateAuthorityMetadataCacheKey(e){return`${Fs}-${this.clientId}-${e}`}static toObject(e,t){for(const r in t)e[r]=t[r];return e}}class gu extends fu{async setAccount(){throw Qc(Wc)}getAccount(){throw Qc(Wc)}async setIdTokenCredential(){throw Qc(Wc)}getIdTokenCredential(){throw Qc(Wc)}async setAccessTokenCredential(){throw Qc(Wc)}getAccessTokenCredential(){throw Qc(Wc)}async setRefreshTokenCredential(){throw Qc(Wc)}getRefreshTokenCredential(){throw Qc(Wc)}setAppMetadata(){throw Qc(Wc)}getAppMetadata(){throw Qc(Wc)}setServerTelemetry(){throw Qc(Wc)}getServerTelemetry(){throw Qc(Wc)}setAuthorityMetadata(){throw Qc(Wc)}getAuthorityMetadata(){throw Qc(Wc)}getAuthorityMetadataKeys(){throw Qc(Wc)}setThrottlingCache(){throw Qc(Wc)}getThrottlingCache(){throw Qc(Wc)}removeItem(){throw Qc(Wc)}getKeys(){throw Qc(Wc)}getAccountKeys(){throw Qc(Wc)}getTokenKeys(){throw Qc(Wc)}}const mu={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},yu={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Vs.Info,correlationId:bs.EMPTY_STRING},vu={claimsBasedCachingEnabled:!1},bu={async sendGetRequestAsync(){throw Qc(Wc)},async sendPostRequestAsync(){throw Qc(Wc)}},wu={sku:bs.SKU,version:Zc,cpu:bs.EMPTY_STRING,os:bs.EMPTY_STRING},Cu={clientSecret:bs.EMPTY_STRING,clientAssertion:void 0},Au={azureCloudInstance:Xs,tenant:`${bs.DEFAULT_COMMON_TENANT}`},ku={application:{appName:"",appVersion:""}};function Su(e){return e.authOptions.authority.options.protocolMode===Qs}var Tu=r(64583).Promise;const Iu={sendGetRequestAsync:()=>Tu.reject(Qc(Wc)),sendPostRequestAsync:()=>Tu.reject(Qc(Wc))},xu="acquireTokenByCode",_u="acquireTokenByRefreshToken",Eu="acquireTokenSilent",Pu="acquireTokenSilentAsync",Ru="acquireTokenPopup",Ou="acquireTokenRedirect",Mu="cryptoOptsGetPublicKeyThumbprint",Nu="cryptoOptsSignJwt",Bu="silentCacheClientAcquireToken",Lu="silentIframeClientAcquireToken",Hu="silentRefreshClientAcquireToken",$u="ssoSilent",qu="standardInteractionClientGetDiscoveredAuthority",Fu="nativeInteractionClientAcquireToken",Du="networkClientSendPostRequestAsync",Uu="refreshTokenClientExecutePostToTokenEndpoint",ju="authorizationCodeClientExecutePostToTokenEndpoint",zu="refreshTokenClientExecuteTokenRequest",Ku="refreshTokenClientAcquireToken",Wu="refreshTokenClientAcquireTokenWithCachedRefreshToken",Gu="refreshTokenClientAcquireTokenByRefreshToken",Vu="refreshTokenClientCreateTokenRequestBody",Yu="acquireTokenFromCache",Qu="silentFlowClientAcquireCachedToken",Ju="silentFlowClientGenerateResultFromCacheRecord",Xu="acquireTokenBySilentIframe",Zu="initializeBaseRequest",ed="initializeSilentRequest",td="initializeClientApplication",rd="initializeCache",nd="silentIframeClientTokenHelper",od="silentHandlerInitiateAuthRequest",id="silentHandlerMonitorIframeForHash",ad="silentHandlerLoadFrame",sd="silentHandlerLoadFrameSync",cd="standardInteractionClientCreateAuthCodeClient",ld="standardInteractionClientGetClientConfiguration",ud="standardInteractionClientInitializeAuthorizationRequest",dd="getAuthCodeUrl",hd="handleCodeResponseFromServer",pd="handleCodeResponse",fd="handleResponseEar",gd="handleResponsePlatformBroker",md="handleResponseCode",yd="updateTokenEndpointAuthority",vd="authClientAcquireToken",bd="authClientExecuteTokenRequest",wd="authClientCreateTokenRequestBody",Cd="popTokenGenerateCnf",Ad="popTokenGenerateKid",kd="handleServerTokenResponse",Sd="deserializeResponse",Td="authorityFactoryCreateDiscoveredInstance",Id="authorityResolveEndpointsAsync",xd="authorityGetCloudDiscoveryMetadataFromNetwork",_d="authorityUpdateCloudDiscoveryMetadata",Ed="authorityGetEndpointMetadataFromNetwork",Pd="authorityUpdateEndpointMetadata",Rd="authorityUpdateMetadataWithRegionalInformation",Od="regionDiscoveryDetectRegion",Md="regionDiscoveryGetRegionFromIMDS",Nd="regionDiscoveryGetCurrentVersion",Bd="acquireTokenByCodeAsync",Ld="handleRedirectPromise",Hd="handleNativeRedirectPromise",$d="nativeMessageHandlerHandshake",qd="removeHiddenIframe",Fd="clearTokensAndKeysWithClaims",Dd="cacheManagerGetRefreshToken",Ud="importExistingCache",jd="setUserData",zd="localStorageUpdated",Kd="generatePkceCodes",Wd="generateCodeVerifier",Gd="generateCodeChallengeFromVerifier",Vd="sha256Digest",Yd="getRandomValues",Qd="generateHKDF",Jd="generateBaseKey",Xd="base64Decode",Zd="urlEncodeArr",eh="encrypt",th="decrypt",rh="generateEarKey",nh="decryptEarResponse",oh=(new Map([[xu,"ATByCode"],[_u,"ATByRT"],[Eu,"ATS"],[Pu,"ATSAsync"],[Ru,"ATPopup"],[Ou,"ATRedirect"],[Mu,"CryptoGetPKThumb"],[Nu,"CryptoSignJwt"],[Bu,"SltCacheClientAT"],[Lu,"SltIframeClientAT"],[Hu,"SltRClientAT"],[$u,"SsoSlt"],[qu,"StdIntClientGetDiscAuth"],["fetchAccountIdWithNativeBroker","FetchAccIdWithNtvBroker"],[Fu,"NtvIntClientAT"],["baseClientCreateTokenRequestHeaders","BaseClientCreateTReqHead"],[Du,"NetClientSendPost"],[Uu,"RTClientExecPost"],[ju,"AuthCodeClientExecPost"],["brokerHandshake","BrokerHandshake"],["acquireTokenByRefreshTokenInBroker","ATByRTInBroker"],["acquireTokenByBroker","ATByBroker"],[zu,"RTClientExecTReq"],[Ku,"RTClientAT"],[Wu,"RTClientATWithCachedRT"],[Gu,"RTClientATByRT"],[Vu,"RTClientCreateTReqBody"],[Yu,"ATFromCache"],[Qu,"SltFlowClientATCached"],[Ju,"SltFlowClientGenResFromCache"],[Xu,"ATBySltIframe"],[Zu,"InitBaseReq"],[ed,"InitSltReq"],[td,"InitClientApplication"],[rd,"InitCache"],[Ud,"importCache"],[jd,"setUserData"],[zd,"localStorageUpdated"],[nd,"SIClientTHelper"],[od,"SHandlerInitAuthReq"],[id,"SltHandlerMonitorIframeForHash"],[ad,"SHandlerLoadFrame"],[sd,"SHandlerLoadFrameSync"],[cd,"StdIntClientCreateAuthCodeClient"],[ld,"StdIntClientGetClientConf"],[ud,"StdIntClientInitAuthReq"],[dd,"GetAuthCodeUrl"],[hd,"HandleCodeResFromServer"],[pd,"HandleCodeResp"],[fd,"HandleRespEar"],[md,"HandleRespCode"],[gd,"HandleRespPlatBroker"],[yd,"UpdTEndpointAuth"],[vd,"AuthClientAT"],[bd,"AuthClientExecTReq"],[wd,"AuthClientCreateTReqBody"],[Cd,"PopTGenCnf"],[Ad,"PopTGenKid"],[kd,"HandleServerTRes"],[Sd,"DeserializeRes"],[Td,"AuthFactCreateDiscInst"],[Id,"AuthResolveEndpointsAsync"],["authorityResolveEndpointsFromLocalSources","AuthResolveEndpointsFromLocal"],[xd,"AuthGetCDMetaFromNet"],[_d,"AuthUpdCDMeta"],[Ed,"AuthUpdCDMetaFromNet"],[Pd,"AuthUpdEndpointMeta"],[Rd,"AuthUpdMetaWithRegInfo"],[Od,"RegDiscDetectReg"],[Md,"RegDiscGetRegFromIMDS"],[Nd,"RegDiscGetCurrentVer"],[Bd,"ATByCodeAsync"],["getEndpointMetadataFromNetwork","GetEndpointMetaFromNet"],["getCloudDiscoveryMetadataFromNetworkMeasurement","GetCDMetaFromNet"],[Ld,"HandleRedirectPromise"],[Hd,"HandleNtvRedirectPromise"],["updateCloudDiscoveryMetadataMeasurement","UpdateCDMeta"],["usernamePasswordClientAcquireToken","UserPassClientAT"],[$d,"NtvMsgHandlerHandshake"],["nativeGenerateAuthResult","NtvGenAuthRes"],[qd,"RemoveHiddenIframe"],[Fd,"ClearTAndKeysWithClaims"],[Dd,"CacheManagerGetRT"],[Kd,"GenPkceCodes"],[Wd,"GenCodeVerifier"],[Gd,"GenCodeChallengeFromVerifier"],[Vd,"Sha256Digest"],[Yd,"GetRandomValues"],[Qd,"genHKDF"],[Jd,"genBaseKey"],[Xd,"b64Decode"],[Zd,"urlEncArr"],[eh,"encrypt"],[th,"decrypt"],[rh,"genEarKey"],[nh,"decryptEarResp"]]),1);new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT","unencryptedCacheCount","encryptedCacheExpiredCount"]);class ih{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class ah{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:oh,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new ih}}startPerformanceMeasurement(){return new ih}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}const sh="invalid_grant",ch="msal",lh="msal.js.browser",uh="53ee284d-920a-4b59-9d30-a60315b26836",dh="ppnbnpeolgkicgegkbkbjmhlideopiji",hh="Handshake",ph="GetToken",fh="localStorage",gh="sessionStorage",mh="memoryStorage",yh="signin",vh="signout",bh="request.origin",wh="urlHash",Ch="request.params",Ah="code.verifier",kh="interaction.status",Sh="request.native",Th="msal.account.keys",Ih="msal.token.keys",xh="wrapper.sku",_h="wrapper.version",Eh=861,Ph=862;var Rh;!function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(Rh||(Rh={}));const Oh={scopes:ws},Mh="msal.db",Nh=`${Mh}.keys`,Bh=[0,5,4];var Lh=r(64583).Promise;class Hh{navigateInternal(e,t){return Hh.defaultNavigateWindow(e,t)}navigateExternal(e,t){return Hh.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Lh((e=>{setTimeout((()=>{e(!0)}),t.timeout)}))}}class $h extends rc{constructor(e,t,r){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,$h.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=r}}function qh(e,t,r,n){return e.errorMessage=`${e.errorMessage}, additionalErrorInfo: error.name:${n?.name}, error.message:${n?.message}`,new $h(e,t,r)}const Fh="pkce_not_created",Dh="ear_jwk_empty",Uh="ear_jwe_empty",jh="crypto_nonexistent",zh="empty_navigate_uri",Kh="hash_empty_error",Wh="no_state_in_hash",Gh="hash_does_not_contain_known_properties",Vh="unable_to_parse_state",Yh="state_interaction_type_mismatch",Qh="interaction_in_progress",Jh="popup_window_error",Xh="empty_window_error",Zh="user_cancelled",ep="monitor_popup_timeout",tp="monitor_window_timeout",rp="redirect_in_iframe",np="block_iframe_reload",op="block_nested_popups",ip="iframe_closed_prematurely",ap="silent_logout_unsupported",sp="no_account_error",cp="silent_prompt_value_error",lp="no_token_request_cache_error",up="unable_to_parse_token_request_cache_error",dp="auth_request_not_set_error",hp="invalid_cache_type",pp="non_browser_environment",fp="database_not_open",gp="no_network_connectivity",mp="post_request_failed",yp="get_request_failed",vp="failed_to_parse_response",bp="unable_to_load_token",wp="crypto_key_not_found",Cp="auth_code_required",Ap="auth_code_or_nativeAccountId_required",kp="spa_code_and_nativeAccountId_present",Sp="database_unavailable",Tp="unable_to_acquire_token_from_native_platform",Ip="native_handshake_timeout",xp="native_extension_not_installed",_p="native_connection_not_established",Ep="uninitialized_public_client_application",Pp="native_prompt_not_supported",Rp="invalid_base64_string",Op="invalid_pop_token_request",Mp="failed_to_build_headers",Np="failed_to_parse_headers",Bp="failed_to_decrypt_ear_response",Lp="For more visit: aka.ms/msaljs/browser-errors",Hp={[Fh]:"The PKCE code challenge and verifier could not be generated.",[Dh]:"No EAR encryption key provided. This is unexpected.",[Uh]:"Server response does not contain ear_jwe property. This is unexpected.",[jh]:"The crypto object or function is not available.",[zh]:"Navigation URI is empty. Please check stack trace for more info.",[Kh]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${Lp}`,[Wh]:"Hash does not contain state. Please verify that the request originated from msal.",[Gh]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${Lp}`,[Vh]:"Unable to parse state. Please verify that the request originated from msal.",[Yh]:"Hash contains state but the interaction type does not match the caller.",[Qh]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${Lp}`,[Jh]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[Xh]:"window.open returned null or undefined window object.",[Zh]:"User cancelled the flow.",[ep]:`Token acquisition in popup failed due to timeout.  ${Lp}`,[tp]:`Token acquisition in iframe failed due to timeout.  ${Lp}`,[rp]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[np]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${Lp}`,[op]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[ip]:"The iframe being monitored was closed prematurely.",[ap]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[sp]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[cp]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[lp]:"No token request found in cache.",[up]:"The cached token request could not be parsed.",[dp]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[hp]:"Invalid cache type",[pp]:"Login and token requests are not supported in non-browser environments.",[fp]:"Database is not open!",[gp]:"No network connectivity. Check your internet connection.",[mp]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[yp]:"Network request failed. Please check the network trace to determine root cause.",[vp]:"Failed to parse network response. Check network trace.",[bp]:"Error loading token to cache.",[wp]:"Cryptographic Key or Keypair not found in browser storage.",[Cp]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[Ap]:"An authorization code or nativeAccountId must be provided to this flow.",[kp]:"Request cannot contain both spa code and native account id.",[Sp]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[Tp]:`Unable to acquire token from native platform.  ${Lp}`,[Ip]:"Timed out while attempting to establish connection to browser extension",[xp]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[_p]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${Lp}`,[Ep]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${Lp}`,[Pp]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[Rp]:"Invalid base64 encoded string.",[Op]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[Mp]:"Failed to build request headers object.",[Np]:"Failed to parse response headers",[Bp]:"Failed to decrypt ear response"};class $p extends rc{constructor(e,t){super(e,Hp[e],t),Object.setPrototypeOf(this,$p.prototype),this.name="BrowserAuthError"}}function qp(e,t){return new $p(e,t)}class Fp{async sendGetRequestAsync(e,t){let r,n={},o=0;const i=Dp(t);try{r=await fetch(e,{method:"GET",headers:i})}catch(e){throw qh(qp(window.navigator.onLine?yp:gp),void 0,void 0,e)}n=Up(r.headers);try{return o=r.status,{headers:n,body:await r.json(),status:o}}catch(e){throw qh(qp(vp),o,n,e)}}async sendPostRequestAsync(e,t){const r=t&&t.body||"",n=Dp(t);let o,i=0,a={};try{o=await fetch(e,{method:"POST",headers:n,body:r})}catch(e){throw qh(qp(window.navigator.onLine?mp:gp),void 0,void 0,e)}a=Up(o.headers);try{return i=o.status,{headers:a,body:await o.json(),status:i}}catch(e){throw qh(qp(vp),i,a,e)}}}function Dp(e){try{const t=new Headers;if(!e||!e.headers)return t;const r=e.headers;return Object.entries(r).forEach((([e,r])=>{t.append(e,r)})),t}catch(e){throw qh(qp(Mp),void 0,void 0,e)}}function Up(e){try{const t={};return e.forEach(((e,r)=>{t[r]=e})),t}catch(e){throw qp(Np)}}function jp(e){return encodeURIComponent(Kp(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function zp(e){return Wp(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Kp(e){return Wp((new TextEncoder).encode(e))}function Wp(e){const t=Array.from(e,(e=>String.fromCodePoint(e))).join("");return btoa(t)}function Gp(e){return(new TextDecoder).decode(Vp(e))}function Vp(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw qp(Rp)}const r=atob(t);return Uint8Array.from(r,(e=>e.codePointAt(0)||0))}const Yp="AES-GCM",Qp="HKDF",Jp="SHA-256",Xp=new Uint8Array([1,0,1]),Zp="0123456789abcdef",ef=new Uint32Array(1),tf="raw",rf="encrypt",nf="decrypt",of={name:"RSASSA-PKCS1-v1_5",hash:Jp,modulusLength:2048,publicExponent:Xp};async function af(e,t,r){t?.addQueueMeasurement(Vd,r);const n=(new TextEncoder).encode(e);return window.crypto.subtle.digest(Jp,n)}function sf(e){return window.crypto.getRandomValues(e)}function cf(){return window.crypto.getRandomValues(ef),ef[0]}function lf(){const e=Date.now(),t=1024*cf()+(1023&cf()),r=new Uint8Array(16),n=Math.trunc(t/2**30),o=t&2**30-1,i=cf();r[0]=e/2**40,r[1]=e/2**32,r[2]=e/2**24,r[3]=e/65536,r[4]=e/256,r[5]=e,r[6]=112|n>>>8,r[7]=n,r[8]=128|o>>>24,r[9]=o>>>16,r[10]=o>>>8,r[11]=o,r[12]=i>>>24,r[13]=i>>>16,r[14]=i>>>8,r[15]=i;let a="";for(let e=0;e<r.length;e++)a+=Zp.charAt(r[e]>>>4),a+=Zp.charAt(15&r[e]),3!==e&&5!==e&&7!==e&&9!==e||(a+="-");return a}async function uf(e){return window.crypto.subtle.exportKey("jwk",e)}async function df(){const e=await pf(),t={alg:"dir",kty:"oct",k:zp(new Uint8Array(e))};return Kp(JSON.stringify(t))}async function hf(e,t){const r=t.split(".");if(5!==r.length)throw qp(Bp,"jwe_length");const n=await async function(e){const t=Gp(e),r=Vp(JSON.parse(t).k);return window.crypto.subtle.importKey(tf,r,Yp,!1,[nf])}(e).catch((()=>{throw qp(Bp,"import_key")}));try{const e=(new TextEncoder).encode(r[0]),t=Vp(r[2]),o=Vp(r[3]),i=Vp(r[4]),a=8*i.byteLength,s=new Uint8Array(o.length+i.length);s.set(o),s.set(i,o.length);const c=await window.crypto.subtle.decrypt({name:Yp,iv:t,tagLength:a,additionalData:e},n,s);return(new TextDecoder).decode(c)}catch(e){throw qp(Bp,"decrypt")}}async function pf(){const e=await window.crypto.subtle.generateKey({name:Yp,length:256},!0,[rf,nf]);return window.crypto.subtle.exportKey(tf,e)}async function ff(e){return window.crypto.subtle.importKey(tf,e,Qp,!1,["deriveKey"])}async function gf(e,t,r){return window.crypto.subtle.deriveKey({name:Qp,salt:t,hash:Jp,info:(new TextEncoder).encode(r)},e,{name:Yp,length:256},!1,[rf,nf])}async function mf(e,t,r){const n=(new TextEncoder).encode(t),o=window.crypto.getRandomValues(new Uint8Array(16)),i=await gf(e,o,r),a=await window.crypto.subtle.encrypt({name:Yp,iv:new Uint8Array(12)},i,n);return{data:zp(new Uint8Array(a)),nonce:zp(o)}}async function yf(e,t,r,n){const o=Vp(n),i=await gf(e,Vp(t),r),a=await window.crypto.subtle.decrypt({name:Yp,iv:new Uint8Array(12)},i,o);return(new TextDecoder).decode(a)}async function vf(e){const t=await af(e);return zp(new Uint8Array(t))}const bf="storage_not_supported",wf="stubbed_public_client_application_called",Cf="in_mem_redirect_unavailable",Af={[bf]:"Given storage configuration option was not supported.",[wf]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[Cf]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};class kf extends rc{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,kf.prototype)}}function Sf(e){return new kf(e,Af[e])}function Tf(e){e.location.hash="","function"==typeof e.history.replaceState&&e.history.replaceState(null,"",`${e.location.origin}${e.location.pathname}${e.location.search}`)}function If(){return window.parent!==window}function xf(){return"undefined"!=typeof window&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function _f(){if("undefined"==typeof window)throw qp(pp)}function Ef(e){if(!e)throw qp(Ep)}function Pf(e){_f(),function(){if(nu.hashContainsKnownProperties(window.location.hash)&&If())throw qp(np)}(),function(){if("undefined"!=typeof window&&window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(`${ch}.`))throw qp(op)}(),Ef(e)}function Rf(e,t){if(Pf(e),function(e){if(If()&&!e)throw qp(rp)}(t.system.allowRedirectInIframe),t.cache.cacheLocation===mh&&!t.cache.storeAuthStateInCookie)throw Sf(Cf)}function Of(e){const t=document.createElement("link");t.rel="preconnect",t.href=new URL(e).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout((()=>{try{document.head.removeChild(t)}catch{}}),1e4)}const Mf="4.12.0";class Nf{static loggerCallback(e,t){switch(e){case Vs.Error:return void console.error(t);case Vs.Info:return void console.info(t);case Vs.Verbose:return void console.debug(t);case Vs.Warning:return void console.warn(t);default:return void console.log(t)}}constructor(e){let t;this.browserEnvironment="undefined"!=typeof window,this.config=function({auth:e,cache:t,system:r,telemetry:n},o){const i={clientId:bs.EMPTY_STRING,authority:`${bs.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:bs.EMPTY_STRING,authorityMetadata:bs.EMPTY_STRING,redirectUri:"undefined"!=typeof window?xf():"",postLogoutRedirectUri:bs.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:"AAD",OIDCOptions:{serverResponseType:"fragment",defaultScopes:[bs.OPENID_SCOPE,bs.PROFILE_SCOPE,bs.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:Xs,tenant:bs.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1,encodeExtraQueryParams:!1},a={cacheLocation:gh,temporaryCacheLocation:gh,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!t||t.cacheLocation!==fh),claimsBasedCachingEnabled:!1},s={loggerCallback:()=>{},logLevel:Vs.Info,piiLoggingEnabled:!1},c={...{...mu,loggerOptions:s,networkClient:o?new Fp:Iu,navigationClient:new Hh,loadFrameTimeout:0,windowHashTimeout:r?.loadFrameTimeout||6e4,iframeHashTimeout:r?.loadFrameTimeout||1e4,navigateFrameWait:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,nativeBrokerHandshakeTimeout:r?.nativeBrokerHandshakeTimeout||2e3,pollIntervalMilliseconds:30},...r,loggerOptions:r?.loggerOptions||s},l={application:{appName:bs.EMPTY_STRING,appVersion:bs.EMPTY_STRING},client:new ah};if(e?.protocolMode!==Qs&&e?.OIDCOptions&&new Ys(c.loggerOptions).warning(JSON.stringify(zl(ql))),e?.protocolMode&&e.protocolMode===Qs&&c?.allowPlatformBroker)throw zl(Fl);return{auth:{...i,...e,OIDCOptions:{...i.OIDCOptions,...e?.OIDCOptions}},cache:{...a,...t},system:c,telemetry:{...l,...n}}}(e,this.browserEnvironment);try{t=window[gh]}catch(e){}const r=t?.getItem("msal.browser.log.level"),n=t?.getItem("msal.browser.log.pii")?.toLowerCase(),o="true"===n||"false"!==n&&void 0,i={...this.config.system.loggerOptions},a=r&&Object.keys(Vs).includes(r)?Vs[r]:void 0;a&&(i.loggerCallback=Nf.loggerCallback,i.logLevel=a),void 0!==o&&(i.piiLoggingEnabled=o),this.logger=new Ys(i,"@azure/msal-browser",Mf),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}class Bf extends Nf{getModuleName(){return Bf.MODULE_NAME}getId(){return Bf.ID}async initialize(){return this.available="undefined"!=typeof window,this.available}}Bf.MODULE_NAME="",Bf.ID="StandardOperatingContext";const Lf="missing_kid_error",Hf="missing_alg_error",$f={[Lf]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[Hf]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class qf extends rc{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,qf.prototype)}}function Ff(e){return new qf(e,$f[e])}class Df{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw Ff(Lf);if(!e.alg)throw Ff(Hf);const t=new Df({typ:e.typ||"pop",kid:e.kid,alg:e.alg});return JSON.stringify(t)}}var Uf=r(64583).Promise;class jf{constructor(){this.dbName=Mh,this.version=1,this.tableName=Nh,this.dbOpen=!1}async open(){return new Uf(((e,t)=>{const r=window.indexedDB.open(this.dbName,this.version);r.addEventListener("upgradeneeded",(e=>{e.target.result.createObjectStore(this.tableName)})),r.addEventListener("success",(t=>{const r=t;this.db=r.target.result,this.dbOpen=!0,e()})),r.addEventListener("error",(()=>t(qp(Sp))))}))}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Uf(((t,r)=>{if(!this.db)return r(qp(fp));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);n.addEventListener("success",(e=>{const r=e;this.closeConnection(),t(r.target.result)})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async setItem(e,t){return await this.validateDbIsOpen(),new Uf(((r,n)=>{if(!this.db)return n(qp(fp));const o=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);o.addEventListener("success",(()=>{this.closeConnection(),r()})),o.addEventListener("error",(e=>{this.closeConnection(),n(e)}))}))}async removeItem(e){return await this.validateDbIsOpen(),new Uf(((t,r)=>{if(!this.db)return r(qp(fp));const n=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);n.addEventListener("success",(()=>{this.closeConnection(),t()})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async getKeys(){return await this.validateDbIsOpen(),new Uf(((e,t)=>{if(!this.db)return t(qp(fp));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();r.addEventListener("success",(t=>{const r=t;this.closeConnection(),e(r.target.result)})),r.addEventListener("error",(e=>{this.closeConnection(),t(e)}))}))}async containsKey(e){return await this.validateDbIsOpen(),new Uf(((t,r)=>{if(!this.db)return r(qp(fp));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);n.addEventListener("success",(e=>{const r=e;this.closeConnection(),t(1===r.target.result)})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Uf(((e,t)=>{const r=window.indexedDB.deleteDatabase(Mh),n=setTimeout((()=>t(!1)),200);r.addEventListener("success",(()=>(clearTimeout(n),e(!0)))),r.addEventListener("blocked",(()=>(clearTimeout(n),e(!0)))),r.addEventListener("error",(()=>(clearTimeout(n),t(!1))))}))}}class zf{constructor(){this.cache=new Map}async initialize(){}getItem(e){return this.cache.get(e)||null}getUserData(e){return this.getItem(e)}setItem(e,t){this.cache.set(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach(((t,r)=>{e.push(r)})),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}class Kf{constructor(e){this.inMemoryCache=new zf,this.indexedDBCache=new jf,this.logger=e}handleDatabaseAccessError(e){if(!(e instanceof $p&&e.errorCode===Sp))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(e){this.handleDatabaseAccessError(e)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(e){this.handleDatabaseAccessError(e)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(e){this.handleDatabaseAccessError(e)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(0===e.length)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(e){this.handleDatabaseAccessError(e)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(e){this.handleDatabaseAccessError(e)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}class Wf{constructor(e,t,r){this.logger=e,function(e){if(!window)throw qp(pp);if(!window.crypto)throw qp(jh);if(!e&&!window.crypto.subtle)throw qp(jh,"crypto_subtle_undefined")}(r??!1),this.cache=new Kf(this.logger),this.performanceClient=t}createNewGuid(){return lf()}base64Encode(e){return Kp(e)}base64Decode(e){return Gp(e)}base64UrlEncode(e){return jp(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){const t=this.performanceClient?.startMeasurement(Mu,e.correlationId),r=await async function(e,t){return window.crypto.subtle.generateKey(of,e,t)}(Wf.EXTRACTABLE,Wf.POP_KEY_USAGES),n=await uf(r.publicKey),o=Gf({e:n.e,kty:n.kty,n:n.n}),i=await this.hashString(o),a=await uf(r.privateKey),s=await async function(e){return window.crypto.subtle.importKey("jwk",e,of,!1,["sign"])}(a);return await this.cache.setItem(i,{privateKey:s,publicKey:r.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),i}async removeTokenBindingKey(e){return await this.cache.removeItem(e),!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,r,n){const o=this.performanceClient?.startMeasurement(Nu,n),i=await this.cache.getItem(t);if(!i)throw qp(wp);const a=await uf(i.publicKey),s=Gf(a),c=jp(JSON.stringify({kid:t})),l=jp(Df.getShrHeaderString({...r?.header,alg:a.alg,kid:c}));e.cnf={jwk:JSON.parse(s)};const u=`${l}.${jp(JSON.stringify(e))}`,d=(new TextEncoder).encode(u),h=await async function(e,t){return window.crypto.subtle.sign(of,e,t)}(i.privateKey,d),p=`${u}.${zp(new Uint8Array(h))}`;return o&&o.end({success:!0}),p}async hashString(e){return vf(e)}}function Gf(e){return JSON.stringify(e,Object.keys(e).sort())}Wf.POP_KEY_USAGES=["sign","verify"],Wf.EXTRACTABLE=!0;const Vf=(e,t,r,n,o)=>(...i)=>{r.trace(`Executing function ${t}`);const a=n?.startMeasurement(t,o);if(o){const e=t+"CallCount";n?.incrementFields({[e]:1},o)}try{const n=e(...i);return a?.end({success:!0}),r.trace(`Returning result from ${t}`),n}catch(e){r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw a?.end({success:!1},e),e}},Yf=(e,t,r,n,o)=>(...i)=>{r.trace(`Executing function ${t}`);const a=n?.startMeasurement(t,o);if(o){const e=t+"CallCount";n?.incrementFields({[e]:1},o)}return n?.setPreQueueTime(t,o),e(...i).then((e=>(r.trace(`Returning result from ${t}`),a?.end({success:!0}),e))).catch((e=>{r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw a?.end({success:!1},e),e}))};class Qf{constructor(e,t,r,n){this.networkInterface=e,this.logger=t,this.performanceClient=r,this.correlationId=n}async detectRegion(e,t){this.performanceClient?.addQueueMeasurement(Od,this.correlationId);let r=e;if(r)t.region_source="3";else{const e=Qf.IMDS_OPTIONS;try{const n=await Yf(this.getRegionFromIMDS.bind(this),Md,this.logger,this.performanceClient,this.correlationId)(bs.IMDS_VERSION,e);if(200===n.status&&(r=n.body,t.region_source="4"),400===n.status){const n=await Yf(this.getCurrentVersion.bind(this),Nd,this.logger,this.performanceClient,this.correlationId)(e);if(!n)return t.region_source="1",null;const o=await Yf(this.getRegionFromIMDS.bind(this),Md,this.logger,this.performanceClient,this.correlationId)(n,e);200===o.status&&(r=o.body,t.region_source="4")}}catch(e){return t.region_source="1",null}}return r||(t.region_source="1"),r||null}async getRegionFromIMDS(e,t){return this.performanceClient?.addQueueMeasurement(Md,this.correlationId),this.networkInterface.sendGetRequestAsync(`${bs.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,bs.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(Nd,this.correlationId);try{const t=await this.networkInterface.sendGetRequestAsync(`${bs.IMDS_ENDPOINT}?format=json`,e);return 400===t.status&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch(e){return null}}}Qf.IMDS_OPTIONS={headers:{Metadata:"true"}};class Jf{constructor(e,t,r,n,o,i,a,s){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=a,this.correlationId=i,this.managedIdentity=s||!1,this.regionDiscovery=new Qf(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(bs.CIAM_AUTH_URL))return 3;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case bs.ADFS:return 1;case bs.DSTS:return 2}return 0}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new nu(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw Qc(cc)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw Qc(cc)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw Qc(cc)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw Qc(Dc);return this.replacePath(this.metadata.end_session_endpoint)}throw Qc(cc)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw Qc(cc)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw Qc(cc)}canReplaceTenant(e){return 1===e.PathSegments.length&&!Jf.reservedTenantDomains.has(e.PathSegments[0])&&0===this.getAuthorityType(e)&&this.protocolMode!==Qs}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const r=new nu(this.metadata.canonical_authority).getUrlComponents(),n=r.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach(((e,o)=>{let i=n[o];if(0===o&&this.canReplaceTenant(r)){const e=new nu(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];i!==e&&(this.logger.verbose(`Replacing tenant domain name ${i} with id ${e}`),i=e)}e!==i&&(t=t.replace(`/${i}/`,`/${e}/`))})),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||1===this.authorityType||this.protocolMode===Qs&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(Id,this.correlationId);const e=this.getCurrentMetadataEntity(),t=await Yf(this.updateCloudDiscoveryMetadata.bind(this),_d,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const r=await Yf(this.updateEndpointMetadata.bind(this),Pd,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:r}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:r},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:ml(),jwks_uri:""}),e}updateCachedMetadata(e,t,r){t!==Us&&r?.source!==Us&&(e.expiresAt=ml(),e.canonical_authority=this.canonicalAuthority);const n=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(n,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(Pd,this.correlationId);const t=this.updateEndpointMetadataFromLocalSources(e);if(t)return t.source===zs&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata&&(yl(e,await Yf(this.updateMetadataWithRegionalInformation.bind(this),Rd,this.logger,this.performanceClient,this.correlationId)(t.metadata),!1),e.canonical_authority=this.canonicalAuthority),t.source;let r=await Yf(this.getEndpointMetadataFromNetwork.bind(this),Ed,this.logger,this.performanceClient,this.correlationId)();if(r)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(r=await Yf(this.updateMetadataWithRegionalInformation.bind(this),Rd,this.logger,this.performanceClient,this.correlationId)(r)),yl(e,r,!0),js;throw Qc(uc,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),yl(e,t,!1),{source:Ds};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const t=this.getEndpointMetadataFromHardcodedValues();if(t)return yl(e,t,!1),{source:zs,metadata:t};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const r=bl(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!r?(this.logger.verbose("Found endpoint metadata in the cache."),{source:Us}):(r&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new nu(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw zl(Ml)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(Ed,this.correlationId);const e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{const r=await this.networkInterface.sendGetRequestAsync(t,e),n=function(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}(r.body);return n?r.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(e){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${e}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in ou?ou[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(Rd,this.correlationId);const t=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(t){if(t!==bs.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome="2",this.regionDiscoveryMetadata.region_used=t,Jf.replaceWithRegionalInformation(e,t);const r=await Yf(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),Od,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(r)return this.regionDiscoveryMetadata.region_outcome="4",this.regionDiscoveryMetadata.region_used=r,Jf.replaceWithRegionalInformation(e,r);this.regionDiscoveryMetadata.region_outcome="5"}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(_d,this.correlationId);const t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;const r=await Yf(this.getCloudDiscoveryMetadataFromNetwork.bind(this),xd,this.logger,this.performanceClient,this.correlationId)();if(r)return vl(e,r,!0),js;throw zl(Nl)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||bs.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||bs.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||bs.NOT_APPLICABLE}`);const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),vl(e,t,!1),Ds;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const t=(r=this.hostnameAndPort,cu(iu.metadata,r));if(t)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),vl(e,t,!1),zs;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}var r;const n=bl(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found cloud discovery metadata in the cache."),Us):(n&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(3===this.authorityType)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),Jf.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=cu(JSON.parse(this.authorityOptions.cloudDiscoveryMetadata).metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),e)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),e;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),zl(Ol)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),Jf.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(xd,this.correlationId);const e=`${bs.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={};let r=null;try{const n=await this.networkInterface.sendGetRequestAsync(e,t);let o,i;if(function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(n.body))o=n.body,i=o.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${o.tenant_discovery_endpoint}`);else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(n.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${n.status}`),o=n.body,o.error===bs.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${o.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${o.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),i=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=cu(i,this.hostnameAndPort)}catch(e){if(e instanceof rc)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.\nError: ${e.errorCode}\nError Description: ${e.errorMessage}`);else{const t=e;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ${t.name}\nError Description: ${t.message}`)}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=Jf.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter((e=>e&&nu.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort)).length>0}static generateAuthority(e,t){let r;if(t&&t.azureCloudInstance!==Xs){const e=t.tenant?t.tenant:bs.DEFAULT_COMMON_TENANT;r=`${t.azureCloudInstance}/${e}/`}return r||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return bs.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw Qc(cc)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return au.has(e)}static isPublicCloudAuthority(e){return bs.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,r){const n=new nu(e);n.validateAsUri();const o=n.getUrlComponents();let i=`${t}.${o.HostNameAndPort}`;this.isPublicCloudAuthority(o.HostNameAndPort)&&(i=`${t}.${bs.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const a=nu.constructAuthorityUriFromObject({...n.getUrlComponents(),HostNameAndPort:i}).urlString;return r?`${a}?${r}`:a}static replaceWithRegionalInformation(e,t){const r={...e};return r.authorization_endpoint=Jf.buildRegionalAuthorityString(r.authorization_endpoint,t),r.token_endpoint=Jf.buildRegionalAuthorityString(r.token_endpoint,t),r.end_session_endpoint&&(r.end_session_endpoint=Jf.buildRegionalAuthorityString(r.end_session_endpoint,t)),r}static transformCIAMAuthority(e){let t=e;const r=new nu(e).getUrlComponents();return 0===r.PathSegments.length&&r.HostNameAndPort.endsWith(bs.CIAM_AUTH_URL)&&(t=`${t}${r.HostNameAndPort.split(".")[0]}${bs.AAD_TENANT_DOMAIN_SUFFIX}`),t}}function Xf(e){return e.endsWith(bs.FORWARD_SLASH)?e:`${e}${bs.FORWARD_SLASH}`}Jf.reservedTenantDomains=new Set(["{tenant}","{tenantid}",_s,Ps,Es]);const Zf="no_tokens_found",eg="native_account_unavailable",tg="refresh_token_expired",rg="bad_token",ng=["interaction_required","consent_required","login_required",rg],og=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],ig={[Zf]:"No refresh token found in the cache. Please sign-in.",[eg]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[tg]:"Refresh token has expired.",[rg]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};class ag extends rc{constructor(e,t,r,n,o,i,a,s){super(e,t,r),Object.setPrototypeOf(this,ag.prototype),this.timestamp=n||bs.EMPTY_STRING,this.traceId=o||bs.EMPTY_STRING,this.correlationId=i||bs.EMPTY_STRING,this.claims=a||bs.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=s}}function sg(e,t,r){const n=!!e&&ng.indexOf(e)>-1,o=!!r&&og.indexOf(r)>-1,i=!!t&&ng.some((e=>t.indexOf(e)>-1));return n||i||o}function cg(e){return new ag(e,ig[e])}function lg(e,t,r){return{clientId:e,authority:t.authority,scopes:t.scopes,homeAccountIdentifier:r,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid,embeddedClientId:t.embeddedClientId||t.tokenBodyParameters?.clientId}}var ug=r(64583).Promise;const dg="None";class hg{initialize(){return ug.resolve()}getItem(e){const t=`${encodeURIComponent(e)}`,r=document.cookie.split(";");for(let e=0;e<r.length;e++){const n=r[e],[o,...i]=decodeURIComponent(n).trim().split("="),a=i.join("=");if(o===t)return a}return""}getUserData(){throw Qc(Wc)}setItem(e,t,r,n=!0,o="Lax"){let i=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=${o};`;if(r){const e=function(e){const t=new Date;return new Date(t.getTime()+864e5*e).toUTCString()}(r);i+=`expires=${e};`}(n||o===dg)&&(i+="Secure;"),document.cookie=i}async setUserData(){return ug.reject(Qc(Wc))}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach((e=>{const r=decodeURIComponent(e).trim().split("=");t.push(r[0])})),t}containsKey(e){return this.getKeys().includes(e)}}function pg(e){const t=e.getItem(Th);return t?JSON.parse(t):[]}function fg(e,t){const r=t.getItem(`${Ih}.${e}`);if(r){const e=JSON.parse(r);if(e&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("accessToken")&&e.hasOwnProperty("refreshToken"))return e}return{idToken:[],accessToken:[],refreshToken:[]}}var gg=r(64583).Promise;const mg="msal.cache.encryption";class yg{constructor(e,t,r){if(!window.localStorage)throw Sf(bf);this.memoryStorage=new zf,this.initialized=!1,this.clientId=e,this.logger=t,this.performanceClient=r,this.broadcast=new BroadcastChannel("msal.broadcast.cache")}async initialize(e){const t=new hg,r=t.getItem(mg);let n={key:"",id:""};if(r)try{n=JSON.parse(r)}catch(e){}if(n.key&&n.id){const t=Vf(Vp,Xd,this.logger,this.performanceClient,e)(n.key);this.encryptionCookie={id:n.id,key:await Yf(ff,Qd,this.logger,this.performanceClient,e)(t)},await Yf(this.importExistingCache.bind(this),Ud,this.logger,this.performanceClient,e)(e)}else{this.clear();const r=lf(),n=await Yf(pf,Jd,this.logger,this.performanceClient,e)(),o=Vf(zp,Zd,this.logger,this.performanceClient,e)(new Uint8Array(n));this.encryptionCookie={id:r,key:await Yf(ff,Qd,this.logger,this.performanceClient,e)(n)};const i={id:r,key:o};t.setItem(mg,JSON.stringify(i),0,!0,dg)}this.broadcast.addEventListener("message",this.updateCache.bind(this)),this.initialized=!0}getItem(e){return window.localStorage.getItem(e)}getUserData(e){if(!this.initialized)throw qp(Ep);return this.memoryStorage.getItem(e)}setItem(e,t){window.localStorage.setItem(e,t)}async setUserData(e,t,r){if(!this.initialized||!this.encryptionCookie)throw qp(Ep);const{data:n,nonce:o}=await Yf(mf,eh,this.logger,this.performanceClient,r)(this.encryptionCookie.key,t,this.getContext(e)),i={id:this.encryptionCookie.id,nonce:o,data:n};this.memoryStorage.setItem(e,t),this.setItem(e,JSON.stringify(i)),this.broadcast.postMessage({key:e,value:t,context:this.getContext(e)})}removeItem(e){this.memoryStorage.containsKey(e)&&(this.memoryStorage.removeItem(e),this.broadcast.postMessage({key:e,value:null,context:this.getContext(e)})),window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}clear(){this.memoryStorage.clear(),pg(this).forEach((e=>this.removeItem(e)));const e=fg(this.clientId,this);e.idToken.forEach((e=>this.removeItem(e))),e.accessToken.forEach((e=>this.removeItem(e))),e.refreshToken.forEach((e=>this.removeItem(e))),this.getKeys().forEach((e=>{(e.startsWith(bs.CACHE_PREFIX)||-1!==e.indexOf(this.clientId))&&this.removeItem(e)}))}async importExistingCache(e){if(!this.encryptionCookie)return;let t=pg(this);t=await this.importArray(t,e),this.setItem(Th,JSON.stringify(t));const r=fg(this.clientId,this);r.idToken=await this.importArray(r.idToken,e),r.accessToken=await this.importArray(r.accessToken,e),r.refreshToken=await this.importArray(r.refreshToken,e),this.setItem(`${Ih}.${this.clientId}`,JSON.stringify(r))}async getItemFromEncryptedCache(e,t){if(!this.encryptionCookie)return null;const r=this.getItem(e);if(!r)return null;let n;try{n=JSON.parse(r)}catch(e){return null}return n.id&&n.nonce&&n.data?n.id!==this.encryptionCookie.id?(this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},t),null):Yf(yf,th,this.logger,this.performanceClient,t)(this.encryptionCookie.key,n.nonce,this.getContext(e),n.data):(this.performanceClient.incrementFields({unencryptedCacheCount:1},t),null)}async importArray(e,t){const r=[],n=[];return e.forEach((e=>{const o=this.getItemFromEncryptedCache(e,t).then((t=>{t?(this.memoryStorage.setItem(e,t),r.push(e)):this.removeItem(e)}));n.push(o)})),await gg.all(n),r}getContext(e){let t="";return e.includes(this.clientId)&&(t=this.clientId),t}updateCache(e){this.logger.trace("Updating internal cache from broadcast event");const t=this.performanceClient.startMeasurement(zd);t.add({isBackground:!0});const{key:r,value:n,context:o}=e.data;return r?o&&o!==this.clientId?(this.logger.trace(`Ignoring broadcast event from clientId: ${o}`),void t.end({success:!1,errorCode:"contextMismatch"})):(n?(this.memoryStorage.setItem(r,n),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(r),this.logger.verbose("Removed item from internal cache")),void t.end({success:!0})):(this.logger.error("Broadcast event missing key"),void t.end({success:!1,errorCode:"noKey"}))}}class vg{constructor(){if(!window.sessionStorage)throw Sf(bf)}async initialize(){}getItem(e){return window.sessionStorage.getItem(e)}getUserData(e){return this.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}}const bg="msal:initializeEnd",wg="msal:accountAdded",Cg="msal:accountRemoved",Ag="msal:activeAccountChanged",kg="msal:loginStart",Sg="msal:loginSuccess",Tg="msal:loginFailure",Ig="msal:acquireTokenStart",xg="msal:acquireTokenSuccess",_g="msal:acquireTokenFailure",Eg="msal:acquireTokenByCodeFailure",Pg="msal:handleRedirectEnd",Rg="msal:popupOpened",Og="msal:logoutStart",Mg="msal:logoutSuccess",Ng="msal:logoutFailure",Bg="msal:logoutEnd";var Lg=r(64583).Promise;class Hg extends fu{constructor(e,t,r,n,o,i,a){super(e,r,n,a),this.cacheConfig=t,this.logger=n,this.internalStorage=new zf,this.browserStorage=$g(e,t.cacheLocation,n,o),this.temporaryCacheStorage=$g(e,t.temporaryCacheLocation,n,o),this.cookieStorage=new hg,this.performanceClient=o,this.eventHandler=i}async initialize(e){await this.browserStorage.initialize(e)}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}}getAccount(e){this.logger.trace("BrowserCacheManager.getAccount called");const t=this.browserStorage.getUserData(e);if(!t)return this.removeAccountKeyFromMap(e),null;const r=this.validateAndParseJson(t);return r&&Zl.isAccountEntity(r)?fu.toObject(new Zl,r):(this.removeAccountKeyFromMap(e),null)}async setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");const r=e.generateAccountKey();await Yf(this.browserStorage.setUserData.bind(this.browserStorage),jd,this.logger,this.performanceClient)(r,JSON.stringify(e),t);const n=this.addAccountKeyToMap(r);this.cacheConfig.cacheLocation===fh&&n&&this.eventHandler.emitEvent(wg,void 0,e.getAccountInfo())}getAccountKeys(){return pg(this.browserStorage)}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const t=this.getAccountKeys();return-1===t.indexOf(e)?(t.push(e),this.browserStorage.setItem(Th,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const t=this.getAccountKeys(),r=t.indexOf(e);r>-1?(t.splice(r,1),this.browserStorage.setItem(Th,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e){super.removeAccount(e),this.removeAccountKeyFromMap(e)}async removeAccountContext(e){await super.removeAccountContext(e),this.cacheConfig.cacheLocation===fh&&this.eventHandler.emitEvent(Cg,void 0,e.getAccountInfo())}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,Hs.ID_TOKEN)}async removeAccessToken(e){super.removeAccessToken(e),this.removeTokenKey(e,Hs.ACCESS_TOKEN)}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,Hs.REFRESH_TOKEN)}getTokenKeys(){return fg(this.clientId,this.browserStorage)}addTokenKey(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");const r=this.getTokenKeys();switch(t){case Hs.ID_TOKEN:-1===r.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case Hs.ACCESS_TOKEN:-1===r.accessToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),r.accessToken.push(e));break;case Hs.REFRESH_TOKEN:-1===r.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),Qc(Mc)}this.browserStorage.setItem(`${Ih}.${this.clientId}`,JSON.stringify(r))}removeTokenKey(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");const r=this.getTokenKeys();switch(t){case Hs.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const n=r.idToken.indexOf(e);n>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case Hs.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const o=r.accessToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.accessToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case Hs.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const i=r.refreshToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.refreshToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),Qc(Mc)}this.browserStorage.setItem(`${Ih}.${this.clientId}`,JSON.stringify(r))}getIdTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,Hs.ID_TOKEN),null;const r=this.validateAndParseJson(t);return r&&(n=r)&&ul(n)&&n.hasOwnProperty("realm")&&n.credentialType===Hs.ID_TOKEN?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,Hs.ID_TOKEN),null);var n}async setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const r=al(e);await Yf(this.browserStorage.setUserData.bind(this.browserStorage),jd,this.logger,this.performanceClient)(r,JSON.stringify(e),t),this.addTokenKey(r,Hs.ID_TOKEN)}getAccessTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,Hs.ACCESS_TOKEN),null;const r=this.validateAndParseJson(t);return r&&(n=r)&&ul(n)&&n.hasOwnProperty("realm")&&n.hasOwnProperty("target")&&(n.credentialType===Hs.ACCESS_TOKEN||n.credentialType===Hs.ACCESS_TOKEN_WITH_AUTH_SCHEME)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,Hs.ACCESS_TOKEN),null);var n}async setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const r=al(e);await Yf(this.browserStorage.setUserData.bind(this.browserStorage),jd,this.logger,this.performanceClient)(r,JSON.stringify(e),t),this.addTokenKey(r,Hs.ACCESS_TOKEN)}getRefreshTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,Hs.REFRESH_TOKEN),null;const r=this.validateAndParseJson(t);return r&&(n=r)&&ul(n)&&n.credentialType===Hs.REFRESH_TOKEN?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,Hs.REFRESH_TOKEN),null);var n}async setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const r=al(e);await Yf(this.browserStorage.setUserData.bind(this.browserStorage),jd,this.logger,this.performanceClient)(r,JSON.stringify(e),t),this.addTokenKey(r,Hs.REFRESH_TOKEN)}getAppMetadata(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&((n=r)&&0===e.indexOf($s)&&n.hasOwnProperty("clientId")&&n.hasOwnProperty("environment"))?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null);var n}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");const t=function({environment:e,clientId:t}){return[$s,e,t].join(Ls).toLowerCase()}(e);this.browserStorage.setItem(t,JSON.stringify(e))}getServerTelemetry(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){const r=0===e.indexOf(Ks.CACHE_KEY);let n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n}(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),r):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.browserStorage.setItem(e,JSON.stringify(t))}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){return!!t&&0===e.indexOf(Fs)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")}(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),r):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter((e=>this.isAuthorityMetadata(e)))}setWrapperMetadata(e,t){this.internalStorage.setItem(xh,e),this.internalStorage.setItem(_h,t)}getWrapperMetadata(){return[this.internalStorage.getItem(xh)||bs.EMPTY_STRING,this.internalStorage.getItem(_h)||bs.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(){const e=this.generateCacheKey(xs),t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;const r=this.validateAndParseJson(t);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId,tenantId:r.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){const t=this.generateCacheKey(xs);if(e){this.logger.verbose("setActiveAccount: Active account set");const r={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(t,JSON.stringify(r))}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t);this.eventHandler.emitEvent(Ag)}getThrottlingCache(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){let r=!1;e&&(r=0===e.indexOf(Gs));let n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n}(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),r):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.browserStorage.setItem(e,JSON.stringify(t))}getTemporaryCache(e,t){const r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const e=this.cookieStorage.getItem(r);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e}const n=this.temporaryCacheStorage.getItem(r);if(!n){if(this.cacheConfig.cacheLocation===fh){const e=this.browserStorage.getItem(r);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),n}setTemporaryCache(e,t,r){const n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(n,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}async clear(){await this.removeAllAccounts(),this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach((e=>{-1===e.indexOf(bs.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.removeTemporaryItem(e)})),this.browserStorage.getKeys().forEach((e=>{-1===e.indexOf(bs.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.browserStorage.removeItem(e)})),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,t){e.addQueueMeasurement(Fd,t);const r=this.getTokenKeys(),n=[];r.accessToken.forEach((e=>{const t=this.getAccessTokenCredential(e);t?.requestedClaimsHash&&e.includes(t.requestedClaimsHash.toLowerCase())&&n.push(this.removeAccessToken(e))})),await Lg.all(n),n.length>0&&this.logger.warning(`${n.length} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):Kl.startsWith(e,bs.CACHE_PREFIX)?e:`${bs.CACHE_PREFIX}.${this.clientId}.${e}`}resetRequestCache(){this.logger.trace("BrowserCacheManager.resetRequestCache called"),this.removeTemporaryItem(this.generateCacheKey(Ch)),this.removeTemporaryItem(this.generateCacheKey(Ah)),this.removeTemporaryItem(this.generateCacheKey(bh)),this.removeTemporaryItem(this.generateCacheKey(wh)),this.removeTemporaryItem(this.generateCacheKey(Sh)),this.setInteractionInProgress(!1)}cacheAuthorizeRequest(e,t){this.logger.trace("BrowserCacheManager.cacheAuthorizeRequest called");const r=Kp(JSON.stringify(e));if(this.setTemporaryCache(Ch,r,!0),t){const e=Kp(t);this.setTemporaryCache(Ah,e,!0)}}getCachedRequest(){this.logger.trace("BrowserCacheManager.getCachedRequest called");const e=this.getTemporaryCache(Ch,!0);if(!e)throw qp(lp);const t=this.getTemporaryCache(Ah,!0);let r,n="";try{r=JSON.parse(Gp(e)),t&&(n=Gp(t))}catch(t){throw this.logger.errorPii(`Attempted to parse: ${e}`),this.logger.error(`Parsing cached token request threw with error: ${t}`),qp(up)}return[r,n]}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(Sh,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;return this.validateAndParseJson(e)||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress()?.clientId;return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${bs.CACHE_PREFIX}.${kh}`,t=this.getTemporaryCache(e,!1);try{return t?JSON.parse(t):null}catch(t){return this.logger.error("Cannot parse interaction status. Removing temporary cache items and clearing url hash. Retrying interaction should fix the error"),this.removeTemporaryItem(e),this.resetRequestCache(),Tf(window),null}}setInteractionInProgress(e,t=yh){const r=`${bs.CACHE_PREFIX}.${kh}`;if(e){if(this.getInteractionInProgress())throw qp(Qh);this.setTemporaryCache(r,JSON.stringify({clientId:this.clientId,type:t}),!1)}else e||this.getInteractionInProgress()?.clientId!==this.clientId||this.removeTemporaryItem(r)}async hydrateCache(e,t){const r=sl(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId);let n;t.claims&&(n=await this.cryptoImpl.hashString(t.claims));const o={idToken:r,accessToken:cl(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?nl(e.expiresOn):0,e.extExpiresOn?nl(e.extExpiresOn):0,Gp,void 0,e.tokenType,void 0,t.sshKid,t.claims,n)};return this.saveCacheRecord(o,e.correlationId)}async saveCacheRecord(e,t,r){try{await super.saveCacheRecord(e,t,r)}catch(e){if(e instanceof hu&&this.performanceClient&&t)try{const e=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:e.refreshToken.length,cacheIdCount:e.idToken.length,cacheAtCount:e.accessToken.length},t)}catch(e){}throw e}}}function $g(e,t,r,n){try{switch(t){case fh:return new yg(e,r,n);case gh:return new vg}}catch(e){r.error(e)}return new zf}class qg{constructor(e){this.eventCallbacks=new Map,this.logger=e||new Ys({}),"undefined"!=typeof BroadcastChannel&&(this.broadcastChannel=new BroadcastChannel("msal.broadcast.event")),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(e,t,r){if("undefined"!=typeof window){const n=r||lf();return this.eventCallbacks.has(n)?(this.logger.error(`Event callback with id: ${n} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(n,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${n}`),n)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,r,n){const o={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};switch(e){case wg:case Cg:case Ag:this.broadcastChannel?.postMessage(o);break;default:this.invokeCallbacks(o)}}invokeCallbacks(e){this.eventCallbacks.forEach((([t,r],n)=>{(0===r.length||r.includes(e.eventType))&&(this.logger.verbose(`Emitting event to callback ${n}: ${e.eventType}`),t.apply(null,[e]))}))}invokeCrossTabCallbacks(e){const t=e.data;this.invokeCallbacks(t)}subscribeCrossTab(){this.broadcastChannel?.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){this.broadcastChannel?.removeEventListener("message",this.invokeCrossTabCallbacks)}}const Fg="home_account_id",Dg="UPN",Ug="client_id",jg="redirect_uri",zg="token_type",Kg="req_cnf",Wg="return_spa_code",Gg="x-client-xtra-sku",Vg="brk_client_id",Yg="brk_redirect_uri",Qg="instance_aware";function Jg(e,t,r){if(!t)return;const n=e.get(Ug);n&&e.has(Vg)&&r?.addFields({embeddedClientId:n,embeddedRedirectUri:e.get(jg)},t)}function Xg(e,t){e.set("response_type",t)}function Zg(e,t,r=!0,n=ws){!r||n.includes("openid")||t.includes("openid")||n.push("openid");const o=r?[...t||[],...n]:t||[],i=new Wl(o);e.set("scope",i.printScopes())}function em(e,t){e.set(Ug,t)}function tm(e,t){e.set(jg,t)}function rm(e,t){e.set("login_hint",t)}function nm(e,t){e.set(Ss,`UPN:${t}`)}function om(e,t){e.set(Ss,`Oid:${t.uid}@${t.utid}`)}function im(e,t){e.set("sid",t)}function am(e,t,r){const n=function(e,t){let r;if(e)try{r=JSON.parse(e)}catch(e){throw zl(xl)}else r={};return t&&t.length>0&&(r.hasOwnProperty(Rs)||(r[Rs]={}),r[Rs].xms_cc={values:t}),JSON.stringify(r)}(t,r);try{JSON.parse(n)}catch(e){throw zl(xl)}e.set("claims",n)}function sm(e,t){e.set("client-request-id",t)}function cm(e,t){e.set("x-client-SKU",t.sku),e.set("x-client-VER",t.version),t.os&&e.set("x-client-OS",t.os),t.cpu&&e.set("x-client-CPU",t.cpu)}function lm(e,t){t?.appName&&e.set("x-app-name",t.appName),t?.appVersion&&e.set("x-app-ver",t.appVersion)}function um(e,t){t&&e.set("state",t)}function dm(e,t){e.set("client_secret",t)}function hm(e,t){t&&e.set("client_assertion",t)}function pm(e,t){t&&e.set("client_assertion_type",t)}function fm(e,t){e.set("grant_type",t)}function gm(e){e.set("client_info","1")}function mm(e){e.has(Qg)||e.set(Qg,"true")}function ym(e,t){Object.entries(t).forEach((([t,r])=>{!e.has(t)&&r&&e.set(t,r)}))}function vm(e,t){t&&(e.set(zg,Ws.POP),e.set(Kg,t))}function bm(e,t){t&&(e.set(zg,Ws.SSH),e.set(Kg,t))}function wm(e,t){e.set("x-client-current-telemetry",t.generateCurrentRequestHeaderValue()),e.set("x-client-last-telemetry",t.generateLastRequestHeaderValue())}function Cm(e){e.set("x-ms-lib-capability","retry-after, h429")}function Am(e,t,r){e.has(Vg)||e.set(Vg,t),e.has(Yg)||e.set(Yg,r)}async function km(e,t,r,n,o,i,a){a?.addQueueMeasurement(Td,i);const s=Jf.transformCIAMAuthority(Xf(e)),c=new Jf(s,t,r,n,o,i,a);try{return await Yf(c.resolveEndpointsAsync.bind(c),Id,o,a,i)(),c}catch(e){throw Qc(cc)}}class Sm extends rc{constructor(e,t,r,n,o){super(e,t,r),this.name="ServerError",this.errorNo=n,this.status=o,Object.setPrototypeOf(this,Sm.prototype)}}class Tm{static generateThrottlingStorageKey(e){return`${Gs}.${JSON.stringify(e)}`}static preProcess(e,t){const r=Tm.generateThrottlingStorageKey(t),n=e.getThrottlingCache(r);if(n){if(n.throttleTime<Date.now())return void e.removeItem(r);throw new Sm(n.errorCodes?.join(" ")||bs.EMPTY_STRING,n.errorMessage,n.subError)}}static postProcess(e,t,r){if(Tm.checkResponseStatus(r)||Tm.checkResponseForRetryAfter(r)){const n={throttleTime:Tm.calculateThrottleTime(parseInt(r.headers[ks])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(Tm.generateThrottlingStorageKey(t),n)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&e.headers.hasOwnProperty(ks)&&(e.status<200||e.status>=300)}static calculateThrottleTime(e){const t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||60),r+3600))}static removeThrottle(e,t,r,n){const o=lg(t,r,n),i=this.generateThrottlingStorageKey(o);e.removeItem(i)}}class Im{constructor(e,t){this.config=function({authOptions:e,systemOptions:t,loggerOptions:r,cacheOptions:n,storageInterface:o,networkInterface:i,cryptoInterface:a,clientCredentials:s,libraryInfo:c,telemetry:l,serverTelemetryManager:u,persistencePlugin:d,serializableCache:h}){const p={...yu,...r};return{authOptions:(f=e,{clientCapabilities:[],azureCloudOptions:Au,skipAuthorityMetadataCache:!1,instanceAware:!1,encodeExtraQueryParams:!1,...f}),systemOptions:{...mu,...t},loggerOptions:p,cacheOptions:{...vu,...n},storageInterface:o||new gu(e.clientId,Jc,new Ys(p)),networkInterface:i||bu,cryptoInterface:a||Jc,clientCredentials:s||Cu,libraryInfo:{...wu,...c},telemetry:{...ku,...l},serverTelemetryManager:u||null,persistencePlugin:d||null,serializableCache:h||null};var f}(e),this.logger=new Ys(this.config.loggerOptions,Xc,Zc),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[As]=bs.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Fg:try{const r=Vl(e.credential);t[Ss]=`Oid:${r.uid}@${r.utid}`}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Dg:t[Ss]=`UPN: ${e.credential}`}return t}async executePostToTokenEndpoint(e,t,r,n,o,i){i&&this.performanceClient?.addQueueMeasurement(i,o);const a=await this.sendPostRequest(n,e,{body:t,headers:r},o);return this.config.serverTelemetryManager&&a.status<500&&429!==a.status&&this.config.serverTelemetryManager.clearTelemetryCache(),a}async sendPostRequest(e,t,r,n){let o;Tm.preProcess(this.cacheManager,e);try{o=await Yf(this.networkClient.sendPostRequestAsync.bind(this.networkClient),Du,this.logger,this.performanceClient,n)(t,r);const e=o.headers||{};this.performanceClient?.addFields({refreshTokenSize:o.body.refresh_token?.length||0,httpVerToken:e[Is]||"",requestId:e[Ts]||""},n)}catch(e){if(e instanceof $h){const t=e.responseHeaders;throw t&&this.performanceClient?.addFields({httpVerToken:t[Is]||"",requestId:t[Ts]||"",contentTypeHeader:t[As]||void 0,contentLengthHeader:t["Content-Length"]||void 0,httpStatus:e.httpStatus},n),e.error}throw e instanceof rc?e:Qc(lc)}return Tm.postProcess(this.cacheManager,e,o),o}async updateAuthority(e,t){this.performanceClient?.addQueueMeasurement(yd,t);const r=`https://${e}/${this.authority.tenant}/`,n=await km(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=n}createTokenQueryParameters(e){const t=new Map;return e.embeddedClientId&&Am(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&ym(t,e.tokenQueryParameters),sm(t,e.correlationId),Jg(t,e.correlationId,this.performanceClient),ru(t)}}class xm{static setRequestState(e,t,r){const n=xm.generateLibraryState(e,r);return t?`${n}${bs.RESOURCE_DELIM}${t}`:n}static generateLibraryState(e,t){if(!e)throw Qc(Oc);const r={id:e.createNewGuid()};t&&(r.meta=t);const n=JSON.stringify(r);return e.base64Encode(n)}static parseRequestState(e,t){if(!e)throw Qc(Oc);if(!t)throw Qc(hc);try{const r=t.split(bs.RESOURCE_DELIM),n=r[0],o=r.length>1?r.slice(1).join(bs.RESOURCE_DELIM):bs.EMPTY_STRING,i=e.base64Decode(n),a=JSON.parse(i);return{userRequestState:o||bs.EMPTY_STRING,libraryState:a}}catch(e){throw Qc(hc)}}}class _m{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){this.performanceClient?.addQueueMeasurement(Cd,e.correlationId);const r=await Yf(this.generateKid.bind(this),Cd,t,this.performanceClient,e.correlationId)(e),n=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:n}}async generateKid(e){return this.performanceClient?.addQueueMeasurement(Ad,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:"sw"}}async signPopToken(e,t,r){return this.signPayload(e,t,r)}async signPayload(e,t,r,n){const{resourceRequestMethod:o,resourceRequestUri:i,shrClaims:a,shrNonce:s,shrOptions:c}=r,l=i?new nu(i):void 0,u=l?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:rl(),m:o?.toUpperCase(),u:u?.HostNameAndPort,nonce:s||this.cryptoUtils.createNewGuid(),p:u?.AbsolutePath,q:u?.QueryString?[[],u.QueryString]:void 0,client_claims:a||void 0,...n},t,c,r.correlationId)}}class Em{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class Pm{constructor(e,t,r,n,o,i,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i,this.performanceClient=a}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){const r=`Error(s): ${e.error_codes||bs.NOT_AVAILABLE} - Timestamp: ${e.timestamp||bs.NOT_AVAILABLE} - Description: ${e.error_description||bs.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||bs.NOT_AVAILABLE} - Trace ID: ${e.trace_id||bs.NOT_AVAILABLE}`,n=e.error_codes?.length?e.error_codes[0]:void 0,o=new Sm(e.error,r,e.suberror,n,e.status);if(t&&e.status&&e.status>=500&&e.status<=599)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n${o}`);if(t&&e.status&&e.status>=400&&e.status<=499)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n${o}`);if(sg(e.error,e.error_description,e.suberror))throw new ag(e.error,e.error_description,e.suberror,e.timestamp||bs.EMPTY_STRING,e.trace_id||bs.EMPTY_STRING,e.correlation_id||bs.EMPTY_STRING,e.claims||bs.EMPTY_STRING,n);throw o}}async handleServerTokenResponse(e,t,r,n,o,i,a,s,c){let l,u;if(this.performanceClient?.addQueueMeasurement(kd,e.correlation_id),e.id_token){if(l=el(e.id_token||bs.EMPTY_STRING,this.cryptoObj.base64Decode),o&&o.nonce&&l.nonce!==o.nonce)throw Qc(gc);if(n.maxAge||0===n.maxAge){const e=l.auth_time;if(!e)throw Qc(mc);tl(e,n.maxAge)}}this.homeAccountIdentifier=Zl.generateHomeAccountId(e.client_info||bs.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,l),o&&o.state&&(u=xm.parseRequestState(this.cryptoObj,o.state)),e.key_id=e.key_id||n.sshKid||void 0;const d=this.generateCacheRecord(e,t,r,n,l,i,o);let h;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),h=new Em(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(h)),a&&!s&&d.account){const e=d.account.generateAccountKey();if(!this.cacheStorage.getAccount(e))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await Pm.generateAuthenticationResult(this.cryptoObj,t,d,!1,n,l,u,void 0,c)}await this.cacheStorage.saveCacheRecord(d,n.correlationId,n.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&h&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(h))}return Pm.generateAuthenticationResult(this.cryptoObj,t,d,!1,n,l,u,e,c)}generateCacheRecord(e,t,r,n,o,i,a){const s=t.getPreferredCache();if(!s)throw Qc(Pc);const c=Xl(o);let l,u;e.id_token&&o&&(l=sl(this.homeAccountIdentifier,s,e.id_token,this.clientId,c||""),u=Rm(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,o,e.client_info,s,c,a,void 0,this.logger));let d=null;if(e.access_token){const o=e.scope?Wl.fromString(e.scope):new Wl(n.scopes||[]),a=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,l=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,u=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,h=r+a,p=h+l,f=u&&u>0?r+u:void 0;d=cl(this.homeAccountIdentifier,s,e.access_token,this.clientId,c||t.tenant||"",o.printScopes(),h,p,this.cryptoObj.base64Decode,f,e.token_type,i,e.key_id,n.claims,n.requestedClaimsHash)}let h=null;if(e.refresh_token){let t;e.refresh_token_expires_in&&(t=r+("string"==typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)),h=ll(this.homeAccountIdentifier,s,e.refresh_token,this.clientId,e.foci,i,t)}let p=null;return e.foci&&(p={clientId:this.clientId,environment:s,familyId:e.foci}),{account:u,idToken:l,accessToken:d,refreshToken:h,appMetadata:p}}static async generateAuthenticationResult(e,t,r,n,o,i,a,s,c){let l,u,d=bs.EMPTY_STRING,h=[],p=null,f=bs.EMPTY_STRING;if(r.accessToken){if(r.accessToken.tokenType!==Ws.POP||o.popKid)d=r.accessToken.secret;else{const t=new _m(e),{secret:n,keyId:i}=r.accessToken;if(!i)throw Qc(Uc);d=await t.signPopToken(n,i,o)}h=Wl.fromString(r.accessToken.target).asArray(),p=ol(r.accessToken.expiresOn),l=ol(r.accessToken.extendedExpiresOn),r.accessToken.refreshOn&&(u=ol(r.accessToken.refreshOn))}r.appMetadata&&(f=r.appMetadata.familyId===qs?qs:"");const g=i?.oid||i?.sub||"",m=i?.tid||"";s?.spa_accountid&&r.account&&(r.account.nativeAccountId=s?.spa_accountid);const y=r.account?Jl(r.account.getAccountInfo(),void 0,i,r.idToken?.secret):null;return{authority:t.canonicalAuthority,uniqueId:g,tenantId:m,scopes:h,account:y,idToken:r?.idToken?.secret||"",idTokenClaims:i||{},accessToken:d,fromCache:n,expiresOn:p,extExpiresOn:l,refreshOn:u,correlationId:o.correlationId,requestId:c||bs.EMPTY_STRING,familyId:f,tokenType:r.accessToken?.tokenType||bs.EMPTY_STRING,state:a?a.userRequestState:bs.EMPTY_STRING,cloudGraphHostName:r.account?.cloudGraphHostName||bs.EMPTY_STRING,msGraphHost:r.account?.msGraphHost||bs.EMPTY_STRING,code:s?.spa_code,fromNativeBroker:!1}}}function Rm(e,t,r,n,o,i,a,s,c,l,u){u?.verbose("setCachedAccount called");const d=e.getAccountKeys().find((e=>e.startsWith(r)));let h=null;d&&(h=e.getAccount(d));const p=h||Zl.createAccount({homeAccountId:r,idTokenClaims:o,clientInfo:i,environment:a,cloudGraphHostName:c?.cloud_graph_host_name,msGraphHost:c?.msgraph_host,nativeAccountId:l},t,n),f=p.tenantProfiles||[],g=s||p.realm;if(g&&!f.find((e=>e.tenantId===g))){const e=Ql(r,p.localAccountId,g,o);f.push(e)}return p.tenantProfiles=f,p}class Om{static validateRedirectUri(e){if(!e)throw zl(wl)}static validatePrompt(e){const t=[];for(const e in Os)t.push(Os[e]);if(t.indexOf(e)<0)throw zl(Il)}static validateClaims(e){try{JSON.parse(e)}catch(e){throw zl(xl)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw zl(Rl);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([Ms.PLAIN,Ms.S256].indexOf(e)<0)throw zl(Pl)}}async function Mm(e,t,r){return"string"==typeof e?e:e({clientId:t,tokenEndpoint:r})}class Nm extends Im{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async acquireToken(e,t){if(this.performanceClient?.addQueueMeasurement(vd,e.correlationId),!e.code)throw Qc(Cc);const r=rl(),n=await Yf(this.executeTokenRequest.bind(this),bd,this.logger,this.performanceClient,e.correlationId)(this.authority,e),o=n.headers?.[Ts],i=new Pm(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return i.validateTokenResponse(n.body),Yf(i.handleServerTokenResponse.bind(i),kd,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,r,e,t,void 0,void 0,void 0,o)}getLogoutUri(e){if(!e)throw zl(El);const t=this.createLogoutUrlQueryString(e);return nu.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(bd,t.correlationId);const r=this.createTokenQueryParameters(t),n=nu.appendQueryString(e.tokenEndpoint,r),o=await Yf(this.createTokenRequestBody.bind(this),wd,this.logger,this.performanceClient,t.correlationId)(t);let i;if(t.clientInfo)try{const e=Gl(t.clientInfo,this.cryptoUtils.base64Decode);i={credential:`${e.uid}.${e.utid}`,type:Fg}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}const a=this.createTokenRequestHeaders(i||t.ccsCredential),s=lg(this.config.authOptions.clientId,t);return Yf(this.executePostToTokenEndpoint.bind(this),ju,this.logger,this.performanceClient,t.correlationId)(n,o,a,s,t.correlationId,ju)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(wd,e.correlationId);const t=new Map;if(em(t,e.embeddedClientId||e.tokenBodyParameters?.[Ug]||this.config.authOptions.clientId),this.includeRedirectUri?tm(t,e.redirectUri):Om.validateRedirectUri(e.redirectUri),Zg(t,e.scopes,!0,this.oidcDefaultScopes),function(e,t){e.set("code",t)}(t,e.code),cm(t,this.config.libraryInfo),lm(t,this.config.telemetry.application),Cm(t),this.serverTelemetryManager&&!Su(this.config)&&wm(t,this.serverTelemetryManager),e.codeVerifier&&function(e,t){e.set("code_verifier",t)}(t,e.codeVerifier),this.config.clientCredentials.clientSecret&&dm(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const r=this.config.clientCredentials.clientAssertion;hm(t,await Mm(r.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),pm(t,r.assertionType)}if(fm(t,"authorization_code"),gm(t),e.authenticationScheme===Ws.POP){const r=new _m(this.cryptoUtils,this.performanceClient);let n;n=e.popKid?this.cryptoUtils.encodeKid(e.popKid):(await Yf(r.generateCnf.bind(r),Cd,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,vm(t,n)}else if(e.authenticationScheme===Ws.SSH){if(!e.sshJwk)throw zl(Bl);bm(t,e.sshJwk)}let r;if((!Kl.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&am(t,e.claims,this.config.authOptions.clientCapabilities),e.clientInfo)try{const t=Gl(e.clientInfo,this.cryptoUtils.base64Decode);r={credential:`${t.uid}.${t.utid}`,type:Fg}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else r=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&r)switch(r.type){case Fg:try{om(t,Vl(r.credential))}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Dg:nm(t,r.credential)}return e.embeddedClientId&&Am(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&ym(t,e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[Wg]||ym(t,{[Wg]:"1"}),Jg(t,e.correlationId,this.performanceClient),ru(t)}createLogoutUrlQueryString(e){const t=new Map;return e.postLogoutRedirectUri&&function(e,t){e.set("post_logout_redirect_uri",t)}(t,e.postLogoutRedirectUri),e.correlationId&&sm(t,e.correlationId),e.idTokenHint&&function(e,t){e.set("id_token_hint",t)}(t,e.idTokenHint),e.state&&um(t,e.state),e.logoutHint&&function(e,t){e.set("logout_hint",t)}(t,e.logoutHint),e.extraQueryParameters&&ym(t,e.extraQueryParameters),this.config.authOptions.instanceAware&&mm(t),ru(t,this.config.authOptions.encodeExtraQueryParams,e.extraQueryParameters)}}class Bm{constructor(e,t){this.cacheOutcome="0",this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||bs.EMPTY_STRING,this.wrapperVer=e.wrapperVer||bs.EMPTY_STRING,this.telemetryCacheKey=Ks.CACHE_KEY+Ls+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${Ks.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],r=this.getNativeBrokerErrorCode();r?.length&&t.push(`broker_error=${r}`);const n=t.join(Ks.VALUE_SEPARATOR),o=[e,this.getRegionDiscoveryFields()].join(Ks.VALUE_SEPARATOR);return[Ks.SCHEMA_VERSION,o,n].join(Ks.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=Bm.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(Ks.VALUE_SEPARATOR),n=e.errors.slice(0,t).join(Ks.VALUE_SEPARATOR),o=e.errors.length,i=[o,t<o?Ks.OVERFLOW_TRUE:Ks.OVERFLOW_FALSE].join(Ks.VALUE_SEPARATOR);return[Ks.SCHEMA_VERSION,e.cacheHits,r,n,i].join(Ks.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=Ks.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof rc?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(Ks.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const e=this.getLastRequests(),t=Bm.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{const r={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r)}}static maxErrorsToSend(e){let t,r=0,n=0;const o=e.errors.length;for(t=0;t<o;t++){const o=e.failedRequests[2*t]||bs.EMPTY_STRING,i=e.failedRequests[2*t+1]||bs.EMPTY_STRING,a=e.errors[t]||bs.EMPTY_STRING;if(n+=o.toString().length+i.toString().length+a.length+3,!(n<Ks.MAX_LAST_HEADER_BYTES))break;r+=1}return r}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||bs.EMPTY_STRING),e.push(this.regionSource||bs.EMPTY_STRING),e.push(this.regionOutcome||bs.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return function(e){const{skus:t,libraryName:r,libraryVersion:n,extensionName:o,extensionVersion:i}=e,a=new Map([[0,[r,n]],[2,[o,i]]]);let s=[];if(t?.length){if(s=t.split(","),s.length<4)return t}else s=Array.from({length:4},(()=>"|"));return a.forEach(((e,t)=>{2===e.length&&e[0]?.length&&e[1]?.length&&function(e){const{skuArr:t,index:r,skuName:n,skuVersion:o}=e;r>=t.length||(t[r]=[n,o].join("|"))}({skuArr:s,index:t,skuName:e[0],skuVersion:e[1]})})),s.join(",")}(e)}}class Lm{constructor(e,t,r,n,o,i,a,s,c){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.navigationClient=i,this.nativeMessageHandler=s,this.correlationId=c||lf(),this.logger=n.clone(lh,Mf,this.correlationId),this.performanceClient=a}async clearCacheOnLogout(e){if(e){Zl.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{await this.browserStorage.removeAccount(Zl.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(e){this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(),await this.browserCrypto.clearKeystore()}catch(e){this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return nu.getAbsoluteUrl(t,xf())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Bm(r,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,r=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(qu,this.correlationId);const n={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e.requestAuthority||this.config.auth.authority,i=r?.length?"true"===r:this.config.auth.instanceAware,a=t&&i?this.config.auth.authority.replace(nu.getDomainFromUrl(o),t.environment):o,s=Jf.generateAuthority(a,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),c=await Yf(km,Td,this.logger,this.performanceClient,this.correlationId)(s,this.config.system.networkClient,this.browserStorage,n,this.logger,this.correlationId,this.performanceClient);if(t&&!c.isAlias(t.environment))throw zl(Dl);return c}}async function Hm(e,t,r,n){r.addQueueMeasurement(Zu,e.correlationId);const o=e.authority||t.auth.authority,i=[...e&&e.scopes||[]],a={...e,correlationId:e.correlationId,authority:o,scopes:i};if(a.authenticationScheme){if(a.authenticationScheme===Ws.SSH){if(!e.sshJwk)throw zl(Bl);if(!e.sshKid)throw zl(Ll)}n.verbose(`Authentication Scheme set to "${a.authenticationScheme}" as configured in Auth request`)}else a.authenticationScheme=Ws.BEARER,n.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return t.cache.claimsBasedCachingEnabled&&e.claims&&!Kl.isEmptyObj(e.claims)&&(a.requestedClaimsHash=await vf(e.claims)),a}async function $m(e,t,r,n,o){n.addQueueMeasurement(ed,e.correlationId);const i=await Yf(Hm,Zu,o,n,e.correlationId)(e,r,n,o);return{...e,...i,account:t,forceRefresh:e.forceRefresh||!1}}class qm extends Lm{initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);const t={correlationId:this.correlationId||lf(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=nu.getAbsoluteUrl(e.postLogoutRedirectUri,xf())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=nu.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,xf())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=nu.getAbsoluteUrl(xf(),xf())),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(cd,this.correlationId);const t=await Yf(this.getClientConfiguration.bind(this),ld,this.logger,this.performanceClient,this.correlationId)(e);return new Nm(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:r,requestAzureCloudOptions:n,requestExtraQueryParameters:o,account:i}=e;this.performanceClient.addQueueMeasurement(ld,this.correlationId);const a=await Yf(this.getDiscoveredAuthority.bind(this),qu,this.logger,this.performanceClient,this.correlationId)({requestAuthority:r,requestAzureCloudOptions:n,requestExtraQueryParameters:o,account:i}),s=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:a,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:s.loggerCallback,piiLoggingEnabled:s.piiLoggingEnabled,logLevel:s.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:lh,version:Mf,cpu:bs.EMPTY_STRING,os:bs.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(ud,this.correlationId);const r=this.getRedirectUri(e.redirectUri),n={interactionType:t},o=xm.setRequestState(this.browserCrypto,e&&e.state||bs.EMPTY_STRING,n),i={...await Yf(Hm,Zu,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:r,state:o,nonce:e.nonce||lf(),responseMode:this.config.auth.OIDCOptions.serverResponseType};if(e.loginHint||e.sid)return i;const a=e.account||this.browserStorage.getActiveAccount();return a&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${a.homeAccountId}`,this.correlationId),i.account=a),i}}const Fm="user_switch",Dm={[Fm]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class Um extends rc{constructor(e,t,r){super(e,t),Object.setPrototypeOf(this,Um.prototype),this.name="NativeAuthError",this.ext=r}}function jm(e){return!(!e.ext||!e.ext.status||"PERSISTENT_ERROR"!==e.ext.status&&"DISABLED"!==e.ext.status)||!(!e.ext||!e.ext.error||-2147186943!==e.ext.error)||"ContentError"===e.errorCode}function zm(e,t,r){if(r&&r.status)switch(r.status){case"ACCOUNT_UNAVAILABLE":return cg(eg);case"USER_INTERACTION_REQUIRED":return new ag(e,t);case"USER_CANCEL":return qp(Zh);case"NO_NETWORK":return qp(gp)}return new Um(e,Dm[e]||t,r)}var Km=r(64583).Promise;class Wm{constructor(e,t,r,n){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=n,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement($d)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const t={channel:uh,extensionId:this.extensionId,responseId:lf(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Km(((e,r)=>{this.resolvers.set(t.responseId,{resolve:e,reject:r})}))}static async createProvider(e,t,r){e.trace("NativeMessageHandler - createProvider called.");try{const n=new Wm(e,t,r,dh);return await n.sendHandshakeRequest(),n}catch(n){const o=new Wm(e,t,r);return await o.sendHandshakeRequest(),o}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:uh,extensionId:this.extensionId,responseId:lf(),body:{method:hh}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=e=>{this.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Km(((t,r)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:r}),this.timeoutId=window.setTimeout((()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),r(qp(Ip)),this.handshakeResolvers.delete(e.responseId)}),this.handshakeTimeoutMs)}))}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const t=e.data;if(t.channel&&t.channel===uh&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===hh){const e=this.handshakeResolvers.get(t.responseId);if(!e)return void this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),e.reject(qp(xp))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const t=e.data,r=this.resolvers.get(t.responseId),n=this.handshakeResolvers.get(t.responseId);try{const e=t.body.method;if("Response"===e){if(!r)return;const e=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(e)}`),"Success"!==e.status)r.reject(zm(e.code,e.description,e.ext));else{if(!e.result)throw nc(Zs,"Event does not contain result.");e.result.code&&e.result.description?r.reject(zm(e.result.code,e.result.description,e.result.ext)):r.resolve(e.result)}this.resolvers.delete(t.responseId)}else if("HandshakeResponse"===e){if(!n)return void this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),n.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(t){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${t}`),this.logger.errorPii(`Unable to parse ${e}`),r?r.reject(t):n&&n.reject(t)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isPlatformBrokerAvailable(e,t,r,n){if(t.trace("isPlatformBrokerAvailable called"),!e.system.allowPlatformBroker)return t.trace("isPlatformBrokerAvailable: allowPlatformBroker is not enabled, returning false"),!1;if(!r)return t.trace("isPlatformBrokerAvailable: Platform extension provider is not initialized, returning false"),!1;if(n)switch(n){case Ws.BEARER:case Ws.POP:return t.trace("isPlatformBrokerAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isPlatformBrokerAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}function Gm(e,t,r){const n=tu(e);if(!n)throw eu(e)?(r.error(`A ${t} is present in the iframe but it does not contain known properties. It's likely that the ${t} has been replaced by code running on the redirectUri page.`),r.errorPii(`The ${t} detected is: ${e}`),qp(Gh)):(r.error(`The request has returned to the redirectUri but a ${t} is not present. It's likely that the ${t} has been removed or the page has been redirected by code running on the redirectUri page.`),qp(Kh));return n}function Vm(e,t,r,n){const o=ru(t,r,n);return nu.appendQueryString(e.authorizationEndpoint,o)}function Ym(e,t){if(!e.state||!t)throw e.state?Qc(fc,"Cached State"):Qc(fc,"Server State");let r,n;try{r=decodeURIComponent(e.state)}catch(t){throw Qc(hc,e.state)}try{n=decodeURIComponent(t)}catch(t){throw Qc(hc,e.state)}if(r!==n)throw Qc(pc);if(e.error||e.error_description||e.suberror){const t=function(e){const t="code=",r=e.error_uri?.lastIndexOf(t);return r&&r>=0?e.error_uri?.substring(r+5):void 0}(e);if(sg(e.error,e.error_description,e.suberror))throw new ag(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",t);throw new Sm(e.error||"",e.error_description,e.suberror,t)}}class Qm{constructor(e,t,r,n,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=o}async handleCodeResponse(e,t){let r;this.performanceClient.addQueueMeasurement(pd,t.correlationId);try{r=function(e,t){if(Ym(e,t),!e.code)throw Qc(qc);return e}(e,t.state)}catch(e){throw e instanceof Sm&&e.subError===Zh?qp(Zh):e}return Yf(this.handleCodeResponseFromServer.bind(this),hd,this.logger,this.performanceClient,t.correlationId)(r,t)}async handleCodeResponseFromServer(e,t,r=!0){if(this.performanceClient.addQueueMeasurement(hd,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await Yf(this.authModule.updateAuthority.bind(this.authModule),yd,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),r&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const e=this.createCcsCredentials(t);e&&(this.authCodeRequest.ccsCredential=e)}return await Yf(this.authModule.acquireToken.bind(this.authModule),vd,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:Fg}:e.loginHint?{credential:e.loginHint,type:Dg}:null}}class Jm extends Im{constructor(e,t){super(e,t)}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(Qu,e.correlationId);let t="0";if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!Kl.isEmptyObj(e.claims))throw this.setCacheOutcome("1",e.correlationId),Qc(Lc);if(!e.account)throw Qc(_c);const r=e.account.tenantId||function(e){const t=new nu(e).getUrlComponents(),r=t.PathSegments.slice(-1)[0]?.toLowerCase();switch(r){case _s:case Es:case Ps:return;default:return r}}(e.authority),n=this.cacheManager.getTokenKeys(),o=this.cacheManager.getAccessToken(e.account,e,n,r,this.performanceClient,e.correlationId);if(!o)throw this.setCacheOutcome("2",e.correlationId),Qc(Lc);if(i=o.cachedAt,Number(i)>rl()||il(o.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome("3",e.correlationId),Qc(Lc);var i;o.refreshOn&&il(o.refreshOn,0)&&(t="4");const a=e.authority||this.authority.getPreferredCache(),s={account:this.cacheManager.readAccountFromCache(e.account),accessToken:o,idToken:this.cacheManager.getIdToken(e.account,n,r,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(a)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await Yf(this.generateResultFromCacheRecord.bind(this),Ju,this.logger,this.performanceClient,e.correlationId)(s,e),t]}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),"0"!==e&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){let r;if(this.performanceClient?.addQueueMeasurement(Ju,t.correlationId),e.idToken&&(r=el(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){const e=r?.auth_time;if(!e)throw Qc(mc);tl(e,t.maxAge)}return Pm.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)}}class Xm extends qm{async acquireToken(e){this.performanceClient.addQueueMeasurement(Bu,e.correlationId);const t=this.initializeServerTelemetryManager(61),r=await Yf(this.getClientConfiguration.bind(this),ld,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),n=new Jm(r,this.performanceClient);this.logger.verbose("Silent auth client created");try{const t=(await Yf(n.acquireCachedToken.bind(n),Qu,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),t}catch(e){throw e instanceof $p&&e.errorCode===wp&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),e}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t?.account)}}var Zm=r(64583).Promise;class ey extends Lm{constructor(e,t,r,n,o,i,a,s,c,l,u,d){super(e,t,r,n,o,i,s,c,d),this.apiId=a,this.accountId=l,this.nativeMessageHandler=c,this.nativeStorageManager=u,this.silentCacheClient=new Xm(e,this.nativeStorageManager,r,n,o,i,s,c,d);const h=this.nativeMessageHandler.getExtensionId()===dh?"chrome":this.nativeMessageHandler.getExtensionId()?.length?"unknown":void 0;this.skus=Bm.makeExtraSkuString({libraryName:lh,libraryVersion:Mf,extensionName:h,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[Gg]:this.skus}}async acquireToken(e,t){this.performanceClient.addQueueMeasurement(Fu,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const r=this.performanceClient.startMeasurement(Fu,e.correlationId),n=rl(),o=this.initializeServerTelemetryManager(this.apiId);try{const i=await this.initializeNativeRequest(e);try{const e=await this.acquireTokensFromCache(this.accountId,i);return r.end({success:!0,isNativeBroker:!1,fromCache:!0}),e}catch(e){if(1===t)throw this.logger.info("MSAL internal Cache does not contain tokens, return error as per cache policy"),e;this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const{...a}=i,s={method:ph,request:a},c=await this.nativeMessageHandler.sendMessage(s),l=this.validateNativeResponse(c);return await this.handleNativeResponse(l,i,n).then((e=>(r.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),o.clearNativeBrokerErrorCode(),e))).catch((e=>{throw r.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e}))}catch(e){throw e instanceof Um&&o.setNativeBrokerErrorCode(e.errorCode),e}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:Wl.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),Qc(Rc);const r=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!r)throw Qc(Rc);try{const e=this.createSilentCacheRequest(t,r),n=await this.silentCacheClient.acquireToken(e),o={...r,idTokenClaims:n?.idTokenClaims,idToken:n?.idToken};return{...n,account:o}}catch(e){throw e}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...r}=e;delete r.onRedirectNavigate;const n=await this.initializeNativeRequest(r),o={method:ph,request:n};try{const e=await this.nativeMessageHandler.sendMessage(o);this.validateNativeResponse(e)}catch(e){if(e instanceof Um&&(this.initializeServerTelemetryManager(this.apiId).setNativeBrokerErrorCode(e.errorCode),jm(e)))throw e}this.browserStorage.setTemporaryCache(Sh,JSON.stringify(n),!0);const i={apiId:Eh,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(a,i)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const r=this.browserStorage.getCachedNativeRequest();if(!r)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&e?.addFields({errorCode:"no_cached_request"},t),null;const{prompt:n,...o}=r;n&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Sh));const i={method:ph,request:o},a=rl();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const e=await this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(e);const t=this.handleNativeResponse(e,o,a),r=await t;return this.initializeServerTelemetryManager(this.apiId).clearNativeBrokerErrorCode(),r}catch(e){throw e}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Zm.reject("Logout not implemented yet")}async handleNativeResponse(e,t,r){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const n=el(e.id_token,Gp),o=this.createHomeAccountIdentifier(e,n),i=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId})?.homeAccountId;if(t.extraParameters?.child_client_id&&e.account.id!==t.accountId)this.logger.info("handleNativeServerResponse: Double broker flow detected, ignoring accountId mismatch");else if(o!==i&&e.account.id!==t.accountId)throw zm(Fm);const a=await this.getDiscoveredAuthority({requestAuthority:t.authority}),s=Rm(this.browserStorage,a,o,Gp,n,e.client_info,void 0,n.tid,void 0,e.account.id,this.logger);e.expires_in=Number(e.expires_in);const c=await this.generateAuthenticationResult(e,t,n,s,a.canonicalAuthority,r);return await this.cacheAccount(s),await this.cacheNativeTokens(e,t,o,n,e.access_token,c.tenantId,r),c}createHomeAccountIdentifier(e,t){return Zl.generateHomeAccountId(e.client_info||bs.EMPTY_STRING,0,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?Wl.fromString(e.scope):Wl.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType===Ws.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const r=new _m(this.browserCrypto),n={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw Qc(Uc);return r.signPopToken(e.access_token,t.keyId,n)}return e.access_token}async generateAuthenticationResult(e,t,r,n,o,i){const a=this.addTelemetryFromNativeResponse(e),s=e.scope?Wl.fromString(e.scope):Wl.fromString(t.scope),c=e.account.properties||{},l=c.UID||r.oid||r.sub||bs.EMPTY_STRING,u=c.TenantId||r.tid||bs.EMPTY_STRING,d=Jl(n.getAccountInfo(),void 0,r,e.id_token);d.nativeAccountId!==e.account.id&&(d.nativeAccountId=e.account.id);const h=await this.generatePopAccessToken(e,t),p=t.tokenType===Ws.POP?Ws.POP:Ws.BEARER;return{authority:o,uniqueId:l,tenantId:u,scopes:s.asArray(),account:d,idToken:e.id_token,idTokenClaims:r,accessToken:h,fromCache:!!a&&this.isResponseFromCache(a),expiresOn:ol(i+e.expires_in),tokenType:p,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}async cacheAccount(e){await this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e).catch((e=>{this.logger.error(`Error occurred while removing account context from browser storage. ${e}`)}))}cacheNativeTokens(e,t,r,n,o,i,a){const s=sl(r,t.authority,e.id_token||"",t.clientId,n.tid||""),c=a+(t.tokenType===Ws.POP?bs.SHR_NONCE_VALIDITY:("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),l=this.generateScopes(e,t),u={idToken:s,accessToken:cl(r,t.authority,o,t.clientId,n.tid||i,l.printScopes(),c,0,Gp,void 0,t.tokenType,void 0,t.keyId)};return this.nativeStorageManager.saveCacheRecord(u,this.correlationId,t.storeInCache)}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw nc(Zs,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(e){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return void 0===e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const r=new nu(t);r.validateAsUri();const{scopes:n,...o}=e,i=new Wl(n||[]);i.appendScopes(ws);const a={...o,accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:i.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:(()=>{switch(this.apiId){case 863:case 61:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),Os.NONE}if(e.prompt)switch(e.prompt){case Os.NONE:case Os.CONSENT:case Os.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),qp(Pp)}else this.logger.trace("initializeNativeRequest: prompt was not provided")})(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(a.signPopToken&&e.popKid)throw qp(Op);if(this.handleExtraBrokerParams(a),a.extraParameters=a.extraParameters||{},a.extraParameters.telemetry="MATS",e.authenticationScheme===Ws.POP){const t={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},r=new _m(this.browserCrypto);let n;if(a.keyId)n=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:a.keyId})),a.signPopToken=!1;else{const o=await Yf(r.generateCnf.bind(r),Cd,this.logger,this.performanceClient,e.correlationId)(t,this.logger);n=o.reqCnfString,a.keyId=o.kid,a.signPopToken=!0}a.reqCnf=n}return this.addRequestSKUs(a),a}handleExtraBrokerParams(e){const t=e.extraParameters&&e.extraParameters.hasOwnProperty(Vg)&&e.extraParameters.hasOwnProperty(Yg)&&e.extraParameters.hasOwnProperty(Ug);if(!e.embeddedClientId&&!t)return;let r="";const n=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,r=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[Yg],r=e.extraParameters[Ug]),e.extraParameters={child_client_id:r,child_redirect_uri:n},this.performanceClient?.addFields({embeddedClientId:r,embeddedRedirectUri:n},e.correlationId)}}async function ty(e,t,r,n,o){const i=function(e,t,r,n){const o=t.correlationId,i=new Map;if(em(i,t.embeddedClientId||t.extraQueryParameters?.[Ug]||e.clientId),Zg(i,[...t.scopes||[],...t.extraScopesToConsent||[]],!0,e.authority.options.OIDCOptions?.defaultScopes),tm(i,t.redirectUri),sm(i,o),function(e,t){e.set("response_mode",t||"query")}(i,t.responseMode),gm(i),t.prompt&&(function(e,t){e.set("prompt",t)}(i,t.prompt),n?.addFields({prompt:t.prompt},o)),t.domainHint&&(function(e,t){e.set("domain_hint",t)}(i,t.domainHint),n?.addFields({domainHintFromRequest:!0},o)),t.prompt!==Os.SELECT_ACCOUNT)if(t.sid&&t.prompt===Os.NONE)r.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),im(i,t.sid),n?.addFields({sidFromRequest:!0},o);else if(t.account){const e=(a=t.account,a.idTokenClaims?.sid||null);let s=function(e){return e.idTokenClaims?.login_hint||null}(t.account);if(s&&t.domainHint&&(r.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),s=null),s){r.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),rm(i,s),n?.addFields({loginHintFromClaim:!0},o);try{om(i,Vl(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e&&t.prompt===Os.NONE){r.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),im(i,e),n?.addFields({sidFromClaim:!0},o);try{om(i,Vl(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)r.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),rm(i,t.loginHint),nm(i,t.loginHint),n?.addFields({loginHintFromRequest:!0},o);else if(t.account.username){r.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),rm(i,t.account.username),n?.addFields({loginHintFromUpn:!0},o);try{om(i,Vl(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(r.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),rm(i,t.loginHint),nm(i,t.loginHint),n?.addFields({loginHintFromRequest:!0},o));else r.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");var a;return t.nonce&&function(e,t){e.set("nonce",t)}(i,t.nonce),t.state&&um(i,t.state),(t.claims||e.clientCapabilities&&e.clientCapabilities.length>0)&&am(i,t.claims,e.clientCapabilities),t.embeddedClientId&&Am(i,e.clientId,e.redirectUri),!e.instanceAware||t.extraQueryParameters&&Object.keys(t.extraQueryParameters).includes(Qg)||mm(i),i}({...e.auth,authority:t},r,n,o);if(cm(i,{sku:lh,version:Mf,os:"",cpu:""}),e.auth.protocolMode!==Qs&&lm(i,e.telemetry.application),r.platformBroker&&(function(e){e.set("nativebroker","1")}(i),r.authenticationScheme===Ws.POP)){const e=new Wf(n,o),t=new _m(e);let a;a=r.popKid?e.encodeKid(r.popKid):(await Yf(t.generateCnf.bind(t),Cd,n,o,r.correlationId)(r,n)).reqCnfString,vm(i,a)}return Jg(i,r.correlationId,o),i}async function ry(e,t,r,n,o){if(!r.codeChallenge)throw zl(Rl);const i=await Yf(ty,"getStandardParams",n,o,r.correlationId)(e,t,r,n,o);return Xg(i,"code"),function(e,t,r){if(!t||!r)throw zl(Rl);e.set("code_challenge",t),e.set("code_challenge_method",r)}(i,r.codeChallenge,bs.S256_CODE_CHALLENGE_METHOD),ym(i,r.extraQueryParameters||{}),Vm(t,i,e.auth.encodeExtraQueryParams,r.extraQueryParameters)}async function ny(e,t,r,n,o,i){if(!n.earJwk)throw qp(Dh);const a=await ty(t,r,n,o,i);Xg(a,"id_token token refresh_token"),function(e,t){e.set("ear_jwk",encodeURIComponent(t)),e.set("ear_jwe_crypto","eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}(a,n.earJwk);const s=new Map;return ym(s,n.extraQueryParameters||{}),function(e,t,r){const n=e.createElement("form");return n.method="post",n.action=t,r.forEach(((t,r)=>{const o=e.createElement("input");o.hidden=!0,o.name=r,o.value=t,n.appendChild(o)})),e.body.appendChild(n),n}(e,Vm(r,s,t.auth.encodeExtraQueryParams,n.extraQueryParameters),a)}async function oy(e,t,r,n,o,i,a,s,c,l){if(!l)throw qp(_p);const u=new Wf(s,c),d=new ey(n,o,u,s,a,n.system.navigationClient,r,c,l,t,i,e.correlationId),{userRequestState:h}=xm.parseRequestState(u,e.state);return Yf(d.acquireToken.bind(d),Fu,s,c,e.correlationId)({...e,state:h,prompt:void 0})}async function iy(e,t,r,n,o,i,a,s,c,l,u,d){if(Tm.removeThrottle(a,o.auth.clientId,e),t.accountId)return Yf(oy,gd,l,u,e.correlationId)(e,t.accountId,n,o,a,s,c,l,u,d);const h={...e,code:t.code||"",codeVerifier:r},p=new Qm(i,a,h,l,u);return await Yf(p.handleCodeResponse.bind(p),pd,l,u,e.correlationId)(t,e)}async function ay(e,t,r,n,o,i,a,s,c,l,u){if(Tm.removeThrottle(i,n.auth.clientId,e),Ym(t,e.state),!t.ear_jwe)throw qp(Uh);if(!e.earJwk)throw qp(Dh);const d=JSON.parse(await Yf(hf,nh,c,l,e.correlationId)(e.earJwk,t.ear_jwe));if(d.accountId)return Yf(oy,gd,c,l,e.correlationId)(e,d.accountId,r,n,i,a,s,c,l,u);const h=new Pm(n.auth.clientId,i,new Wf(c,l),c,null,null,l);h.validateTokenResponse(d);const p={code:"",state:e.state,nonce:e.nonce,client_info:d.client_info,cloud_graph_host_name:d.cloud_graph_host_name,cloud_instance_host_name:d.cloud_instance_host_name,cloud_instance_name:d.cloud_instance_name,msgraph_host:d.msgraph_host};return await Yf(h.handleServerTokenResponse.bind(h),kd,c,l,e.correlationId)(d,o,rl(),e,p,void 0,void 0,void 0,void 0)}async function sy(e,t,r){e.addQueueMeasurement(Kd,r);const n=Vf(cy,Wd,t,e,r)(e,t,r);return{verifier:n,challenge:await Yf(ly,Gd,t,e,r)(n,e,t,r)}}function cy(e,t,r){try{const n=new Uint8Array(32);return Vf(sf,Yd,t,e,r)(n),zp(n)}catch(e){throw qp(Fh)}}async function ly(e,t,r,n){t.addQueueMeasurement(Gd,n);try{const o=await Yf(af,Vd,r,t,n)(e,t,n);return zp(new Uint8Array(o))}catch(e){throw qp(Fh)}}var uy=r(64583).Promise;class dy extends qm{constructor(e,t,r,n,o,i,a,s,c,l){super(e,t,r,n,o,i,a,c,l),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=s,this.eventHandler=o}acquireToken(e,t){try{const r={popupName:this.generatePopupName(e.scopes||ws,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,r,t)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),r.popup=this.openSizedPopup("about:blank",r),this.acquireTokenPopupAsync(e,r,t))}catch(e){return uy.reject(e)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:e?.popupWindowAttributes||{},popupWindowParent:e?.popupWindowParent??window},n=e&&e.authority,o=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,n,o)):(this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(t,r,n,o))}catch(e){return uy.reject(e)}}async acquireTokenPopupAsync(e,t,r){this.logger.verbose("acquireTokenPopupAsync called");const n=await Yf(this.initializeAuthorizationRequest.bind(this),ud,this.logger,this.performanceClient,this.correlationId)(e,Rh.Popup);t.popup&&Of(n.authority);const o=Wm.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);return n.platformBroker=o,this.config.auth.protocolMode===Js?this.executeEarFlow(n,t):this.executeCodeFlow(n,t,r)}async executeCodeFlow(e,t,r){const n=e.correlationId,o=this.initializeServerTelemetryManager(Ph),i=r||await Yf(sy,Kd,this.logger,this.performanceClient,n)(this.performanceClient,this.logger,n),a={...e,codeChallenge:i.challenge};try{const r=await Yf(this.createAuthCodeClient.bind(this),cd,this.logger,this.performanceClient,n)({serverTelemetryManager:o,requestAuthority:a.authority,requestAzureCloudOptions:a.azureCloudOptions,requestExtraQueryParameters:a.extraQueryParameters,account:a.account}),s=await Yf(ry,dd,this.logger,this.performanceClient,n)(this.config,r.authority,a,this.logger,this.performanceClient),c=this.initiateAuthRequest(s,t);this.eventHandler.emitEvent(Rg,Rh.Popup,{popupWindow:c},null);const l=await this.monitorPopupForHash(c,t.popupWindowParent),u=Vf(Gm,Sd,this.logger,this.performanceClient,this.correlationId)(l,this.config.auth.OIDCOptions.serverResponseType,this.logger);return await Yf(iy,md,this.logger,this.performanceClient,n)(e,u,i.verifier,Ph,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}catch(e){throw t.popup?.close(),e instanceof rc&&(e.setCorrelationId(this.correlationId),o.cacheFailedRequest(e)),e}}async executeEarFlow(e,t){const r=e.correlationId,n=await Yf(this.getDiscoveredAuthority.bind(this),qu,this.logger,this.performanceClient,r)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),o=await Yf(df,rh,this.logger,this.performanceClient,r)(),i={...e,earJwk:o},a=t.popup||this.openPopup("about:blank",t);(await ny(a.document,this.config,n,i,this.logger,this.performanceClient)).submit();const s=await Yf(this.monitorPopupForHash.bind(this),id,this.logger,this.performanceClient,r)(a,t.popupWindowParent),c=Vf(Gm,Sd,this.logger,this.performanceClient,this.correlationId)(s,this.config.auth.OIDCOptions.serverResponseType,this.logger);return Yf(ay,fd,this.logger,this.performanceClient,r)(i,c,Ph,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}async logoutPopupAsync(e,t,r,n){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(Og,Rh.Popup,e);const o=this.initializeServerTelemetryManager(962);try{await this.clearCacheOnLogout(e.account);const i=await Yf(this.createAuthCodeClient.bind(this),cd,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:o,requestAuthority:r,account:e.account||void 0});try{i.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId&&e.postLogoutRedirectUri&&i.authority.protocolMode===Qs){if(this.browserStorage.removeAccount(e.account?.homeAccountId),this.eventHandler.emitEvent(Mg,Rh.Popup,e),n){const e={apiId:962,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=nu.getAbsoluteUrl(n,xf());await this.navigationClient.navigateInternal(t,e)}return void t.popup?.close()}}const a=i.getLogoutUri(e);this.eventHandler.emitEvent(Mg,Rh.Popup,e);const s=this.openPopup(a,t);if(this.eventHandler.emitEvent(Rg,Rh.Popup,{popupWindow:s},null),await this.monitorPopupForHash(s,t.popupWindowParent).catch((()=>{})),n){const e={apiId:962,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=nu.getAbsoluteUrl(n,xf());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${t}`),await this.navigationClient.navigateInternal(t,e)}else this.logger.verbose("No main window navigation requested")}catch(e){throw t.popup?.close(),e instanceof rc&&(e.setCorrelationId(this.correlationId),o.cacheFailedRequest(e)),this.eventHandler.emitEvent(Ng,Rh.Popup,null,e),this.eventHandler.emitEvent(Bg,Rh.Popup),e}this.eventHandler.emitEvent(Bg,Rh.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),qp(zh)}monitorPopupForHash(e,t){return new uy(((t,r)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const n=setInterval((()=>{if(e.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(n),void r(qp(Zh));let o="";try{o=e.location.href}catch(e){}if(!o||"about:blank"===o)return;clearInterval(n);let i="";const a=this.config.auth.OIDCOptions.serverResponseType;e&&(i=a===Ns?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(i)}),this.config.system.pollIntervalMilliseconds)})).finally((()=>{this.cleanPopup(e,t)}))}openPopup(e,t){try{let r;if(t.popup?(r=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),r.location.assign(e)):void 0===t.popup&&(this.logger.verbosePii(`Opening popup window to: ${e}`),r=this.openSizedPopup(e,t)),!r)throw qp(Xh);return r.focus&&r.focus(),this.currentWindow=r,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),r}catch(e){throw this.logger.error("error opening popup "+e.message),qp(Jh)}}openSizedPopup(e,{popupName:t,popupWindowAttributes:r,popupWindowParent:n}){const o=n.screenLeft?n.screenLeft:n.screenX,i=n.screenTop?n.screenTop:n.screenY,a=n.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=n.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let c=r.popupSize?.width,l=r.popupSize?.height,u=r.popupPosition?.top,d=r.popupPosition?.left;return(!c||c<0||c>a)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),c=483),(!l||l<0||l>s)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),l=600),(!u||u<0||u>s)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),u=Math.max(0,s/2-300+i)),(!d||d<0||d>a)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),d=Math.max(0,a/2-241.5+o)),n.open(e,t,`width=${c}, height=${l}, top=${u}, left=${d}, scrollbars=yes`)}unloadWindow(e){this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow)}generatePopupName(e,t){return`${ch}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${ch}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}class hy extends qm{constructor(e,t,r,n,o,i,a,s,c,l){super(e,t,r,n,o,i,a,c,l),this.nativeStorage=s}async acquireToken(e){const t=await Yf(this.initializeAuthorizationRequest.bind(this),ud,this.logger,this.performanceClient,this.correlationId)(e,Rh.Redirect);t.platformBroker=Wm.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);const r=e=>{e.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.resetRequestCache(),this.eventHandler.emitEvent("msal:restoreFromBFCache",Rh.Redirect))},n=this.getRedirectStartPage(e.redirectStartPage);this.logger.verbosePii(`Redirect start page: ${n}`),this.browserStorage.setTemporaryCache(bh,n,!0),window.addEventListener("pageshow",r);try{this.config.auth.protocolMode===Js?await this.executeEarFlow(t):await this.executeCodeFlow(t,e.onRedirectNavigate)}catch(e){throw e instanceof rc&&e.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",r),e}}async executeCodeFlow(e,t){const r=e.correlationId,n=this.initializeServerTelemetryManager(Eh),o=await Yf(sy,Kd,this.logger,this.performanceClient,r)(this.performanceClient,this.logger,r),i={...e,codeChallenge:o.challenge};this.browserStorage.cacheAuthorizeRequest(i,o.verifier);try{const r=await Yf(this.createAuthCodeClient.bind(this),cd,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:i.authority,requestAzureCloudOptions:i.azureCloudOptions,requestExtraQueryParameters:i.extraQueryParameters,account:i.account}),o=await Yf(ry,dd,this.logger,this.performanceClient,e.correlationId)(this.config,r.authority,i,this.logger,this.performanceClient);return await this.initiateAuthRequest(o,t)}catch(e){throw e instanceof rc&&(e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e)),e}}async executeEarFlow(e){const t=e.correlationId,r=await Yf(this.getDiscoveredAuthority.bind(this),qu,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),n=await Yf(df,rh,this.logger,this.performanceClient,t)(),o={...e,earJwk:n};this.browserStorage.cacheAuthorizeRequest(o),(await ny(document,this.config,r,o,this.logger,this.performanceClient)).submit()}async handleRedirectPromise(e="",t,r,n){const o=this.initializeServerTelemetryManager(865);try{const[i,a]=this.getRedirectResponse(e||"");if(!i)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.resetRequestCache(),"back_forward"!==function(){if("undefined"==typeof window||void 0===window.performance||"function"!=typeof window.performance.getEntriesByType)return;const e=window.performance.getEntriesByType("navigation"),t=e.length?e[0]:void 0;return t?.type}()?n.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const s=this.browserStorage.getTemporaryCache(bh,!0)||bs.EMPTY_STRING;if(nu.removeHashFromUrl(s)===nu.removeHashFromUrl(window.location.href)&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),s.indexOf("#")>-1&&function(e){const t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""}(s),await this.handleResponse(i,t,r,o);if(!this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(i,t,r,o);if(!If()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(wh,a,!0);const e={apiId:865,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let n=!0;if(s&&"null"!==s)this.logger.verbose(`Navigating to loginRequestUrl: ${s}`),n=await this.navigationClient.navigateInternal(s,e);else{const t=function(){const e=new nu(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}();this.browserStorage.setTemporaryCache(bh,t,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),n=await this.navigationClient.navigateInternal(t,e)}if(!n)return await this.handleResponse(i,t,r,o)}return null}catch(e){throw e instanceof rc&&(e.setCorrelationId(this.correlationId),o.cacheFailedRequest(e)),e}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(t=this.config.auth.OIDCOptions.serverResponseType===Ns?window.location.search:window.location.hash);let r=tu(t);if(r){try{!function(e,t,r){if(!e.state)throw qp(Wh);const n=function(e,t){if(!t)return null;try{return xm.parseRequestState(e,t).libraryState.meta}catch(e){throw Qc(hc)}}(t,e.state);if(!n)throw qp(Vh);if(n.interactionType!==r)throw qp(Yh)}(r,this.browserCrypto,Rh.Redirect)}catch(e){return e instanceof rc&&this.logger.error(`Interaction type validation failed due to ${e.errorCode}: ${e.errorMessage}`),[null,""]}return Tf(window),this.logger.verbose("Hash contains known properties, returning response hash"),[r,t]}const n=this.browserStorage.getTemporaryCache(wh,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(wh)),n&&(r=tu(n),r)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[r,n]):[null,""]}async handleResponse(e,t,r,n){if(!e.state)throw qp(Wh);if(e.ear_jwe){const r=await Yf(this.getDiscoveredAuthority.bind(this),qu,this.logger,this.performanceClient,t.correlationId)({requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account});return Yf(ay,fd,this.logger,this.performanceClient,t.correlationId)(t,e,Eh,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}const o=await Yf(this.createAuthCodeClient.bind(this),cd,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority});return Yf(iy,md,this.logger,this.performanceClient,t.correlationId)(t,e,r,Eh,this.config,o,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const r={apiId:Eh,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},n=t||this.config.auth.onRedirectNavigate;return"function"==typeof n?(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1!==n(e)?(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void await this.navigationClient.navigateExternal(e,r)):void this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void await this.navigationClient.navigateExternal(e,r))}throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),qp(zh)}async logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(961);try{this.eventHandler.emitEvent(Og,Rh.Redirect,e),await this.clearCacheOnLogout(t.account);const n={apiId:961,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=await Yf(this.createAuthCodeClient.bind(this),cd,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:e&&e.authority,requestExtraQueryParameters:e?.extraQueryParameters,account:e&&e.account||void 0});if(o.authority.protocolMode===Qs)try{o.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId)return this.browserStorage.removeAccount(t.account?.homeAccountId),void this.eventHandler.emitEvent(Mg,Rh.Redirect,t)}const i=o.getLogoutUri(t);if(this.eventHandler.emitEvent(Mg,Rh.Redirect,t),!e||"function"!=typeof e.onRedirectNavigate)return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,vh),void await this.navigationClient.navigateExternal(i,n);if(!1!==e.onRedirectNavigate(i))return this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,vh),void await this.navigationClient.navigateExternal(i,n);this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(e){throw e instanceof rc&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),this.eventHandler.emitEvent(Ng,Rh.Redirect,null,e),this.eventHandler.emitEvent(Bg,Rh.Redirect),e}this.eventHandler.emitEvent(Bg,Rh.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return nu.getAbsoluteUrl(t,xf())}}var py=r(64583).Promise;async function fy(e,t,r,n,o){if(t.addQueueMeasurement(od,n),!e)throw r.info("Navigate url is empty"),qp(zh);return o?Yf(yy,ad,r,t,n)(e,o,t,n):Vf(vy,sd,r,t,n)(e)}async function gy(e,t,r,n,o){const i=by();if(!i.contentDocument)throw"No document associated with iframe!";return(await ny(i.contentDocument,e,t,r,n,o)).submit(),i}async function my(e,t,r,n,o,i,a){return n.addQueueMeasurement(id,i),new py(((n,i)=>{t<1e4&&o.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${t}ms) than the default (10000ms). This may result in timeouts.`);const s=window.setTimeout((()=>{window.clearInterval(c),i(qp(tp))}),t),c=window.setInterval((()=>{let t="";const r=e.contentWindow;try{t=r?r.location.href:""}catch(e){}if(!t||"about:blank"===t)return;let o="";r&&(o=a===Ns?r.location.search:r.location.hash),window.clearTimeout(s),window.clearInterval(c),n(o)}),r)})).finally((()=>{Vf(wy,qd,o,n,i)(e)}))}function yy(e,t,r,n){return r.addQueueMeasurement(ad,n),new py(((r,n)=>{const o=by();window.setTimeout((()=>{o?(o.src=e,r(o)):n("Unable to load iframe")}),t)}))}function vy(e){const t=by();return t.src=e,t}function by(){const e=document.createElement("iframe");return e.className="msalSilentIframe",e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(e),e}function wy(e){document.body===e.parentNode&&document.body.removeChild(e)}var Cy=r(64583).Promise;class Ay extends qm{constructor(e,t,r,n,o,i,a,s,c,l,u){super(e,t,r,n,o,i,s,l,u),this.apiId=a,this.nativeStorage=c}async acquireToken(e){this.performanceClient.addQueueMeasurement(Lu,e.correlationId),e.loginHint||e.sid||e.account&&e.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t={...e};t.prompt?t.prompt!==Os.NONE&&t.prompt!==Os.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${Os.NONE}`),t.prompt=Os.NONE):t.prompt=Os.NONE;const r=await Yf(this.initializeAuthorizationRequest.bind(this),ud,this.logger,this.performanceClient,e.correlationId)(t,Rh.Silent);return r.platformBroker=Wm.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,r.authenticationScheme),Of(r.authority),this.config.auth.protocolMode===Js?this.executeEarFlow(r):this.executeCodeFlow(r)}async executeCodeFlow(e){let t;const r=this.initializeServerTelemetryManager(this.apiId);try{return t=await Yf(this.createAuthCodeClient.bind(this),cd,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),await Yf(this.silentTokenHelper.bind(this),nd,this.logger,this.performanceClient,e.correlationId)(t,e)}catch(n){if(n instanceof rc&&(n.setCorrelationId(this.correlationId),r.cacheFailedRequest(n)),!(t&&n instanceof rc&&n.errorCode===sh))throw n;return this.performanceClient.addFields({retryError:n.errorCode},this.correlationId),await Yf(this.silentTokenHelper.bind(this),nd,this.logger,this.performanceClient,this.correlationId)(t,e)}}async executeEarFlow(e){const t=e.correlationId,r=await Yf(this.getDiscoveredAuthority.bind(this),qu,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),n=await Yf(df,rh,this.logger,this.performanceClient,t)(),o={...e,earJwk:n},i=await Yf(gy,od,this.logger,this.performanceClient,t)(this.config,r,o,this.logger,this.performanceClient),a=this.config.auth.OIDCOptions.serverResponseType,s=await Yf(my,id,this.logger,this.performanceClient,t)(i,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,t,a),c=Vf(Gm,Sd,this.logger,this.performanceClient,t)(s,a,this.logger);return Yf(ay,fd,this.logger,this.performanceClient,t)(o,c,this.apiId,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}logout(){return Cy.reject(qp(ap))}async silentTokenHelper(e,t){const r=t.correlationId;this.performanceClient.addQueueMeasurement(nd,r);const n=await Yf(sy,Kd,this.logger,this.performanceClient,r)(this.performanceClient,this.logger,r),o={...t,codeChallenge:n.challenge},i=await Yf(ry,dd,this.logger,this.performanceClient,r)(this.config,e.authority,o,this.logger,this.performanceClient),a=await Yf(fy,od,this.logger,this.performanceClient,r)(i,this.performanceClient,this.logger,r,this.config.system.navigateFrameWait),s=this.config.auth.OIDCOptions.serverResponseType,c=await Yf(my,id,this.logger,this.performanceClient,r)(a,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,r,s),l=Vf(Gm,Sd,this.logger,this.performanceClient,r)(c,s,this.logger);return Yf(iy,md,this.logger,this.performanceClient,r)(t,l,n.verifier,this.apiId,this.config,e,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}}class ky extends Im{constructor(e,t){super(e,t)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(Ku,e.correlationId);const t=rl(),r=await Yf(this.executeTokenRequest.bind(this),zu,this.logger,this.performanceClient,e.correlationId)(e,this.authority),n=r.headers?.[Ts],o=new Pm(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(r.body),Yf(o.handleServerTokenResponse.bind(o),kd,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,n)}async acquireTokenByRefreshToken(e){if(!e)throw zl(_l);if(this.performanceClient?.addQueueMeasurement(Gu,e.correlationId),!e.account)throw Qc(_c);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await Yf(this.acquireTokenWithCachedRefreshToken.bind(this),Wu,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(t){const r=t instanceof ag&&t.errorCode===Zf,n=t instanceof Sm&&"invalid_grant"===t.errorCode&&"client_mismatch"===t.subError;if(r||n)return Yf(this.acquireTokenWithCachedRefreshToken.bind(this),Wu,this.logger,this.performanceClient,e.correlationId)(e,!1);throw t}return Yf(this.acquireTokenWithCachedRefreshToken.bind(this),Wu,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){this.performanceClient?.addQueueMeasurement(Wu,e.correlationId);const r=Vf(this.cacheManager.getRefreshToken.bind(this.cacheManager),Dd,this.logger,this.performanceClient,e.correlationId)(e.account,t,void 0,this.performanceClient,e.correlationId);if(!r)throw cg(Zf);if(r.expiresOn&&il(r.expiresOn,e.refreshTokenExpirationOffsetSeconds||300))throw this.performanceClient?.addFields({rtExpiresOnMs:Number(r.expiresOn)},e.correlationId),cg(tg);const n={...e,refreshToken:r.secret,authenticationScheme:e.authenticationScheme||Ws.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Fg}};try{return await Yf(this.acquireToken.bind(this),Ku,this.logger,this.performanceClient,e.correlationId)(n)}catch(t){if(t instanceof ag&&(this.performanceClient?.addFields({rtExpiresOnMs:Number(r.expiresOn)},e.correlationId),t.subError===rg)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const e=al(r);this.cacheManager.removeRefreshToken(e)}throw t}}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(zu,e.correlationId);const r=this.createTokenQueryParameters(e),n=nu.appendQueryString(t.tokenEndpoint,r),o=await Yf(this.createTokenRequestBody.bind(this),Vu,this.logger,this.performanceClient,e.correlationId)(e),i=this.createTokenRequestHeaders(e.ccsCredential),a=lg(this.config.authOptions.clientId,e);return Yf(this.executePostToTokenEndpoint.bind(this),Uu,this.logger,this.performanceClient,e.correlationId)(n,o,i,a,e.correlationId,Uu)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(Vu,e.correlationId);const t=new Map;if(em(t,e.embeddedClientId||e.tokenBodyParameters?.[Ug]||this.config.authOptions.clientId),e.redirectUri&&tm(t,e.redirectUri),Zg(t,e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),fm(t,"refresh_token"),gm(t),cm(t,this.config.libraryInfo),lm(t,this.config.telemetry.application),Cm(t),this.serverTelemetryManager&&!Su(this.config)&&wm(t,this.serverTelemetryManager),function(e,t){e.set("refresh_token",t)}(t,e.refreshToken),this.config.clientCredentials.clientSecret&&dm(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const r=this.config.clientCredentials.clientAssertion;hm(t,await Mm(r.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),pm(t,r.assertionType)}if(e.authenticationScheme===Ws.POP){const r=new _m(this.cryptoUtils,this.performanceClient);let n;n=e.popKid?this.cryptoUtils.encodeKid(e.popKid):(await Yf(r.generateCnf.bind(r),Cd,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,vm(t,n)}else if(e.authenticationScheme===Ws.SSH){if(!e.sshJwk)throw zl(Bl);bm(t,e.sshJwk)}if((!Kl.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&am(t,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Fg:try{om(t,Vl(e.ccsCredential.credential))}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Dg:nm(t,e.ccsCredential.credential)}return e.embeddedClientId&&Am(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&ym(t,e.tokenBodyParameters),Jg(t,e.correlationId,this.performanceClient),ru(t)}}var Sy=r(64583).Promise;class Ty extends qm{async acquireToken(e){this.performanceClient.addQueueMeasurement(Hu,e.correlationId);const t=await Yf(Hm,Zu,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),r={...e,...t};e.redirectUri&&(r.redirectUri=this.getRedirectUri(e.redirectUri));const n=this.initializeServerTelemetryManager(61),o=await this.createRefreshTokenClient({serverTelemetryManager:n,authorityUrl:r.authority,azureCloudOptions:r.azureCloudOptions,account:r.account});return Yf(o.acquireTokenByRefreshToken.bind(o),Gu,this.logger,this.performanceClient,e.correlationId)(r).catch((e=>{throw e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e),e}))}logout(){return Sy.reject(qp(ap))}async createRefreshTokenClient(e){const t=await Yf(this.getClientConfiguration.bind(this),ld,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new ky(t,this.performanceClient)}}class Iy{constructor(e,t,r,n){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}async loadExternalTokens(e,t,r){if(!this.isBrowserEnvironment)throw qp(pp);const n=e.correlationId||lf(),o=t.id_token?el(t.id_token,Gp):void 0,i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=e.authority?new Jf(Jf.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,i,this.logger,e.correlationId||lf()):void 0,s=await this.loadAccount(e,r.clientInfo||t.client_info||"",n,o,a),c=await this.loadIdToken(t,s.homeAccountId,s.environment,s.realm,n),l=await this.loadAccessToken(e,t,s.homeAccountId,s.environment,s.realm,r,n),u=await this.loadRefreshToken(t,s.homeAccountId,s.environment,n);return this.generateAuthenticationResult(e,{account:s,idToken:c,accessToken:l,refreshToken:u},o,a)}async loadAccount(e,t,r,n,o){if(this.logger.verbose("TokenCache - loading account"),e.account){const t=Zl.createFromAccountInfo(e.account);return await this.storage.setAccount(t,r),t}if(!o||!t&&!n)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),qp(bp);const i=Zl.generateHomeAccountId(t,o.authorityType,this.logger,this.cryptoObj,n),a=n?.tid,s=Rm(this.storage,o,i,Gp,n,t,o.hostnameAndPort,a,void 0,void 0,this.logger);return await this.storage.setAccount(s,r),s}async loadIdToken(e,t,r,n,o){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const i=sl(t,r,e.id_token,this.config.auth.clientId,n);return await this.storage.setIdTokenCredential(i,o),i}async loadAccessToken(e,t,r,n,o,i,a){if(!t.access_token)return this.logger.verbose("TokenCache - no access token found in response"),null;if(!t.expires_in)return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;if(!(t.scope||e.scopes&&e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null;this.logger.verbose("TokenCache - loading access token");const s=t.scope?Wl.fromString(t.scope):new Wl(e.scopes),c=i.expiresOn||t.expires_in+rl(),l=i.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+rl(),u=cl(r,n,t.access_token,this.config.auth.clientId,o,s.printScopes(),c,l,Gp);return await this.storage.setAccessTokenCredential(u,a),u}async loadRefreshToken(e,t,r,n){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const o=ll(t,r,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return await this.storage.setRefreshTokenCredential(o,n),o}generateAuthenticationResult(e,t,r,n){let o,i="",a=[],s=null;t?.accessToken&&(i=t.accessToken.secret,a=Wl.fromString(t.accessToken.target).asArray(),s=ol(t.accessToken.expiresOn),o=ol(t.accessToken.extendedExpiresOn));const c=t.account;return{authority:n?n.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:a,account:c.getAccountInfo(),idToken:t.idToken?.secret||"",idTokenClaims:r||{},accessToken:i,fromCache:!0,expiresOn:s,correlationId:e.correlationId||"",requestId:"",extExpiresOn:o,familyId:t.refreshToken?.familyId||"",tokenType:t?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:c.cloudGraphHostName||"",msGraphHost:c.msGraphHost||"",fromNativeBroker:!1}}}class xy extends Nm{constructor(e){super(e),this.includeRedirectUri=!1}}var _y=r(64583).Promise;class Ey extends qm{constructor(e,t,r,n,o,i,a,s,c,l){super(e,t,r,n,o,i,s,c,l),this.apiId=a}async acquireToken(e){if(!e.code)throw qp(Cp);const t=await Yf(this.initializeAuthorizationRequest.bind(this),ud,this.logger,this.performanceClient,e.correlationId)(e,Rh.Silent),r=this.initializeServerTelemetryManager(this.apiId);try{const n={...t,code:e.code},o=await Yf(this.getClientConfiguration.bind(this),ld,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),i=new xy(o);this.logger.verbose("Auth code client created");const a=new Qm(i,this.browserStorage,n,this.logger,this.performanceClient);return await Yf(a.handleCodeResponseFromServer.bind(a),hd,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(e){throw e instanceof rc&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),e}}logout(){return _y.reject(qp(ap))}}var Py=r(64583).Promise;function Ry(e){const t=e?.idTokenClaims;return t?.tfp||t?.acr?"B2C":t?.tid?"9188040d-6c67-4c5b-b112-36a304b66dad"===t?.tid?"MSA":"AAD":void 0}function Oy(e,t){try{Pf(e)}catch(e){throw t.end({success:!1},e),e}}class My{constructor(e){var t,r,n,o;this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new Wf(this.logger,this.performanceClient):Jc,this.eventHandler=new qg(this.logger),this.browserStorage=this.isBrowserEnvironment?new Hg(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,function(e){const t=e.cloudDiscoveryMetadata;let r;if(t)try{r=JSON.parse(t)}catch(e){throw zl(Ol)}return{canonicalAuthority:e.authority?Xf(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:r}}(this.config.auth)):(t=this.config.auth.clientId,r=this.logger,n=this.performanceClient,o=this.eventHandler,new Hg(t,{cacheLocation:mh,temporaryCacheLocation:mh,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},Jc,r,n,o));const i={cacheLocation:mh,temporaryCacheLocation:mh,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new Hg(this.config.auth.clientId,i,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new Iy(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e,t){const r=new My(e);return await r.initialize(t),r}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e,t){if(this.logger.trace("initialize called"),this.initialized)return void this.logger.info("initialize has already been called, exiting early.");if(!this.isBrowserEnvironment)return this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,void this.eventHandler.emitEvent(bg);const r=e?.correlationId||this.getRequestCorrelationId(),n=this.config.system.allowPlatformBroker,o=this.performanceClient.startMeasurement(td,r);if(this.eventHandler.emitEvent("msal:initializeStart"),!t)try{this.logMultipleInstances(o)}catch{}if(await Yf(this.browserStorage.initialize.bind(this.browserStorage),rd,this.logger,this.performanceClient,r)(r),n)try{this.nativeExtensionProvider=await Wm.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(e){this.logger.verbose(e)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await Yf(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),Fd,this.logger,this.performanceClient,r)(this.performanceClient,r)),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(r),this.initialized=!0,this.eventHandler.emitEvent(bg),o.end({allowPlatformBroker:n,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),Ef(this.initialized),this.isBrowserEnvironment){const t=e||"";let r=this.redirectResponse.get(t);return void 0===r?(r=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,r),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),r}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const t=this.browserStorage.getInteractionInProgress()?.type;if(t===vh)return this.logger.verbose("handleRedirectPromise removing interaction_in_progress flag and returning null after sign-out"),this.browserStorage.setInteractionInProgress(!1),Py.resolve(null);const r=this.getAllAccounts(),n=this.browserStorage.getCachedNativeRequest(),o=n&&Wm.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e;let i,a;this.eventHandler.emitEvent("msal:handleRedirectStart",Rh.Redirect);try{if(o&&this.nativeExtensionProvider){i=this.performanceClient.startMeasurement(Ou,n?.correlationId||""),this.logger.trace("handleRedirectPromise - acquiring token from native platform");const e=new ey(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,865,this.performanceClient,this.nativeExtensionProvider,n.accountId,this.nativeInternalStorage,n.correlationId);a=Yf(e.handleRedirectPromise.bind(e),Hd,this.logger,this.performanceClient,i.event.correlationId)(this.performanceClient,i.event.correlationId)}else{const[t,r]=this.browserStorage.getCachedRequest(),n=t.correlationId;i=this.performanceClient.startMeasurement(Ou,n),this.logger.trace("handleRedirectPromise - acquiring token from web flow");const o=this.createRedirectClient(n);a=Yf(o.handleRedirectPromise.bind(o),Ld,this.logger,this.performanceClient,i.event.correlationId)(e,t,r,i)}}catch(e){throw this.browserStorage.resetRequestCache(),e}return a.then((e=>(e?(this.browserStorage.resetRequestCache(),r.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(Sg,Rh.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(xg,Rh.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),i.end({success:!0,accountType:Ry(e.account)})):i.event.errorCode?i.end({success:!1}):i.discard(),this.eventHandler.emitEvent(Pg,Rh.Redirect),e))).catch((e=>{this.browserStorage.resetRequestCache();const t=e;throw r.length>0?this.eventHandler.emitEvent(_g,Rh.Redirect,null,t):this.eventHandler.emitEvent(Tg,Rh.Redirect,null,t),this.eventHandler.emitEvent(Pg,Rh.Redirect),i.end({success:!1},t),e}))}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const r=this.performanceClient.startMeasurement("acquireTokenPreRedirect",t);r.add({accountType:Ry(e.account),scenarioId:e.scenarioId});const n=e.onRedirectNavigate;if(n)e.onRedirectNavigate=e=>{const t="function"==typeof n?n(e):void 0;return!1!==t?r.end({success:!0}):r.discard(),t};else{const e=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=t=>{const n="function"==typeof e?e(t):void 0;return!1!==n?r.end({success:!0}):r.discard(),n}}const o=this.getAllAccounts().length>0;try{let n;return Rf(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,yh),o?this.eventHandler.emitEvent(Ig,Rh.Redirect,e):this.eventHandler.emitEvent(kg,Rh.Redirect,e),n=this.nativeExtensionProvider&&this.canUsePlatformBroker(e)?new ey(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Eh,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,r).catch((r=>{if(r instanceof Um&&jm(r))return this.nativeExtensionProvider=void 0,this.createRedirectClient(t).acquireToken(e);if(r instanceof ag)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t).acquireToken(e);throw r})):this.createRedirectClient(t).acquireToken(e),await n}catch(e){throw this.browserStorage.resetRequestCache(),r.end({success:!1},e),o?this.eventHandler.emitEvent(_g,Rh.Redirect,null,e):this.eventHandler.emitEvent(Tg,Rh.Redirect,null,e),e}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(Ru,t);r.add({scenarioId:e.scenarioId,accountType:Ry(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),Oy(this.initialized,r),this.browserStorage.setInteractionInProgress(!0,yh)}catch(e){return Py.reject(e)}const n=this.getAllAccounts();let o;n.length>0?this.eventHandler.emitEvent(Ig,Rh.Popup,e):this.eventHandler.emitEvent(kg,Rh.Popup,e);const i=this.getPreGeneratedPkceCodes(t);return o=this.canUsePlatformBroker(e)?this.acquireTokenNative({...e,correlationId:t},Ph).then((e=>(r.end({success:!0,isNativeBroker:!0,accountType:Ry(e.account)}),e))).catch((r=>{if(r instanceof Um&&jm(r))return this.nativeExtensionProvider=void 0,this.createPopupClient(t).acquireToken(e,i);if(r instanceof ag)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t).acquireToken(e,i);throw r})):this.createPopupClient(t).acquireToken(e,i),o.then((e=>(n.length<this.getAllAccounts().length?this.eventHandler.emitEvent(Sg,Rh.Popup,e):this.eventHandler.emitEvent(xg,Rh.Popup,e),r.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:Ry(e.account)}),e))).catch((e=>(n.length>0?this.eventHandler.emitEvent(_g,Rh.Popup,null,e):this.eventHandler.emitEvent(Tg,Rh.Popup,null,e),r.end({success:!1},e),Py.reject(e)))).finally((async()=>{this.browserStorage.setInteractionInProgress(!1),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(t)}))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){const t=this.getRequestCorrelationId(e),r={...e,prompt:e.prompt,correlationId:t};let n;return this.ssoSilentMeasurement=this.performanceClient.startMeasurement($u,t),this.ssoSilentMeasurement?.add({scenarioId:e.scenarioId,accountType:Ry(e.account)}),Oy(this.initialized,this.ssoSilentMeasurement),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent("msal:ssoSilentStart",Rh.Silent,r),n=this.canUsePlatformBroker(r)?this.acquireTokenNative(r,863).catch((e=>{if(e instanceof Um&&jm(e))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(r.correlationId).acquireToken(r);throw e})):this.createSilentIframeClient(r.correlationId).acquireToken(r),n.then((e=>(this.eventHandler.emitEvent("msal:ssoSilentSuccess",Rh.Silent,e),this.ssoSilentMeasurement?.end({success:!0,isNativeBroker:e.fromNativeBroker,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:Ry(e.account)}),e))).catch((e=>{throw this.eventHandler.emitEvent("msal:ssoSilentFailure",Rh.Silent,null,e),this.ssoSilentMeasurement?.end({success:!1},e),e})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)}))}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const r=this.performanceClient.startMeasurement(xu,t);Oy(this.initialized,r),this.eventHandler.emitEvent("msal:acquireTokenByCodeStart",Rh.Silent,e),r.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw qp(kp);if(e.code){const n=e.code;let o=this.hybridAuthCodeResponses.get(n);return o?(this.logger.verbose("Existing acquireTokenByCode request found",t),r.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),o=this.acquireTokenByCodeAsync({...e,correlationId:t}).then((e=>(this.eventHandler.emitEvent("msal:acquireTokenByCodeSuccess",Rh.Silent,e),this.hybridAuthCodeResponses.delete(n),r.end({success:!0,isNativeBroker:e.fromNativeBroker,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:Ry(e.account)}),e))).catch((e=>{throw this.hybridAuthCodeResponses.delete(n),this.eventHandler.emitEvent(Eg,Rh.Silent,null,e),r.end({success:!1},e),e})),this.hybridAuthCodeResponses.set(n,o)),await o}if(e.nativeAccountId){if(this.canUsePlatformBroker(e,e.nativeAccountId)){const n=await this.acquireTokenNative({...e,correlationId:t},866,e.nativeAccountId).catch((e=>{throw e instanceof Um&&jm(e)&&(this.nativeExtensionProvider=void 0),e}));return r.end({accountType:Ry(n.account),success:!0}),n}throw qp(Tp)}throw qp(Ap)}catch(e){throw this.eventHandler.emitEvent(Eg,Rh.Silent,null,e),r.end({success:!1},e),e}}async acquireTokenByCodeAsync(e){this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(Bd,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement);const t=this.createSilentAuthCodeClient(e.correlationId);return await t.acquireToken(e).then((e=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker}),e))).catch((e=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},e),e})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)}))}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(Yu,e.correlationId),t){case 0:case 1:case 2:const t=this.createSilentCacheClient(e.correlationId);return Yf(t.acquireToken.bind(t),Bu,this.logger,this.performanceClient,e.correlationId)(e);default:throw Qc(Lc)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(_u,e.correlationId),t){case 0:case 2:case 3:case 4:const t=this.createSilentRefreshClient(e.correlationId);return Yf(t.acquireToken.bind(t),Hu,this.logger,this.performanceClient,e.correlationId)(e);default:throw Qc(Lc)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(Xu,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return Yf(t.acquireToken.bind(t),Lu,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);return Rf(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,vh),this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);return Pf(this.initialized),this.browserStorage.setInteractionInProgress(!0,vh),this.createPopupClient(t).logout(e).finally((()=>{this.browserStorage.setInteractionInProgress(!1)}))}catch(e){return Py.reject(e)}}async clearCache(e){if(!this.isBrowserEnvironment)return void this.logger.info("in non-browser environment, returning early.");const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){return function(e,t,r,n){return e.verbose("getAllAccounts called"),r?t.getAllAccounts(n):[]}(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}getAccount(e){return function(e,t,r){if(t.trace("getAccount called"),0===Object.keys(e).length)return t.warning("getAccount: No accountFilter provided"),null;const n=r.getAccountInfoFilteredBy(e);return n?(t.verbose("getAccount: Account matching provided filter found, returning"),n):(t.verbose("getAccount: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage)}getAccountByUsername(e){return function(e,t,r){if(t.trace("getAccountByUsername called"),!e)return t.warning("getAccountByUsername: No username provided"),null;const n=r.getAccountInfoFilteredBy({username:e});return n?(t.verbose("getAccountByUsername: Account matching username found, returning"),t.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${e}`),n):(t.verbose("getAccountByUsername: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return function(e,t,r){if(t.trace("getAccountByHomeId called"),!e)return t.warning("getAccountByHomeId: No homeAccountId provided"),null;const n=r.getAccountInfoFilteredBy({homeAccountId:e});return n?(t.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),t.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${e}`),n):(t.verbose("getAccountByHomeId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return function(e,t,r){if(t.trace("getAccountByLocalId called"),!e)return t.warning("getAccountByLocalId: No localAccountId provided"),null;const n=r.getAccountInfoFilteredBy({localAccountId:e});return n?(t.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),t.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${e}`),n):(t.verbose("getAccountByLocalId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage)}setActiveAccount(e){!function(e,t){t.setActiveAccount(e)}(e,this.browserStorage)}getActiveAccount(){return this.browserStorage.getActiveAccount()}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const r=Zl.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(r,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,r,n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw qp(_p);return new ey(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e,n)}canUsePlatformBroker(e,t){if(this.logger.trace("canUsePlatformBroker called"),!Wm.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isPlatformBrokerAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case Os.NONE:case Os.CONSENT:case Os.LOGIN:this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace(`canUsePlatformBroker: prompt = ${e.prompt} is not compatible with platform broker flow, returning false`),!1}return!(!t&&!this.getNativeAccountId(e)&&(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),1))}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new dy(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new hy(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new Ay(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,863,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new Xm(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new Ty(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new Ey(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,866,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return _f(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){this.config.cache.cacheLocation===fh?this.eventHandler.subscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}disableAccountStorageEvents(){this.config.cache.cacheLocation===fh?this.eventHandler.unsubscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?lf():bs.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||Oh})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||Oh})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(Eu,t);r.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),Oy(this.initialized,r),this.logger.verbose("acquireTokenSilent called",t);const n=e.account||this.getActiveAccount();if(!n)throw qp(sp);return r.add({accountType:Ry(n)}),this.acquireTokenSilentDeduped(e,n,t).then((n=>(r.end({success:!0,fromCache:n.fromCache,isNativeBroker:n.fromNativeBroker,accessTokenSize:n.accessToken.length,idTokenSize:n.idToken.length}),{...n,state:e.state,correlationId:t}))).catch((e=>{throw e instanceof rc&&e.setCorrelationId(t),r.end({success:!1},e),e}))}async acquireTokenSilentDeduped(e,t,r){const n=lg(this.config.auth.clientId,{...e,authority:e.authority||this.config.auth.authority,correlationId:r},t.homeAccountId),o=JSON.stringify(n),i=this.activeSilentTokenRequests.get(o);if(void 0===i){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",r),this.performanceClient.addFields({deduped:!1},r);const n=Yf(this.acquireTokenSilentAsync.bind(this),Pu,this.logger,this.performanceClient,r)({...e,correlationId:r},t);return this.activeSilentTokenRequests.set(o,n),n.finally((()=>{this.activeSilentTokenRequests.delete(o)}))}return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",r),this.performanceClient.addFields({deduped:!0},r),i}async acquireTokenSilentAsync(e,t){const r=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(Pu,e.correlationId),this.eventHandler.emitEvent(Ig,Rh.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",r);const n=await Yf($m,ed,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),o=e.cacheLookupPolicy||0;return this.acquireTokenSilentNoIframe(n,o).catch((async e=>{const t=function(e,t){const r=!(e instanceof ag&&e.subError!==rg),n=e.errorCode===sh||e.errorCode===Lc,o=r&&n||e.errorCode===Zf||e.errorCode===tg,i=Bh.includes(t);return o&&i}(e,o);if(t){if(this.activeIframeRequest){if(5!==o){const[t,r]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${r}`,n.correlationId);const i=this.performanceClient.startMeasurement("awaitConcurrentIframe",n.correlationId);i.add({awaitIframeCorrelationId:r});const a=await t;if(i.end({success:a}),a)return this.logger.verbose(`Parallel iframe request with correlationId: ${r} succeeded. Retrying cache and/or RT redemption`,n.correlationId),this.acquireTokenSilentNoIframe(n,o);throw this.logger.info(`Iframe request with correlationId: ${r} failed. Interaction is required.`),e}return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",n.correlationId),Yf(this.acquireTokenBySilentIframe.bind(this),Xu,this.logger,this.performanceClient,n.correlationId)(n)}{let e;return this.activeIframeRequest=[new Py((t=>{e=t})),n.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",n.correlationId),Yf(this.acquireTokenBySilentIframe.bind(this),Xu,this.logger,this.performanceClient,n.correlationId)(n).then((t=>(e(!0),t))).catch((t=>{throw e(!1),t})).finally((()=>{this.activeIframeRequest=void 0}))}}throw e})).then((t=>(this.eventHandler.emitEvent(xg,Rh.Silent,t),e.correlationId&&this.performanceClient.addFields({fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker},e.correlationId),t))).catch((e=>{throw this.eventHandler.emitEvent(_g,Rh.Silent,null,e),e})).finally((()=>{document.removeEventListener("visibilitychange",r)}))}async acquireTokenSilentNoIframe(e,t){return Wm.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,61,e.account.nativeAccountId,t).catch((async e=>{if(e instanceof Um&&jm(e))throw this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,Qc(Lc);throw e}))):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),1===t&&this.logger.verbose("acquireTokenSilent - cache lookup policy set to AccessToken, attempting to acquire token from local cache"),Yf(this.acquireTokenFromCache.bind(this),Yu,this.logger,this.performanceClient,e.correlationId)(e,t).catch((r=>{if(1===t)throw r;return this.eventHandler.emitEvent("msal:acquireTokenFromNetworkStart",Rh.Silent,e),Yf(this.acquireTokenByRefreshToken.bind(this),_u,this.logger,this.performanceClient,e.correlationId)(e,t)})))}async preGeneratePkceCodes(e){return this.logger.verbose("Generating new PKCE codes"),this.pkceCode=await Yf(sy,Kd,this.logger,this.performanceClient,e)(this.performanceClient,this.logger,e),Py.resolve()}getPreGeneratedPkceCodes(e){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");const t=this.pkceCode?{...this.pkceCode}:void 0;return this.pkceCode=void 0,this.logger.verbose((t?"Found":"Did not find")+" pre-generated PKCE codes"),this.performanceClient.addFields({usePreGeneratedPkce:!!t},e),t}logMultipleInstances(e){const t=this.config.auth.clientId;window&&(window.msal=window.msal||{},window.msal.clientIds=window.msal.clientIds||[],window.msal.clientIds.length>0&&this.logger.verbose("There is already an instance of MSAL.js in the window."),window.msal.clientIds.push(t),function(e,t,r){const n=window.msal?.clientIds||[],o=n.length,i=n.filter((t=>t===e)).length;i>1&&r.warning("There is already an instance of MSAL.js in the window with the same client id."),t.add({msalInstanceCount:o,sameClientIdInstanceCount:i})}(t,e,this.logger))}}r(64583).Promise;class Ny{static async createPublicClientApplication(e){const t=await async function(e){const t=new Bf(e);return await t.initialize(),My.createController(t,void 0)}(e);return new Ny(e,t)}constructor(e,t){this.isBroker=!1,this.controller=t||new My(new Bf(e))}async initialize(e){return this.controller.initialize(e,this.isBroker)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}var By={scopes:["User.Read","Mail.Read","Mail.ReadWrite","Mail.ReadWrite.Shared"]},Ly=new Ny({auth:{clientId:"4c0186de-19ee-4e7d-9fca-6b8170498c61",authority:"https://login.microsoftonline.com/common",redirectUri:"https://codewithabubakr.github.io/phish-addin/assets/redirect.html"},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!0}});Ly.initialize().then((function(){console.log("MSAL Initialized")}));var Hy=Ly,$y=r(64583).Promise,qy=function(){return qy=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},qy.apply(this,arguments)},Fy=function(e,t,r,n){return new(r||(r=$y))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Dy=function(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Uy=r(64583).Promise,jy=function(){var e=V(),t=(0,n.useState)(!1),r=t[0],o=t[1],i=(0,n.useState)(null),a=(i[0],i[1]),s=(0,n.useState)(null),c=(s[0],s[1]);return(0,n.useEffect)((function(){localStorage.getItem("access_token")&&e("/phishing")})),n.createElement(n.Fragment,null,r&&n.createElement(vs,null),n.createElement(zi,{id:"bias-report-home",sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",marginTop:"12px",gap:"6px"}},n.createElement("img",{src:"/assets/logo-filled.png",alt:"This is a Phish",style:{maxWidth:"100px",height:"100px"}}),n.createElement(ta,{sx:{textAlign:"center",paddingLeft:"8px",paddingRight:"8px"}},hs.description)),n.createElement(zi,{alignItems:"center",justifyContent:"center",mt:2},n.createElement(ds,{onClick:function(){return t=void 0,r=void 0,i=function(){var t,r,n;return function(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,(function(i){switch(i.label){case 0:o(!0),i.label=1;case 1:return i.trys.push([1,4,5,6]),[4,Fy(void 0,void 0,void 0,(function(){var e;return Dy(this,(function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,Hy.initialize()];case 1:return t.sent(),[4,Hy.loginPopup(By)];case 2:return[2,t.sent().account];case 3:throw e=t.sent(),console.error("Login failed:",e),e;case 4:return[2]}}))}))];case 2:return t=i.sent(),a(t),[4,Fy(void 0,void 0,void 0,(function(){var e,t;return Dy(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,5]),[4,Hy.initialize()];case 1:if(r.sent(),0===(e=Hy.getAllAccounts()).length)throw new Error("No user account found");return[4,Hy.acquireTokenSilent(qy(qy({},By),{account:e[0]}))];case 2:return[2,r.sent().accessToken];case 3:return t=r.sent(),console.warn("Silent token acquisition failed, trying popup login",t),[4,Hy.acquireTokenPopup(By).then((function(e){return e.accessToken}))];case 4:return[2,r.sent()];case 5:return[2]}}))}))];case 3:return r=i.sent(),c(r),localStorage.setItem("access_token",r),console.log("Access Token:",r),e("/phishing"),[3,6];case 4:return n=i.sent(),console.error("Login error:",n),o(!1),[3,6];case 5:return o(!1),[7];case 6:return[2]}}))},new((n=void 0)||(n=Uy))((function(e,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(a,s)}c((i=i.apply(t,r||[])).next())}));var t,r,n,i},variant:"contained",sx:{display:"flex",alignItems:"center",gap:1,backgroundColor:"white",borderRadius:"6px",color:"black",boxShadow:2,textTransform:"none",fontSize:"0.875rem",fontWeight:500,px:3,py:1,"&:hover":{backgroundColor:"gray.200"}}},n.createElement("img",{src:"/assets/microsoft.png",alt:"Microsoft",height:16,width:16}),n.createElement("span",null,hs.login_with_microsoft))))};function zy(){const e=Jn(Hi);return e[$i]||e}function Ky(e){return We("MuiPaper",e)}Yi("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const Wy=Fi("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[r.variant],!r.square&&t.rounded,"elevation"===r.variant&&t[`elevation${r.elevation}`]]}})(Wi((({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,color:(e.vars||e).palette.text.primary,transition:e.transitions.create("box-shadow"),variants:[{props:({ownerState:e})=>!e.square,style:{borderRadius:e.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(e.vars||e).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))));var Gy=n.forwardRef((function(e,t){const r=Ui({props:e,name:"MuiPaper"}),n=zy(),{className:o,component:i="div",elevation:a=1,square:s=!1,variant:c="elevation",...l}=r,u={...r,component:i,elevation:a,square:s,variant:c},d=(e=>{const{square:t,elevation:r,variant:n,classes:o}=e;return Ge({root:["root",n,!t&&"rounded","elevation"===n&&`elevation${r}`]},Ky,o)})(u);return(0,Zn.jsx)(Wy,{as:i,ownerState:u,className:$e(d.root,o),ref:t,...l,style:{..."elevation"===c&&{"--Paper-shadow":(n.vars||n).shadows[a],...n.vars&&{"--Paper-overlay":n.vars.overlays?.[a]},...!n.vars&&"dark"===n.palette.mode&&{"--Paper-overlay":`linear-gradient(${po("#fff",ki(a))}, ${po("#fff",ki(a))})`}},...l.style}})}));function Vy(e){return We("MuiCard",e)}Yi("MuiCard",["root"]);const Yy=Fi(Gy,{name:"MuiCard",slot:"Root"})({overflow:"hidden"});var Qy=n.forwardRef((function(e,t){const r=Ui({props:e,name:"MuiCard"}),{className:n,raised:o=!1,...i}=r,a={...r,raised:o},s=(e=>{const{classes:t}=e;return Ge({root:["root"]},Vy,t)})(a);return(0,Zn.jsx)(Yy,{className:$e(s.root,n),elevation:o?8:void 0,ref:t,ownerState:a,...i})}));function Jy(e){return We("MuiCardContent",e)}Yi("MuiCardContent",["root"]);const Xy=Fi("div",{name:"MuiCardContent",slot:"Root"})({padding:16,"&:last-child":{paddingBottom:24}});var Zy,ev=n.forwardRef((function(e,t){const r=Ui({props:e,name:"MuiCardContent"}),{className:n,component:o="div",...i}=r,a={...r,component:o},s=(e=>{const{classes:t}=e;return Ge({root:["root"]},Jy,t)})(a);return(0,Zn.jsx)(Xy,{as:o,className:$e(s.root,n),ownerState:a,ref:t,...i})})),tv={companyId:"",OtherPhishingTargetEmails:"",OtherPhishingSubject:"Phishing Report: {subject}",OtherPhishingBody:"User Email: {userEmail}\nDate: {date}\nSubject: {subject}\nSender: {sender}"},rv=function(){return rv=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},rv.apply(this,arguments)},nv=function(){function e(e){this.options=e,this.listeners={}}return e.prototype.on=function(e,t){var r=this.listeners[e]||[];this.listeners[e]=r.concat([t])},e.prototype.triggerEvent=function(e,t){var r=this;(this.listeners[e]||[]).forEach((function(e){return e({target:r,event:t})}))},e}();!function(e){e[e.Add=0]="Add",e[e.Remove=1]="Remove"}(Zy||(Zy={}));var ov,iv=function(){function e(){this.notifications=[]}return e.prototype.push=function(e){this.notifications.push(e),this.updateFn(e,Zy.Add,this.notifications)},e.prototype.splice=function(e,t){var r=this.notifications.splice(e,t)[0];return this.updateFn(r,Zy.Remove,this.notifications),r},e.prototype.indexOf=function(e){return this.notifications.indexOf(e)},e.prototype.onUpdate=function(e){this.updateFn=e},e}();!function(e){e.Dismiss="dismiss",e.Click="click"}(ov||(ov={}));var av={types:[{type:"success",className:"notyf__toast--success",backgroundColor:"#3dc763",icon:{className:"notyf__icon--success",tagName:"i"}},{type:"error",className:"notyf__toast--error",backgroundColor:"#ed3d3d",icon:{className:"notyf__icon--error",tagName:"i"}}],duration:2e3,ripple:!0,position:{x:"right",y:"bottom"},dismissible:!1},sv=function(){function e(){this.notifications=[],this.events={},this.X_POSITION_FLEX_MAP={left:"flex-start",center:"center",right:"flex-end"},this.Y_POSITION_FLEX_MAP={top:"flex-start",center:"center",bottom:"flex-end"};var e=document.createDocumentFragment(),t=this._createHTMLElement({tagName:"div",className:"notyf"});e.appendChild(t),document.body.appendChild(e),this.container=t,this.animationEndEventName=this._getAnimationEndEventName(),this._createA11yContainer()}return e.prototype.on=function(e,t){var r;this.events=rv(rv({},this.events),((r={})[e]=t,r))},e.prototype.update=function(e,t){t===Zy.Add?this.addNotification(e):t===Zy.Remove&&this.removeNotification(e)},e.prototype.removeNotification=function(e){var t,r,n=this,o=this._popRenderedNotification(e);o&&((t=o.node).classList.add("notyf__toast--disappear"),t.addEventListener(this.animationEndEventName,r=function(e){e.target===t&&(t.removeEventListener(n.animationEndEventName,r),n.container.removeChild(t))}))},e.prototype.addNotification=function(e){var t=this._renderNotification(e);this.notifications.push({notification:e,node:t}),this._announce(e.options.message||"Notification")},e.prototype._renderNotification=function(e){var t,r=this._buildNotificationCard(e),n=e.options.className;return n&&(t=r.classList).add.apply(t,n.split(" ")),this.container.appendChild(r),r},e.prototype._popRenderedNotification=function(e){for(var t=-1,r=0;r<this.notifications.length&&t<0;r++)this.notifications[r].notification===e&&(t=r);if(-1!==t)return this.notifications.splice(t,1)[0]},e.prototype.getXPosition=function(e){var t;return(null===(t=null==e?void 0:e.position)||void 0===t?void 0:t.x)||"right"},e.prototype.getYPosition=function(e){var t;return(null===(t=null==e?void 0:e.position)||void 0===t?void 0:t.y)||"bottom"},e.prototype.adjustContainerAlignment=function(e){var t=this.X_POSITION_FLEX_MAP[this.getXPosition(e)],r=this.Y_POSITION_FLEX_MAP[this.getYPosition(e)],n=this.container.style;n.setProperty("justify-content",r),n.setProperty("align-items",t)},e.prototype._buildNotificationCard=function(e){var t=this,r=e.options,n=r.icon;this.adjustContainerAlignment(r);var o=this._createHTMLElement({tagName:"div",className:"notyf__toast"}),i=this._createHTMLElement({tagName:"div",className:"notyf__ripple"}),a=this._createHTMLElement({tagName:"div",className:"notyf__wrapper"}),s=this._createHTMLElement({tagName:"div",className:"notyf__message"});s.innerHTML=r.message||"";var c=r.background||r.backgroundColor;if(n){var l=this._createHTMLElement({tagName:"div",className:"notyf__icon"});if(("string"==typeof n||n instanceof String)&&(l.innerHTML=new String(n).valueOf()),"object"==typeof n){var u=n.tagName,d=void 0===u?"i":u,h=n.className,p=n.text,f=n.color,g=void 0===f?c:f,m=this._createHTMLElement({tagName:d,className:h,text:p});g&&(m.style.color=g),l.appendChild(m)}a.appendChild(l)}if(a.appendChild(s),o.appendChild(a),c&&(r.ripple?(i.style.background=c,o.appendChild(i)):o.style.background=c),r.dismissible){var y=this._createHTMLElement({tagName:"div",className:"notyf__dismiss"}),v=this._createHTMLElement({tagName:"button",className:"notyf__dismiss-btn"});y.appendChild(v),a.appendChild(y),o.classList.add("notyf__toast--dismissible"),v.addEventListener("click",(function(r){var n,o;null===(o=(n=t.events)[ov.Dismiss])||void 0===o||o.call(n,{target:e,event:r}),r.stopPropagation()}))}o.addEventListener("click",(function(r){var n,o;return null===(o=(n=t.events)[ov.Click])||void 0===o?void 0:o.call(n,{target:e,event:r})}));var b="top"===this.getYPosition(r)?"upper":"lower";return o.classList.add("notyf__toast--"+b),o},e.prototype._createHTMLElement=function(e){var t=e.tagName,r=e.className,n=e.text,o=document.createElement(t);return r&&(o.className=r),o.textContent=n||null,o},e.prototype._createA11yContainer=function(){var e=this._createHTMLElement({tagName:"div",className:"notyf-announcer"});e.setAttribute("aria-atomic","true"),e.setAttribute("aria-live","polite"),e.style.border="0",e.style.clip="rect(0 0 0 0)",e.style.height="1px",e.style.margin="-1px",e.style.overflow="hidden",e.style.padding="0",e.style.position="absolute",e.style.width="1px",e.style.outline="0",document.body.appendChild(e),this.a11yContainer=e},e.prototype._announce=function(e){var t=this;this.a11yContainer.textContent="",setTimeout((function(){t.a11yContainer.textContent=e}),100)},e.prototype._getAnimationEndEventName=function(){var e,t=document.createElement("_fake"),r={MozTransition:"animationend",OTransition:"oAnimationEnd",WebkitTransition:"webkitAnimationEnd",transition:"animationend"};for(e in r)if(void 0!==t.style[e])return r[e];return"animationend"},e}(),cv=function(){function e(e){var t=this;this.dismiss=this._removeNotification,this.notifications=new iv,this.view=new sv;var r=this.registerTypes(e);this.options=rv(rv({},av),e),this.options.types=r,this.notifications.onUpdate((function(e,r){return t.view.update(e,r)})),this.view.on(ov.Dismiss,(function(e){var r=e.target,n=e.event;t._removeNotification(r),r.triggerEvent(ov.Dismiss,n)})),this.view.on(ov.Click,(function(e){var t=e.target,r=e.event;return t.triggerEvent(ov.Click,r)}))}return e.prototype.error=function(e){var t=this.normalizeOptions("error",e);return this.open(t)},e.prototype.success=function(e){var t=this.normalizeOptions("success",e);return this.open(t)},e.prototype.open=function(e){var t=this.options.types.find((function(t){return t.type===e.type}))||{},r=rv(rv({},t),e);this.assignProps(["ripple","position","dismissible"],r);var n=new nv(r);return this._pushNotification(n),n},e.prototype.dismissAll=function(){for(;this.notifications.splice(0,1););},e.prototype.assignProps=function(e,t){var r=this;e.forEach((function(e){t[e]=null==t[e]?r.options[e]:t[e]}))},e.prototype._pushNotification=function(e){var t=this;this.notifications.push(e);var r=void 0!==e.options.duration?e.options.duration:this.options.duration;r&&setTimeout((function(){return t._removeNotification(e)}),r)},e.prototype._removeNotification=function(e){var t=this.notifications.indexOf(e);-1!==t&&this.notifications.splice(t,1)},e.prototype.normalizeOptions=function(e,t){var r={type:e};return"string"==typeof t?r.message=t:"object"==typeof t&&(r=rv(rv({},r),t)),r},e.prototype.registerTypes=function(e){var t=(e&&e.types||[]).slice();return av.types.map((function(e){var r=-1;t.forEach((function(t,n){t.type===e.type&&(r=n)}));var n=-1!==r?t.splice(r,1)[0]:{};return rv(rv({},e),n)})).concat(t)},e}(),lv=r(85072),uv=r.n(lv),dv=r(97825),hv=r.n(dv),pv=r(77659),fv=r.n(pv),gv=r(55056),mv=r.n(gv),yv=r(10540),vv=r.n(yv),bv=r(41113),wv=r.n(bv),Cv=r(96674),Av={};Av.styleTagTransform=wv(),Av.setAttributes=mv(),Av.insert=fv().bind(null,"head"),Av.domAPI=hv(),Av.insertStyleElement=vv(),uv()(Cv.A,Av),Cv.A&&Cv.A.locals&&Cv.A.locals;var kv=new cv({duration:3e3,position:{x:"right",y:"bottom"},types:[{type:"success",background:"#0D9D58"},{type:"error",background:"#dc2626"}]}),Sv=r(64583).Promise,Tv=function(e,t,r){return n=void 0,o=void 0,a=function(){var n,o;return function(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,fetch("https://graph.microsoft.com/v1.0/me/messages/".concat(t),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}})];case 1:return i.sent().ok?(r(null,{success:!0}),[3,3]):(n=new Error("Failed to delete email"),r(n,null),[2]);case 2:return o=i.sent(),console.error("Error deleting email:",o),r(o,null),[3,3];case 3:return[2]}}))},new((i=void 0)||(i=Sv))((function(e,t){function r(e){try{c(a.next(e))}catch(e){t(e)}}function s(e){try{c(a.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(r,s)}c((a=a.apply(n,o||[])).next())}));var n,o,i,a},Iv=r(64583).Promise,xv=function(){return xv=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},xv.apply(this,arguments)},_v=function(e,t,r,n){return new(r||(r=Iv))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Ev=function(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Pv=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},Rv=function(){var e=V(),t=window.Office.context.mailbox.item,r=window.Office.context.mailbox.item.dateTimeCreated,o=new Date(r).toLocaleString("en-US",{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0});(0,n.useEffect)((function(){var e=window.Office.context.mailbox.userProfile.emailAddress,t=e.substring(e.lastIndexOf("@")+1);console.log(t)}),[]);var i=function(e){return _v(void 0,void 0,void 0,(function(){var t,r,n;return Ev(this,(function(o){if(!e)return[2,{campaignId:null,templateId:null,userId:null}];try{return t=e.match(/X-PHISHBAIT4:\s*(\d+)/i),r=e.match(/X-PHISHBAIT2:\s*(\d+)/i),n=e.match(/X-PHISHBAIT3:\s*(\d+)/i),[2,{campaignId:t&&t[1]?t[1]:null,templateId:r&&r[1]?r[1]:null,userId:n&&n[1]?n[1]:null}]}catch(e){return[2,{campaignId:null,templateId:null,userId:null}]}}))}))};function a(e){return _v(this,void 0,void 0,(function(){var t,r;return Ev(this,(function(n){switch(n.label){case 0:n.label=1;case 1:return n.trys.push([1,6,,7]),t=null,"function"!=typeof e.getAllInternetHeadersAsync?[3,3]:[4,new Iv((function(t){return e.getAllInternetHeadersAsync(t)}))];case 2:(r=n.sent()).status===Office.AsyncResultStatus.Succeeded&&r.value&&(t=r.value),n.label=3;case 3:return t||"function"!=typeof e.getHeadersAsync?[3,5]:[4,new Iv((function(t){return e.getHeadersAsync(t)}))];case 4:(r=n.sent()).status===Office.AsyncResultStatus.Succeeded&&r.value&&(t=r.value),n.label=5;case 5:return t||(t=e.headers||null),[2,t];case 6:return n.sent(),[2,null];case 7:return[2]}}))}))}window.headerExtractor={extractPhishBaitValues:i,getEmailHeaders:a};var s=function(e){return _v(void 0,void 0,void 0,(function(){var t,r;return Ev(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,fetch("https://baitandphish.com/API/getConfigByDomain.php?domain=".concat(encodeURIComponent(e)))];case 1:if(!(t=n.sent()).ok)throw new Error("Failed to fetch config");return[4,t.json()];case 2:if(!(r=n.sent()).success||!r.config)throw new Error("Invalid config format");return[2,xv(xv(xv({},tv),r.config),{OtherPhishingTargetEmails:r.config.OtherPhishingTargetEmails||"security@".concat(e)})];case 3:return n.sent(),[2,xv(xv({},tv),{OtherPhishingTargetEmails:"security@".concat(e)})];case 4:return[2]}}))}))},c=function(e,t,r,n){return _v(void 0,void 0,void 0,(function(){var o,a,s,c,l,d;return Ev(this,(function(h){switch(h.label){case 0:return h.trys.push([0,4,,6]),[4,i(n||"")];case 1:return o=h.sent(),console.log("Extracted PhishBait values for report:",o),a={companyId:r.companyId,employeeId:t,emailId:e.itemId||"",subject:e.subject||"",sender:(null===(d=e.sender)||void 0===d?void 0:d.emailAddress)||"",campaignId:(null==o?void 0:o.campaignId)||null,templateId:(null==o?void 0:o.templateId)||null,userId:(null==o?void 0:o.userId)||null},[4,fetch("https://baitandphish.com/API/phishReport.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})];case 2:if(!(s=h.sent()).ok)throw new Error("Server error");return s.ok&&kv.success("Great job! You correctly identified a simulated phishing email."),[4,s.json()];case 3:if(!(c=h.sent()).success)throw new Error(c.message||"Server returned error");return[3,6];case 4:return l=h.sent(),kv.error(l),[4,u(e,t,r,!1)];case 5:return h.sent(),[3,6];case 6:return[2]}}))}))},l=function(e,t,r,n,o){for(var i=[],a=5;a<arguments.length;a++)i[a-5]=arguments[a];return _v(void 0,Pv([e,t,r,n,o],i,!0),void 0,(function(e,t,r,n,o,i){return void 0===i&&(i=!1),Ev(this,(function(a){return[2,new Iv((function(a,s){try{var c=function(e,t){var r=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),n='\n        <div style="background-color: #fff4ce; border-left: 4px solid #ffd700; padding: 10px; margin-bottom: 20px;">\n            <p style="margin: 0; font-weight: bold; color: #7a6400;">IMPORTANT: Please click send on this message</p>\n            <p style="margin: 10px 0 0 0; color: #7a6400;">\n                The correct emails to send phishing reports to have been automatically added for you. \n                The original email has also automatically been attached and we have included the email headers below for analysis. \n                Thank you.\n            </p>\n        </div>\n        <div style="margin-bottom: 20px; white-space: pre-wrap; word-wrap: break-word;">\n            '.concat(r.replace(/\n/g,"<br>"),"\n        </div>\n    ");if(t){var o=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");n+='\n            <div style="background-color: #f5f5f5; border: 1px solid #ddd; padding: 10px; margin-top: 20px;">\n                <p style="margin: 0 0 10px 0; font-weight: bold; color: #333;">Email Headers (For Analysis):</p>\n                <pre style="margin: 0; white-space: pre-wrap; word-wrap: break-word; font-family: monospace; font-size: 12px; color: #666;">'.concat(o,"</pre>\n            </div>\n        ")}return n}(n,o),l={toRecipients:t,subject:r,htmlBody:c};if(e.itemId&&(l.attachments=[{type:Office.MailboxEnums.AttachmentType.Item,name:"Original Email.msg",itemId:e.itemId}]),!i&&Office.MailboxEnums&&Office.MailboxEnums.DisplayMode)try{l.displayMode=Office.MailboxEnums.DisplayMode.NewWindow}catch(e){console.warn("Could not set display mode:",e)}try{window.Office.context.mailbox.displayNewMessageForm(l,(function(e){e.status===Office.AsyncResultStatus.Succeeded?a(e):e.error&&"SecurityError"===e.error.name&&l.attachments?(delete l.attachments,window.Office.context.mailbox.displayNewMessageForm(l,(function(e){e.status===Office.AsyncResultStatus.Succeeded?a(e):s(new Error("Failed to create email without attachment: ".concat(e.error.message)))}))):s(new Error("Failed to create new email: ".concat(e.error.message)))}))}catch(e){if(console.error("Error displaying new message form:",e),"SecurityError"===e.name&&l.attachments){delete l.attachments;try{window.Office.context.mailbox.displayNewMessageForm(l,(function(e){e.status===Office.AsyncResultStatus.Succeeded?a(e):s(new Error("Failed to create email without attachment: ".concat(e.error.message)))}))}catch(e){s(new Error("Failed to create email: ".concat(e.message)))}}else s(e)}}catch(e){console.error("Error in createNewEmailWithAttachment:",e),s(e)}}))]}))}))},u=function(e,t,r,n){for(var o=[],i=4;i<arguments.length;i++)o[i-4]=arguments[i];return _v(void 0,Pv([e,t,r,n],o,!0),void 0,(function(e,t,r,n,o){var i,s,u,d,h,p,f,g,m;return void 0===o&&(o=!1),Ev(this,(function(y){switch(y.label){case 0:return y.trys.push([0,9,,10]),[4,a(e)];case 1:return i=y.sent(),console.log("Headers in handleEmailForwarding:",i),s=r.OtherPhishingTargetEmails.split(",").map((function(e){return e.trim()})),n?[4,c(e,t,r,i)]:[3,3];case 2:return y.sent(),kv.success("Phishing simulation reported successfully"),[3,5];case 3:return u=r.OtherPhishingSubject.replace("{subject}",e.subject||""),d=r.OtherPhishingBody.replace("{userEmail}",t).replace("{date}",(new Date).toLocaleString()).replace("{subject}",e.subject||"").replace("{sender}",(null===(m=e.sender)||void 0===m?void 0:m.emailAddress)||""),[4,l(e,s,u,d,i,o)];case 4:y.sent(),kv.success("Phishing email reported to security team"),y.label=5;case 5:if(y.trys.push([5,7,,8]),!(h=localStorage.getItem("access_token")))throw new Error("Access token is missing. Please sign in again.");if(!e.itemId)throw new Error("No email selected to delete.");return p=window.Office.context.mailbox.convertToRestId(e.itemId,Office.MailboxEnums.RestVersion.v2_0),[4,Tv(h,p,(function(e,t){e?(console.error("Error deleting email:",e),kv.error("Could not delete the email. Please delete it manually.")):t&&(console.log("Email deleted from Outlook"),kv.success("Email moved to deleted items"))}))];case 6:return y.sent(),[3,8];case 7:return f=y.sent(),console.error("Error deleting email:",f),kv.error("Could not delete the email. Please delete it manually."),[3,8];case 8:return[3,10];case 9:return g=y.sent(),console.error("Error in handleEmailForwarding:",g),kv.error("Could not process the phishing report. Please try again or contact your IT department."),[3,10];case 10:return[2]}}))}))};return n.createElement(n.Fragment,null,n.createElement(ys,{sx:{backgroundColor:"#f5f5f5",padding:"8px",borderRadius:2,maxWidth:600}},n.createElement(Qy,{sx:{paddingLeft:"2px",paddingRight:"8px"}},n.createElement(ev,null,n.createElement(ta,{sx:{fontWeight:"bold",fontSize:"20px",padding:"6px 0"},color:"primary"},ps.title),n.createElement(ta,{variant:"body1",paragraph:!0},ps.description),n.createElement(ys,{sx:{borderLeft:"4px solid #2196f3",pl:2,my:2,borderRadius:"4px"}},n.createElement(ta,{variant:"body2"},n.createElement("strong",null,ps.from)," ",t.from.emailAddress),n.createElement(ta,{variant:"body2"},n.createElement("strong",null,ps.subject)," ",t.subject),n.createElement(ta,{variant:"body2"},n.createElement("strong",null,ps.received)," ",o)),n.createElement(ta,{variant:"body1",paragraph:!0},ps.report_email),n.createElement(ds,{variant:"contained",color:"primary",fullWidth:!0,onClick:function(){return _v(void 0,void 0,void 0,(function(){return Ev(this,(function(t){switch(t.label){case 0:return console.log("Report as Phishing"),e("/phishing-page"),[4,_v(void 0,void 0,void 0,(function(){var e,t,r,n,o,i,l,d;return Ev(this,(function(h){switch(h.label){case 0:if(!(e=window.Office.context.mailbox.item))return kv.error("Cannot access email information"),[2];h.label=1;case 1:return h.trys.push([1,8,,9]),t=window.Office.context.mailbox.userProfile.emailAddress,r=t.substring(t.lastIndexOf("@")+1),[4,s(r)];case 2:return n=h.sent(),o="OutlookWebApp"===window.Office.context.mailbox.diagnostics.hostName,[4,a(e)];case 3:return i=h.sent(),l=null==i?void 0:i.includes("X-PHISHBAIT"),console.log("isSimulation",l),l?[4,c(e,t,n,i)]:[3,5];case 4:return h.sent(),[3,7];case 5:return[4,u(e,t,n,!1,o)];case 6:h.sent(),h.label=7;case 7:return[3,9];case 8:return d=h.sent(),kv.error(d),[3,9];case 9:return[2]}}))}))];case 1:return t.sent(),[2]}}))}))},sx:{textTransform:"capitalize"}},ps.button)))))};const Ov=n.createContext(),Mv=()=>n.useContext(Ov)??!1;function Nv(e){return parseInt(n.version,10)>=19?e?.props?.ref||null:e?.ref||null}var Bv=r(40961),Lv="unmounted",Hv="exited",$v="entering",qv="entered",Fv="exiting",Dv=function(e){function t(t,r){var n;n=e.call(this,t,r)||this;var o,i=r&&!r.isMounting?t.enter:t.appear;return n.appearStatus=null,t.in?i?(o=Hv,n.appearStatus=$v):o=qv:o=t.unmountOnExit||t.mountOnEnter?Lv:Hv,n.state={status:o},n.nextCallback=null,n}ma(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===Lv?{status:Hv}:null};var r=t.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(e){var t=null;if(e!==this.props){var r=this.state.status;this.props.in?r!==$v&&r!==qv&&(t=$v):r!==$v&&r!==qv||(t=Fv)}this.updateStatus(!1,t)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var e,t,r,n=this.props.timeout;return e=t=r=n,null!=n&&"number"!=typeof n&&(e=n.exit,t=n.enter,r=void 0!==n.appear?n.appear:t),{exit:e,enter:t,appear:r}},r.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===$v){if(this.props.unmountOnExit||this.props.mountOnEnter){var r=this.props.nodeRef?this.props.nodeRef.current:Bv.findDOMNode(this);r&&function(e){e.scrollTop}(r)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Hv&&this.setState({status:Lv})},r.performEnter=function(e){var t=this,r=this.props.enter,n=this.context?this.context.isMounting:e,o=this.props.nodeRef?[n]:[Bv.findDOMNode(this),n],i=o[0],a=o[1],s=this.getTimeouts(),c=n?s.appear:s.enter;e||r?(this.props.onEnter(i,a),this.safeSetState({status:$v},(function(){t.props.onEntering(i,a),t.onTransitionEnd(c,(function(){t.safeSetState({status:qv},(function(){t.props.onEntered(i,a)}))}))}))):this.safeSetState({status:qv},(function(){t.props.onEntered(i)}))},r.performExit=function(){var e=this,t=this.props.exit,r=this.getTimeouts(),n=this.props.nodeRef?void 0:Bv.findDOMNode(this);t?(this.props.onExit(n),this.safeSetState({status:Fv},(function(){e.props.onExiting(n),e.onTransitionEnd(r.exit,(function(){e.safeSetState({status:Hv},(function(){e.props.onExited(n)}))}))}))):this.safeSetState({status:Hv},(function(){e.props.onExited(n)}))},r.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},r.setNextCallback=function(e){var t=this,r=!0;return this.nextCallback=function(n){r&&(r=!1,t.nextCallback=null,e(n))},this.nextCallback.cancel=function(){r=!1},this.nextCallback},r.onTransitionEnd=function(e,t){this.setNextCallback(t);var r=this.props.nodeRef?this.props.nodeRef.current:Bv.findDOMNode(this),n=null==e&&!this.props.addEndListener;if(r&&!n){if(this.props.addEndListener){var o=this.props.nodeRef?[this.nextCallback]:[r,this.nextCallback],i=o[0],a=o[1];this.props.addEndListener(i,a)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},r.render=function(){var e=this.state.status;if(e===Lv)return null;var t=this.props,r=t.children,o=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,fa(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return n.createElement(ya.Provider,{value:null},"function"==typeof r?r(e,o):n.cloneElement(n.Children.only(r),o))},t}(n.Component);function Uv(){}Dv.contextType=ya,Dv.propTypes={},Dv.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Uv,onEntering:Uv,onEntered:Uv,onExit:Uv,onExiting:Uv,onExited:Uv},Dv.UNMOUNTED=Lv,Dv.EXITED=Hv,Dv.ENTERING=$v,Dv.ENTERED=qv,Dv.EXITING=Fv;var jv=Dv;function zv(e,t){const{timeout:r,easing:n,style:o={}}=e;return{duration:o.transitionDuration??("number"==typeof r?r:r[t.mode]||0),easing:o.transitionTimingFunction??("object"==typeof n?n[t.mode]:n),delay:o.transitionDelay}}function Kv(e){return`scale(${e}, ${e**2})`}const Wv={entering:{opacity:1,transform:Kv(1)},entered:{opacity:1,transform:"none"}},Gv="undefined"!=typeof navigator&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),Vv=n.forwardRef((function(e,t){const{addEndListener:r,appear:o=!0,children:i,easing:a,in:s,onEnter:c,onEntered:l,onEntering:u,onExit:d,onExited:h,onExiting:p,style:f,timeout:g="auto",TransitionComponent:m=jv,...y}=e,v=Ia(),b=n.useRef(),w=zy(),C=n.useRef(null),A=sa(C,Nv(i),t),k=e=>t=>{if(e){const r=C.current;void 0===t?e(r):e(r,t)}},S=k(u),T=k(((e,t)=>{(e=>{e.scrollTop})(e);const{duration:r,delay:n,easing:o}=zv({style:f,timeout:g,easing:a},{mode:"enter"});let i;"auto"===g?(i=w.transitions.getAutoHeightDuration(e.clientHeight),b.current=i):i=r,e.style.transition=[w.transitions.create("opacity",{duration:i,delay:n}),w.transitions.create("transform",{duration:Gv?i:.666*i,delay:n,easing:o})].join(","),c&&c(e,t)})),I=k(l),x=k(p),_=k((e=>{const{duration:t,delay:r,easing:n}=zv({style:f,timeout:g,easing:a},{mode:"exit"});let o;"auto"===g?(o=w.transitions.getAutoHeightDuration(e.clientHeight),b.current=o):o=t,e.style.transition=[w.transitions.create("opacity",{duration:o,delay:r}),w.transitions.create("transform",{duration:Gv?o:.666*o,delay:Gv?r:r||.333*o,easing:n})].join(","),e.style.opacity=0,e.style.transform=Kv(.75),d&&d(e)})),E=k(h);return(0,Zn.jsx)(m,{appear:o,in:s,nodeRef:C,onEnter:T,onEntered:I,onEntering:S,onExit:_,onExited:E,onExiting:x,addEndListener:e=>{"auto"===g&&v.start(b.current||0,e),r&&r(C.current,e)},timeout:"auto"===g?null:g,...y,children:(e,{ownerState:t,...r})=>n.cloneElement(i,{style:{opacity:0,transform:Kv(.75),visibility:"exited"!==e||s?void 0:"hidden",...Wv[e],...f,...i.props.style},ref:A,...r})})}));Vv&&(Vv.muiSupportAuto=!0);var Yv=Vv;function Qv(e){return e&&e.ownerDocument||document}function Jv(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Xv(e){return e instanceof Jv(e).Element||e instanceof Element}function Zv(e){return e instanceof Jv(e).HTMLElement||e instanceof HTMLElement}function eb(e){return"undefined"!=typeof ShadowRoot&&(e instanceof Jv(e).ShadowRoot||e instanceof ShadowRoot)}var tb=Math.max,rb=Math.min,nb=Math.round;function ob(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function ib(){return!/^((?!chrome|android).)*safari/i.test(ob())}function ab(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=!1);var n=e.getBoundingClientRect(),o=1,i=1;t&&Zv(e)&&(o=e.offsetWidth>0&&nb(n.width)/e.offsetWidth||1,i=e.offsetHeight>0&&nb(n.height)/e.offsetHeight||1);var a=(Xv(e)?Jv(e):window).visualViewport,s=!ib()&&r,c=(n.left+(s&&a?a.offsetLeft:0))/o,l=(n.top+(s&&a?a.offsetTop:0))/i,u=n.width/o,d=n.height/i;return{width:u,height:d,top:l,right:c+u,bottom:l+d,left:c,x:c,y:l}}function sb(e){var t=Jv(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function cb(e){return e?(e.nodeName||"").toLowerCase():null}function lb(e){return((Xv(e)?e.ownerDocument:e.document)||window.document).documentElement}function ub(e){return ab(lb(e)).left+sb(e).scrollLeft}function db(e){return Jv(e).getComputedStyle(e)}function hb(e){var t=db(e),r=t.overflow,n=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+o+n)}function pb(e,t,r){void 0===r&&(r=!1);var n=Zv(t),o=Zv(t)&&function(e){var t=e.getBoundingClientRect(),r=nb(t.width)/e.offsetWidth||1,n=nb(t.height)/e.offsetHeight||1;return 1!==r||1!==n}(t),i=lb(t),a=ab(e,o,r),s={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(n||!n&&!r)&&(("body"!==cb(t)||hb(i))&&(s=function(e){return e!==Jv(e)&&Zv(e)?{scrollLeft:(t=e).scrollLeft,scrollTop:t.scrollTop}:sb(e);var t}(t)),Zv(t)?((c=ab(t,!0)).x+=t.clientLeft,c.y+=t.clientTop):i&&(c.x=ub(i))),{x:a.left+s.scrollLeft-c.x,y:a.top+s.scrollTop-c.y,width:a.width,height:a.height}}function fb(e){var t=ab(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function gb(e){return"html"===cb(e)?e:e.assignedSlot||e.parentNode||(eb(e)?e.host:null)||lb(e)}function mb(e){return["html","body","#document"].indexOf(cb(e))>=0?e.ownerDocument.body:Zv(e)&&hb(e)?e:mb(gb(e))}function yb(e,t){var r;void 0===t&&(t=[]);var n=mb(e),o=n===(null==(r=e.ownerDocument)?void 0:r.body),i=Jv(n),a=o?[i].concat(i.visualViewport||[],hb(n)?n:[]):n,s=t.concat(a);return o?s:s.concat(yb(gb(a)))}function vb(e){return["table","td","th"].indexOf(cb(e))>=0}function bb(e){return Zv(e)&&"fixed"!==db(e).position?e.offsetParent:null}function wb(e){for(var t=Jv(e),r=bb(e);r&&vb(r)&&"static"===db(r).position;)r=bb(r);return r&&("html"===cb(r)||"body"===cb(r)&&"static"===db(r).position)?t:r||function(e){var t=/firefox/i.test(ob());if(/Trident/i.test(ob())&&Zv(e)&&"fixed"===db(e).position)return null;var r=gb(e);for(eb(r)&&(r=r.host);Zv(r)&&["html","body"].indexOf(cb(r))<0;){var n=db(r);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||t&&"filter"===n.willChange||t&&n.filter&&"none"!==n.filter)return r;r=r.parentNode}return null}(e)||t}var Cb="top",Ab="bottom",kb="right",Sb="left",Tb="auto",Ib=[Cb,Ab,kb,Sb],xb="start",_b="end",Eb="viewport",Pb="popper",Rb=Ib.reduce((function(e,t){return e.concat([t+"-"+xb,t+"-"+_b])}),[]),Ob=[].concat(Ib,[Tb]).reduce((function(e,t){return e.concat([t,t+"-"+xb,t+"-"+_b])}),[]),Mb=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Nb(e){var t=new Map,r=new Set,n=[];function o(e){r.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!r.has(e)){var n=t.get(e);n&&o(n)}})),n.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){r.has(e.name)||o(e)})),n}var Bb=r(64583).Promise,Lb=r(64583).Promise,Hb={placement:"bottom",modifiers:[],strategy:"absolute"};function $b(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function qb(e){void 0===e&&(e={});var t=e,r=t.defaultModifiers,n=void 0===r?[]:r,o=t.defaultOptions,i=void 0===o?Hb:o;return function(e,t,r){void 0===r&&(r=i);var o,a,s={placement:"bottom",orderedModifiers:[],options:Object.assign({},Hb,i),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},c=[],l=!1,u={state:s,setOptions:function(r){var o="function"==typeof r?r(s.options):r;d(),s.options=Object.assign({},i,s.options,o),s.scrollParents={reference:Xv(e)?yb(e):e.contextElement?yb(e.contextElement):[],popper:yb(t)};var a,l,h=function(e){var t=Nb(e);return Mb.reduce((function(e,r){return e.concat(t.filter((function(e){return e.phase===r})))}),[])}((a=[].concat(n,s.options.modifiers),l=a.reduce((function(e,t){var r=e[t.name];return e[t.name]=r?Object.assign({},r,t,{options:Object.assign({},r.options,t.options),data:Object.assign({},r.data,t.data)}):t,e}),{}),Object.keys(l).map((function(e){return l[e]}))));return s.orderedModifiers=h.filter((function(e){return e.enabled})),s.orderedModifiers.forEach((function(e){var t=e.name,r=e.options,n=void 0===r?{}:r,o=e.effect;if("function"==typeof o){var i=o({state:s,name:t,instance:u,options:n});c.push(i||function(){})}})),u.update()},forceUpdate:function(){if(!l){var e=s.elements,t=e.reference,r=e.popper;if($b(t,r)){s.rects={reference:pb(t,wb(r),"fixed"===s.options.strategy),popper:fb(r)},s.reset=!1,s.placement=s.options.placement,s.orderedModifiers.forEach((function(e){return s.modifiersData[e.name]=Object.assign({},e.data)}));for(var n=0;n<s.orderedModifiers.length;n++)if(!0!==s.reset){var o=s.orderedModifiers[n],i=o.fn,a=o.options,c=void 0===a?{}:a,d=o.name;"function"==typeof i&&(s=i({state:s,options:c,name:d,instance:u})||s)}else s.reset=!1,n=-1}}},update:(o=function(){return new Lb((function(e){u.forceUpdate(),e(s)}))},function(){return a||(a=new Bb((function(e){Bb.resolve().then((function(){a=void 0,e(o())}))}))),a}),destroy:function(){d(),l=!0}};if(!$b(e,t))return u;function d(){c.forEach((function(e){return e()})),c=[]}return u.setOptions(r).then((function(e){!l&&r.onFirstUpdate&&r.onFirstUpdate(e)})),u}}var Fb={passive:!0},Db={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,r=e.instance,n=e.options,o=n.scroll,i=void 0===o||o,a=n.resize,s=void 0===a||a,c=Jv(t.elements.popper),l=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&l.forEach((function(e){e.addEventListener("scroll",r.update,Fb)})),s&&c.addEventListener("resize",r.update,Fb),function(){i&&l.forEach((function(e){e.removeEventListener("scroll",r.update,Fb)})),s&&c.removeEventListener("resize",r.update,Fb)}},data:{}};function Ub(e){return e.split("-")[0]}function jb(e){return e.split("-")[1]}function zb(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Kb(e){var t,r=e.reference,n=e.element,o=e.placement,i=o?Ub(o):null,a=o?jb(o):null,s=r.x+r.width/2-n.width/2,c=r.y+r.height/2-n.height/2;switch(i){case Cb:t={x:s,y:r.y-n.height};break;case Ab:t={x:s,y:r.y+r.height};break;case kb:t={x:r.x+r.width,y:c};break;case Sb:t={x:r.x-n.width,y:c};break;default:t={x:r.x,y:r.y}}var l=i?zb(i):null;if(null!=l){var u="y"===l?"height":"width";switch(a){case xb:t[l]=t[l]-(r[u]/2-n[u]/2);break;case _b:t[l]=t[l]+(r[u]/2-n[u]/2)}}return t}var Wb={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Gb(e){var t,r=e.popper,n=e.popperRect,o=e.placement,i=e.variation,a=e.offsets,s=e.position,c=e.gpuAcceleration,l=e.adaptive,u=e.roundOffsets,d=e.isFixed,h=a.x,p=void 0===h?0:h,f=a.y,g=void 0===f?0:f,m="function"==typeof u?u({x:p,y:g}):{x:p,y:g};p=m.x,g=m.y;var y=a.hasOwnProperty("x"),v=a.hasOwnProperty("y"),b=Sb,w=Cb,C=window;if(l){var A=wb(r),k="clientHeight",S="clientWidth";A===Jv(r)&&"static"!==db(A=lb(r)).position&&"absolute"===s&&(k="scrollHeight",S="scrollWidth"),(o===Cb||(o===Sb||o===kb)&&i===_b)&&(w=Ab,g-=(d&&A===C&&C.visualViewport?C.visualViewport.height:A[k])-n.height,g*=c?1:-1),o!==Sb&&(o!==Cb&&o!==Ab||i!==_b)||(b=kb,p-=(d&&A===C&&C.visualViewport?C.visualViewport.width:A[S])-n.width,p*=c?1:-1)}var T,I=Object.assign({position:s},l&&Wb),x=!0===u?function(e,t){var r=e.x,n=e.y,o=t.devicePixelRatio||1;return{x:nb(r*o)/o||0,y:nb(n*o)/o||0}}({x:p,y:g},Jv(r)):{x:p,y:g};return p=x.x,g=x.y,c?Object.assign({},I,((T={})[w]=v?"0":"",T[b]=y?"0":"",T.transform=(C.devicePixelRatio||1)<=1?"translate("+p+"px, "+g+"px)":"translate3d("+p+"px, "+g+"px, 0)",T)):Object.assign({},I,((t={})[w]=v?g+"px":"",t[b]=y?p+"px":"",t.transform="",t))}var Vb={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,r=e.options,n=r.gpuAcceleration,o=void 0===n||n,i=r.adaptive,a=void 0===i||i,s=r.roundOffsets,c=void 0===s||s,l={placement:Ub(t.placement),variation:jb(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,Gb(Object.assign({},l,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:c})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,Gb(Object.assign({},l,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},Yb={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,r=e.options,n=e.name,o=r.offset,i=void 0===o?[0,0]:o,a=Ob.reduce((function(e,r){return e[r]=function(e,t,r){var n=Ub(e),o=[Sb,Cb].indexOf(n)>=0?-1:1,i="function"==typeof r?r(Object.assign({},t,{placement:e})):r,a=i[0],s=i[1];return a=a||0,s=(s||0)*o,[Sb,kb].indexOf(n)>=0?{x:s,y:a}:{x:a,y:s}}(r,t.rects,i),e}),{}),s=a[t.placement],c=s.x,l=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=c,t.modifiersData.popperOffsets.y+=l),t.modifiersData[n]=a}},Qb={left:"right",right:"left",bottom:"top",top:"bottom"};function Jb(e){return e.replace(/left|right|bottom|top/g,(function(e){return Qb[e]}))}var Xb={start:"end",end:"start"};function Zb(e){return e.replace(/start|end/g,(function(e){return Xb[e]}))}function ew(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&eb(r)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function tw(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function rw(e,t,r){return t===Eb?tw(function(e,t){var r=Jv(e),n=lb(e),o=r.visualViewport,i=n.clientWidth,a=n.clientHeight,s=0,c=0;if(o){i=o.width,a=o.height;var l=ib();(l||!l&&"fixed"===t)&&(s=o.offsetLeft,c=o.offsetTop)}return{width:i,height:a,x:s+ub(e),y:c}}(e,r)):Xv(t)?function(e,t){var r=ab(e,!1,"fixed"===t);return r.top=r.top+e.clientTop,r.left=r.left+e.clientLeft,r.bottom=r.top+e.clientHeight,r.right=r.left+e.clientWidth,r.width=e.clientWidth,r.height=e.clientHeight,r.x=r.left,r.y=r.top,r}(t,r):tw(function(e){var t,r=lb(e),n=sb(e),o=null==(t=e.ownerDocument)?void 0:t.body,i=tb(r.scrollWidth,r.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),a=tb(r.scrollHeight,r.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),s=-n.scrollLeft+ub(e),c=-n.scrollTop;return"rtl"===db(o||r).direction&&(s+=tb(r.clientWidth,o?o.clientWidth:0)-i),{width:i,height:a,x:s,y:c}}(lb(e)))}function nw(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function ow(e,t){return t.reduce((function(t,r){return t[r]=e,t}),{})}function iw(e,t){void 0===t&&(t={});var r=t,n=r.placement,o=void 0===n?e.placement:n,i=r.strategy,a=void 0===i?e.strategy:i,s=r.boundary,c=void 0===s?"clippingParents":s,l=r.rootBoundary,u=void 0===l?Eb:l,d=r.elementContext,h=void 0===d?Pb:d,p=r.altBoundary,f=void 0!==p&&p,g=r.padding,m=void 0===g?0:g,y=nw("number"!=typeof m?m:ow(m,Ib)),v=h===Pb?"reference":Pb,b=e.rects.popper,w=e.elements[f?v:h],C=function(e,t,r,n){var o="clippingParents"===t?function(e){var t=yb(gb(e)),r=["absolute","fixed"].indexOf(db(e).position)>=0&&Zv(e)?wb(e):e;return Xv(r)?t.filter((function(e){return Xv(e)&&ew(e,r)&&"body"!==cb(e)})):[]}(e):[].concat(t),i=[].concat(o,[r]),a=i[0],s=i.reduce((function(t,r){var o=rw(e,r,n);return t.top=tb(o.top,t.top),t.right=rb(o.right,t.right),t.bottom=rb(o.bottom,t.bottom),t.left=tb(o.left,t.left),t}),rw(e,a,n));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}(Xv(w)?w:w.contextElement||lb(e.elements.popper),c,u,a),A=ab(e.elements.reference),k=Kb({reference:A,element:b,strategy:"absolute",placement:o}),S=tw(Object.assign({},b,k)),T=h===Pb?S:A,I={top:C.top-T.top+y.top,bottom:T.bottom-C.bottom+y.bottom,left:C.left-T.left+y.left,right:T.right-C.right+y.right},x=e.modifiersData.offset;if(h===Pb&&x){var _=x[o];Object.keys(I).forEach((function(e){var t=[kb,Ab].indexOf(e)>=0?1:-1,r=[Cb,Ab].indexOf(e)>=0?"y":"x";I[e]+=_[r]*t}))}return I}var aw={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,r=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var o=r.mainAxis,i=void 0===o||o,a=r.altAxis,s=void 0===a||a,c=r.fallbackPlacements,l=r.padding,u=r.boundary,d=r.rootBoundary,h=r.altBoundary,p=r.flipVariations,f=void 0===p||p,g=r.allowedAutoPlacements,m=t.options.placement,y=Ub(m),v=c||(y!==m&&f?function(e){if(Ub(e)===Tb)return[];var t=Jb(e);return[Zb(e),t,Zb(t)]}(m):[Jb(m)]),b=[m].concat(v).reduce((function(e,r){return e.concat(Ub(r)===Tb?function(e,t){void 0===t&&(t={});var r=t,n=r.placement,o=r.boundary,i=r.rootBoundary,a=r.padding,s=r.flipVariations,c=r.allowedAutoPlacements,l=void 0===c?Ob:c,u=jb(n),d=u?s?Rb:Rb.filter((function(e){return jb(e)===u})):Ib,h=d.filter((function(e){return l.indexOf(e)>=0}));0===h.length&&(h=d);var p=h.reduce((function(t,r){return t[r]=iw(e,{placement:r,boundary:o,rootBoundary:i,padding:a})[Ub(r)],t}),{});return Object.keys(p).sort((function(e,t){return p[e]-p[t]}))}(t,{placement:r,boundary:u,rootBoundary:d,padding:l,flipVariations:f,allowedAutoPlacements:g}):r)}),[]),w=t.rects.reference,C=t.rects.popper,A=new Map,k=!0,S=b[0],T=0;T<b.length;T++){var I=b[T],x=Ub(I),_=jb(I)===xb,E=[Cb,Ab].indexOf(x)>=0,P=E?"width":"height",R=iw(t,{placement:I,boundary:u,rootBoundary:d,altBoundary:h,padding:l}),O=E?_?kb:Sb:_?Ab:Cb;w[P]>C[P]&&(O=Jb(O));var M=Jb(O),N=[];if(i&&N.push(R[x]<=0),s&&N.push(R[O]<=0,R[M]<=0),N.every((function(e){return e}))){S=I,k=!1;break}A.set(I,N)}if(k)for(var B=function(e){var t=b.find((function(t){var r=A.get(t);if(r)return r.slice(0,e).every((function(e){return e}))}));if(t)return S=t,"break"},L=f?3:1;L>0&&"break"!==B(L);L--);t.placement!==S&&(t.modifiersData[n]._skip=!0,t.placement=S,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function sw(e,t,r){return tb(e,rb(t,r))}var cw={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,r=e.options,n=e.name,o=r.mainAxis,i=void 0===o||o,a=r.altAxis,s=void 0!==a&&a,c=r.boundary,l=r.rootBoundary,u=r.altBoundary,d=r.padding,h=r.tether,p=void 0===h||h,f=r.tetherOffset,g=void 0===f?0:f,m=iw(t,{boundary:c,rootBoundary:l,padding:d,altBoundary:u}),y=Ub(t.placement),v=jb(t.placement),b=!v,w=zb(y),C="x"===w?"y":"x",A=t.modifiersData.popperOffsets,k=t.rects.reference,S=t.rects.popper,T="function"==typeof g?g(Object.assign({},t.rects,{placement:t.placement})):g,I="number"==typeof T?{mainAxis:T,altAxis:T}:Object.assign({mainAxis:0,altAxis:0},T),x=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,_={x:0,y:0};if(A){if(i){var E,P="y"===w?Cb:Sb,R="y"===w?Ab:kb,O="y"===w?"height":"width",M=A[w],N=M+m[P],B=M-m[R],L=p?-S[O]/2:0,H=v===xb?k[O]:S[O],$=v===xb?-S[O]:-k[O],q=t.elements.arrow,F=p&&q?fb(q):{width:0,height:0},D=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},U=D[P],j=D[R],z=sw(0,k[O],F[O]),K=b?k[O]/2-L-z-U-I.mainAxis:H-z-U-I.mainAxis,W=b?-k[O]/2+L+z+j+I.mainAxis:$+z+j+I.mainAxis,G=t.elements.arrow&&wb(t.elements.arrow),V=G?"y"===w?G.clientTop||0:G.clientLeft||0:0,Y=null!=(E=null==x?void 0:x[w])?E:0,Q=M+W-Y,J=sw(p?rb(N,M+K-Y-V):N,M,p?tb(B,Q):B);A[w]=J,_[w]=J-M}if(s){var X,Z="x"===w?Cb:Sb,ee="x"===w?Ab:kb,te=A[C],re="y"===C?"height":"width",ne=te+m[Z],oe=te-m[ee],ie=-1!==[Cb,Sb].indexOf(y),ae=null!=(X=null==x?void 0:x[C])?X:0,se=ie?ne:te-k[re]-S[re]-ae+I.altAxis,ce=ie?te+k[re]+S[re]-ae-I.altAxis:oe,le=p&&ie?function(e,t,r){var n=sw(e,t,r);return n>r?r:n}(se,te,ce):sw(p?se:ne,te,p?ce:oe);A[C]=le,_[C]=le-te}t.modifiersData[n]=_}},requiresIfExists:["offset"]},lw={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,r=e.state,n=e.name,o=e.options,i=r.elements.arrow,a=r.modifiersData.popperOffsets,s=Ub(r.placement),c=zb(s),l=[Sb,kb].indexOf(s)>=0?"height":"width";if(i&&a){var u=function(e,t){return nw("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:ow(e,Ib))}(o.padding,r),d=fb(i),h="y"===c?Cb:Sb,p="y"===c?Ab:kb,f=r.rects.reference[l]+r.rects.reference[c]-a[c]-r.rects.popper[l],g=a[c]-r.rects.reference[c],m=wb(i),y=m?"y"===c?m.clientHeight||0:m.clientWidth||0:0,v=f/2-g/2,b=u[h],w=y-d[l]-u[p],C=y/2-d[l]/2+v,A=sw(b,C,w),k=c;r.modifiersData[n]=((t={})[k]=A,t.centerOffset=A-C,t)}},effect:function(e){var t=e.state,r=e.options.element,n=void 0===r?"[data-popper-arrow]":r;null!=n&&("string"!=typeof n||(n=t.elements.popper.querySelector(n)))&&ew(t.elements.popper,n)&&(t.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function uw(e,t,r){return void 0===r&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function dw(e){return[Cb,kb,Ab,Sb].some((function(t){return e[t]>=0}))}var hw=qb({defaultModifiers:[Db,{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,r=e.name;t.modifiersData[r]=Kb({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},Vb,{name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var r=t.styles[e]||{},n=t.attributes[e]||{},o=t.elements[e];Zv(o)&&cb(o)&&(Object.assign(o.style,r),Object.keys(n).forEach((function(e){var t=n[e];!1===t?o.removeAttribute(e):o.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow),function(){Object.keys(t.elements).forEach((function(e){var n=t.elements[e],o=t.attributes[e]||{},i=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:r[e]).reduce((function(e,t){return e[t]="",e}),{});Zv(n)&&cb(n)&&(Object.assign(n.style,i),Object.keys(o).forEach((function(e){n.removeAttribute(e)})))}))}},requires:["computeStyles"]},Yb,aw,cw,lw,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,r=e.name,n=t.rects.reference,o=t.rects.popper,i=t.modifiersData.preventOverflow,a=iw(t,{elementContext:"reference"}),s=iw(t,{altBoundary:!0}),c=uw(a,n),l=uw(s,o,i),u=dw(c),d=dw(l);t.modifiersData[r]={referenceClippingOffsets:c,popperEscapeOffsets:l,isReferenceHidden:u,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}}]}),pw=function(e,t,r){return void 0===e||"string"==typeof e?t:{...t,ownerState:{...t.ownerState,...r}}},fw=function(e){if(void 0===e)return{};const t={};return Object.keys(e).filter((t=>!(t.match(/^on[A-Z]/)&&"function"==typeof e[t]))).forEach((r=>{t[r]=e[r]})),t},gw=function(e){const{getSlotProps:t,additionalProps:r,externalSlotProps:n,externalForwardedProps:o,className:i}=e;if(!t){const e=$e(r?.className,i,o?.className,n?.className),t={...r?.style,...o?.style,...n?.style},a={...r,...o,...n};return e.length>0&&(a.className=e),Object.keys(t).length>0&&(a.style=t),{props:a,internalRef:void 0}}const a=function(e,t=[]){if(void 0===e)return{};const r={};return Object.keys(e).filter((r=>r.match(/^on[A-Z]/)&&"function"==typeof e[r]&&!t.includes(r))).forEach((t=>{r[t]=e[t]})),r}({...o,...n}),s=fw(n),c=fw(o),l=t(a),u=$e(l?.className,r?.className,i,o?.className,n?.className),d={...l?.style,...r?.style,...o?.style,...n?.style},h={...l,...r,...c,...s};return u.length>0&&(h.className=u),Object.keys(d).length>0&&(h.style=d),{props:h,internalRef:l.ref}},mw=function(e,t,r){return"function"==typeof e?e(t,r):e};function yw(e,t){"function"==typeof e?e(t):e&&(e.current=t)}var vw=n.forwardRef((function(e,t){const{children:r,container:o,disablePortal:i=!1}=e,[a,s]=n.useState(null),c=aa(n.isValidElement(r)?Nv(r):null,t);if(ca((()=>{i||s(function(e){return"function"==typeof e?e():e}(o)||document.body)}),[o,i]),ca((()=>{if(a&&!i)return yw(t,a),()=>{yw(t,null)}}),[t,a,i]),i){if(n.isValidElement(r)){const e={ref:c};return n.cloneElement(r,e)}return r}return a?Bv.createPortal(r,a):a}));function bw(e){return We("MuiPopper",e)}function ww(e){return"function"==typeof e?e():e}Yi("MuiPopper",["root"]);const Cw={},Aw=n.forwardRef((function(e,t){const{anchorEl:r,children:o,direction:i,disablePortal:a,modifiers:s,open:c,placement:l,popperOptions:u,popperRef:d,slotProps:h={},slots:p={},TransitionProps:f,ownerState:g,...m}=e,y=n.useRef(null),v=aa(y,t),b=n.useRef(null),w=aa(b,d),C=n.useRef(w);ca((()=>{C.current=w}),[w]),n.useImperativeHandle(d,(()=>b.current),[]);const A=function(e,t){if("ltr"===t)return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}(l,i),[k,S]=n.useState(A),[T,I]=n.useState(ww(r));n.useEffect((()=>{b.current&&b.current.forceUpdate()})),n.useEffect((()=>{r&&I(ww(r))}),[r]),ca((()=>{if(!T||!c)return;let e=[{name:"preventOverflow",options:{altBoundary:a}},{name:"flip",options:{altBoundary:a}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:e})=>{S(e.placement)}}];null!=s&&(e=e.concat(s)),u&&null!=u.modifiers&&(e=e.concat(u.modifiers));const t=hw(T,y.current,{placement:A,...u,modifiers:e});return C.current(t),()=>{t.destroy(),C.current(null)}}),[T,a,s,c,u,A]);const x={placement:k};null!==f&&(x.TransitionProps=f);const _=(e=>{const{classes:t}=e;return Ge({root:["root"]},bw,t)})(e),E=p.root??"div",P=function(e){const{elementType:t,externalSlotProps:r,ownerState:n,skipResolvingSlotProps:o=!1,...i}=e,a=o?{}:mw(r,n),{props:s,internalRef:c}=gw({...i,externalSlotProps:a}),l=aa(c,a?.ref,e.additionalProps?.ref);return pw(t,{...s,ref:l},n)}({elementType:E,externalSlotProps:h.root,externalForwardedProps:m,additionalProps:{role:"tooltip",ref:v},ownerState:e,className:_.root});return(0,Zn.jsx)(E,{...P,children:"function"==typeof o?o(x):o})})),kw=Fi(n.forwardRef((function(e,t){const{anchorEl:r,children:o,container:i,direction:a="ltr",disablePortal:s=!1,keepMounted:c=!1,modifiers:l,open:u,placement:d="bottom",popperOptions:h=Cw,popperRef:p,style:f,transition:g=!1,slotProps:m={},slots:y={},...v}=e,[b,w]=n.useState(!0);if(!c&&!u&&(!g||b))return null;let C;if(i)C=i;else if(r){const e=ww(r);C=e&&void 0!==e.nodeType?Qv(e).body:Qv(null).body}const A=u||!c||g&&!b?void 0:"none",k=g?{in:u,onEnter:()=>{w(!1)},onExited:()=>{w(!0)}}:void 0;return(0,Zn.jsx)(vw,{disablePortal:s,container:C,children:(0,Zn.jsx)(Aw,{anchorEl:r,direction:a,disablePortal:s,modifiers:l,ref:t,open:g?!b:u,placement:d,popperOptions:h,popperRef:p,slotProps:m,slots:y,...v,style:{position:"fixed",top:0,left:0,display:A,...f},TransitionProps:k,children:o})})})),{name:"MuiPopper",slot:"Root"})({});var Sw=n.forwardRef((function(e,t){const r=Mv(),n=Ui({props:e,name:"MuiPopper"}),{anchorEl:o,component:i,components:a,componentsProps:s,container:c,disablePortal:l,keepMounted:u,modifiers:d,open:h,placement:p,popperOptions:f,popperRef:g,transition:m,slots:y,slotProps:v,...b}=n,w=y?.root??a?.Root,C={anchorEl:o,container:c,disablePortal:l,keepMounted:u,modifiers:d,open:h,placement:p,popperOptions:f,popperRef:g,transition:m,...b};return(0,Zn.jsx)(kw,{as:i,direction:r?"rtl":"ltr",slots:{root:w},slotProps:v??s,...C,ref:t})}));function Tw(e,t){const{className:r,elementType:n,ownerState:o,externalForwardedProps:i,internalForwardedProps:a,shouldForwardComponentProp:s=!1,...c}=t,{component:l,slots:u={[e]:void 0},slotProps:d={[e]:void 0},...h}=i,p=u[e]||n,f=mw(d[e],o),{props:{component:g,...m},internalRef:y}=gw({className:r,...c,externalForwardedProps:"root"===e?h:void 0,externalSlotProps:f}),v=aa(y,f?.ref,t.ref),b="root"===e?g||l:g;return[p,pw(p,{..."root"===e&&!l&&!u[e]&&a,..."root"!==e&&!u[e]&&a,...m,...b&&!s&&{as:b},...b&&s&&{component:b},ref:v},o)]}function Iw(e){return We("MuiTooltip",e)}var xw=Yi("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);const _w=Fi(Sw,{name:"MuiTooltip",slot:"Popper",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.popper,!r.disableInteractive&&t.popperInteractive,r.arrow&&t.popperArrow,!r.open&&t.popperClose]}})(Wi((({theme:e})=>({zIndex:(e.vars||e).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:e})=>!e.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:e})=>!e,style:{pointerEvents:"none"}},{props:({ownerState:e})=>e.arrow,style:{[`&[data-popper-placement*="bottom"] .${xw.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${xw.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${xw.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${xw.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="right"] .${xw.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="right"] .${xw.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="left"] .${xw.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="left"] .${xw.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]})))),Ew=Fi("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.tooltip,r.touch&&t.touch,r.arrow&&t.tooltipArrow,t[`tooltipPlacement${Gi(r.placement.split("-")[0])}`]]}})(Wi((({theme:e})=>{return{backgroundColor:e.vars?e.vars.palette.Tooltip.bg:po(e.palette.grey[700],.92),borderRadius:(e.vars||e).shape.borderRadius,color:(e.vars||e).palette.common.white,fontFamily:e.typography.fontFamily,padding:"4px 8px",fontSize:e.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:e.typography.fontWeightMedium,[`.${xw.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${xw.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${xw.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${xw.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:e})=>e.arrow,style:{position:"relative",margin:0}},{props:({ownerState:e})=>e.touch,style:{padding:"8px 16px",fontSize:e.typography.pxToRem(14),lineHeight:(t=16/14,Math.round(1e5*t)/1e5+"em"),fontWeight:e.typography.fontWeightRegular}},{props:({ownerState:e})=>!e.isRtl,style:{[`.${xw.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${xw.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:e})=>!e.isRtl&&e.touch,style:{[`.${xw.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${xw.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:e})=>!!e.isRtl,style:{[`.${xw.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${xw.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:e})=>!!e.isRtl&&e.touch,style:{[`.${xw.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${xw.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${xw.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${xw.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]};var t}))),Pw=Fi("span",{name:"MuiTooltip",slot:"Arrow"})(Wi((({theme:e})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:e.vars?e.vars.palette.Tooltip.bg:po(e.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}}))));let Rw=!1;const Ow=new Ta;let Mw={x:0,y:0};function Nw(e,t){return(r,...n)=>{t&&t(r,...n),e(r,...n)}}var Bw=n.forwardRef((function(e,t){const r=Ui({props:e,name:"MuiTooltip"}),{arrow:o=!1,children:i,classes:a,components:s={},componentsProps:c={},describeChild:l=!1,disableFocusListener:u=!1,disableHoverListener:d=!1,disableInteractive:h=!1,disableTouchListener:p=!1,enterDelay:f=100,enterNextDelay:g=0,enterTouchDelay:m=700,followCursor:y=!1,id:v,leaveDelay:b=0,leaveTouchDelay:w=1500,onClose:C,onOpen:A,open:k,placement:S="bottom",PopperComponent:T,PopperProps:I={},slotProps:x={},slots:_={},title:E,TransitionComponent:P,TransitionProps:R,...O}=r,M=n.isValidElement(i)?i:(0,Zn.jsx)("span",{children:i}),N=zy(),B=Mv(),[L,H]=n.useState(),[$,q]=n.useState(null),F=n.useRef(!1),D=h||y,U=Ia(),j=Ia(),z=Ia(),K=Ia(),[W,G]=function(e){const{controlled:t,default:r,name:o,state:i="value"}=e,{current:a}=n.useRef(void 0!==t),[s,c]=n.useState(r);return[a?t:s,n.useCallback((e=>{a||c(e)}),[])]}({controlled:k,default:!1,name:"Tooltip",state:"open"});let V=W;const Y=oa(v),Q=n.useRef(),J=la((()=>{void 0!==Q.current&&(document.body.style.WebkitUserSelect=Q.current,Q.current=void 0),K.clear()}));n.useEffect((()=>J),[J]);const X=e=>{Ow.clear(),Rw=!0,G(!0),A&&!V&&A(e)},Z=la((e=>{Ow.start(800+b,(()=>{Rw=!1})),G(!1),C&&V&&C(e),U.start(N.transitions.duration.shortest,(()=>{F.current=!1}))})),ee=e=>{F.current&&"touchstart"!==e.type||(L&&L.removeAttribute("title"),j.clear(),z.clear(),f||Rw&&g?j.start(Rw?g:f,(()=>{X(e)})):X(e))},te=e=>{j.clear(),z.start(b,(()=>{Z(e)}))},[,re]=n.useState(!1),ne=e=>{ia(e.target)||(re(!1),te(e))},oe=e=>{L||H(e.currentTarget),ia(e.target)&&(re(!0),ee(e))},ie=e=>{F.current=!0;const t=M.props;t.onTouchStart&&t.onTouchStart(e)};n.useEffect((()=>{if(V)return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)};function e(e){"Escape"===e.key&&Z(e)}}),[Z,V]);const ae=sa(Nv(M),H,t);E||0===E||(V=!1);const se=n.useRef(),ce={},le="string"==typeof E;l?(ce.title=V||!le||d?null:E,ce["aria-describedby"]=V?Y:null):(ce["aria-label"]=le?E:null,ce["aria-labelledby"]=V&&!le?Y:null);const ue={...ce,...O,...M.props,className:$e(O.className,M.props.className),onTouchStart:ie,ref:ae,...y?{onMouseMove:e=>{const t=M.props;t.onMouseMove&&t.onMouseMove(e),Mw={x:e.clientX,y:e.clientY},se.current&&se.current.update()}}:{}},de={};p||(ue.onTouchStart=e=>{ie(e),z.clear(),U.clear(),J(),Q.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",K.start(m,(()=>{document.body.style.WebkitUserSelect=Q.current,ee(e)}))},ue.onTouchEnd=e=>{M.props.onTouchEnd&&M.props.onTouchEnd(e),J(),z.start(w,(()=>{Z(e)}))}),d||(ue.onMouseOver=Nw(ee,ue.onMouseOver),ue.onMouseLeave=Nw(te,ue.onMouseLeave),D||(de.onMouseOver=ee,de.onMouseLeave=te)),u||(ue.onFocus=Nw(oe,ue.onFocus),ue.onBlur=Nw(ne,ue.onBlur),D||(de.onFocus=oe,de.onBlur=ne));const he={...r,isRtl:B,arrow:o,disableInteractive:D,placement:S,PopperComponentProp:T,touch:F.current},pe="function"==typeof x.popper?x.popper(he):x.popper,fe=n.useMemo((()=>{let e=[{name:"arrow",enabled:Boolean($),options:{element:$,padding:4}}];return I.popperOptions?.modifiers&&(e=e.concat(I.popperOptions.modifiers)),pe?.popperOptions?.modifiers&&(e=e.concat(pe.popperOptions.modifiers)),{...I.popperOptions,...pe?.popperOptions,modifiers:e}}),[$,I.popperOptions,pe?.popperOptions]),ge=(e=>{const{classes:t,disableInteractive:r,arrow:n,touch:o,placement:i}=e;return Ge({popper:["popper",!r&&"popperInteractive",n&&"popperArrow"],tooltip:["tooltip",n&&"tooltipArrow",o&&"touch",`tooltipPlacement${Gi(i.split("-")[0])}`],arrow:["arrow"]},Iw,t)})(he),me="function"==typeof x.transition?x.transition(he):x.transition,ye={slots:{popper:s.Popper,transition:s.Transition??P,tooltip:s.Tooltip,arrow:s.Arrow,..._},slotProps:{arrow:x.arrow??c.arrow,popper:{...I,...pe??c.popper},tooltip:x.tooltip??c.tooltip,transition:{...R,...me??c.transition}}},[ve,be]=Tw("popper",{elementType:_w,externalForwardedProps:ye,ownerState:he,className:$e(ge.popper,I?.className)}),[we,Ce]=Tw("transition",{elementType:Yv,externalForwardedProps:ye,ownerState:he}),[Ae,ke]=Tw("tooltip",{elementType:Ew,className:ge.tooltip,externalForwardedProps:ye,ownerState:he}),[Se,Te]=Tw("arrow",{elementType:Pw,className:ge.arrow,externalForwardedProps:ye,ownerState:he,ref:q});return(0,Zn.jsxs)(n.Fragment,{children:[n.cloneElement(M,ue),(0,Zn.jsx)(ve,{as:T??Sw,placement:S,anchorEl:y?{getBoundingClientRect:()=>({top:Mw.y,left:Mw.x,right:Mw.x,bottom:Mw.y,width:0,height:0})}:L,popperRef:se,open:!!L&&V,id:Y,transition:!0,...de,...be,popperOptions:fe,children:({TransitionProps:e})=>(0,Zn.jsx)(we,{timeout:N.transitions.duration.shorter,...e,...Ce,children:(0,Zn.jsxs)(Ae,{...ke,children:[E,o?(0,Zn.jsx)(Se,{...Te}):null]})})})]})})),Lw=r(64583).Promise,Hw=function(){var e=(0,n.useState)(!0),t=e[0],r=e[1],o=(0,n.useState)(!1),i=o[0],a=o[1];return(0,n.useEffect)((function(){var e=setTimeout((function(){r(!1)}),2e3);return function(){return clearTimeout(e)}}),[]),n.createElement(n.Fragment,null,n.createElement(ys,{sx:{backgroundColor:"#f5f5f5",padding:"8px",borderRadius:2,maxWidth:600}},n.createElement(Qy,{sx:{paddingLeft:"2px",paddingRight:"8px"}},n.createElement(ev,null,t?n.createElement(n.Fragment,null,n.createElement(ta,{sx:{fontWeight:"bold",fontSize:"18px",padding:"6px 0"},color:"primary"},ps.success.loading.title),n.createElement(ys,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:120}},n.createElement(es,{sx:{color:"#0288D1"},size:30})),n.createElement(ta,{sx:{padding:"6px 0"}},ps.success.loading.description)):n.createElement(n.Fragment,null,n.createElement(ta,{sx:{fontWeight:"bold",fontSize:"18px",padding:"6px 0"},color:"primary"},ps.success.title),n.createElement(ys,{sx:{background:"#d4f5d4",borderLeft:"6px solid #219653",borderRadius:2,px:2,py:2,mb:2,borderRight:"4px"}},n.createElement(ta,{variant:"body1",sx:{color:"#218838"}},ps.success.success_msg)),n.createElement(ta,{variant:"body1",paragraph:!0},ps.success.description),n.createElement(Bw,{placement:"top",title:"This action will delete the reported email from your inbox."},n.createElement(ds,{variant:"contained",color:"primary",style:{textTransform:"capitalize"},onClick:function(){return e=void 0,t=void 0,n=function(){var e,t,r,n,o;return function(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,(function(i){switch(i.label){case 0:if(i.trys.push([0,2,3,4]),a(!0),e=localStorage.getItem("access_token"),t=window.Office.context.mailbox.item,r=t.itemId,!e)throw new Error("Access token is missing. Please sign in again.");if(!r)throw new Error("No email selected to delete.");return n=window.Office.context.mailbox.convertToRestId(r,Office.MailboxEnums.RestVersion.v2_0),[4,Tv(e,n,(function(e,t){e?(console.error("Error deleting email:",e),kv.error("Failed to delete email")):t&&(console.log("Email deleted from Outlook"),kv.success("Email successfully processed and deleted"))}))];case 1:return i.sent(),[3,4];case 2:return o=i.sent(),console.error("Error processing email:",o),kv.error("Failed to process email"),[3,4];case 3:return a(!1),[7];case 4:return[2]}}))},new((r=void 0)||(r=Lw))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}));var e,t,r,n},disabled:i},i?ps.success.buttons.deleting:ps.success.buttons.done)))))))},$w=function(){return n.createElement(ie,null,n.createElement(ce,null,n.createElement(ae,{path:"/",element:n.createElement(jy,null)}),n.createElement(ae,{path:"/phishing",element:n.createElement(Rv,null)}),n.createElement(ae,{path:"/phishing-page",element:n.createElement(Hw,null)})))},qw=function(){return n.createElement(n.Fragment,null,n.createElement($w,null))};const Fw=Symbol.for("fui.slotRenderFunction"),Dw=Symbol.for("fui.slotElementType"),Uw=Symbol.for("fui.slotClassNameProp");function jw(e){return Boolean(null==e?void 0:e.hasOwnProperty(Dw))}function zw(e,t){return function(r,n,o,i,a){return jw(n)?t(function(e,t){return{...t,[Dw]:e}}(r,n),null,o,i,a):jw(r)?t(r,n,o,i,a):e(r,n,o,i,a)}}function Kw(e){const{as:t,[Uw]:r,[Dw]:n,[Fw]:o,...i}=e,a=i,s="string"==typeof n&&null!=t?t:n;return"string"!=typeof s&&t&&(a.as=t),{elementType:s,props:a,renderFunction:o}}r(44363);const Ww=eo,Gw=zw(Ww.jsx,((e,t,r)=>{const{elementType:o,renderFunction:i,props:a}=Kw(e),s={...a,...t};return i?Ww.jsx(n.Fragment,{children:i(o,s)},r):Ww.jsx(o,s,r)})),Vw=zw(Ww.jsxs,((e,t,r)=>{const{elementType:o,renderFunction:i,props:a}=Kw(e),s={...a,...t};return i?Ww.jsx(n.Fragment,{children:i(o,{...s,children:Ww.jsxs(n.Fragment,{children:s.children},void 0)})},r):Ww.jsxs(o,s,r)}));function Yw(){return"undefined"!=typeof window&&!(!window.document||!window.document.createElement)}const Qw=n.createContext("ltr"),Jw=({children:e,dir:t})=>n.createElement(Qw.Provider,{value:t},e),Xw=n.createContext(void 0),Zw={targetDocument:"object"==typeof document?document:void 0,dir:"ltr"},eC=Xw.Provider;function tC(){var e;return null!==(e=n.useContext(Xw))&&void 0!==e?e:Zw}const rC=n.createContext(void 0),nC=rC.Provider,oC=n.createContext(void 0).Provider,iC=n.createContext(void 0),aC=iC.Provider,sC=n.createContext(void 0).Provider,cC=n.createContext(void 0),lC=cC.Provider,uC=n.createContext(void 0).Provider,dC="undefined"==typeof window?r.g:window,hC="@griffel/";function pC(e,t){return dC[Symbol.for(hC+e)]||(dC[Symbol.for(hC+e)]=t),dC[Symbol.for(hC+e)]}const fC=pC("DEFINITION_LOOKUP_TABLE",{}),gC="data-make-styles-bucket";const mC=["r","d","l","v","w","f","i","h","a","s","k","t","m","c"].reduce(((e,t,r)=>(e[t]=r,e)),{});function yC(e,t,r,n,o={}){var i,a;const s="m"===e,c=null!==(i=o.m)&&void 0!==i?i:"0",l=null!==(a=o.p)&&void 0!==a?a:0,u=function(e,t,r){return("m"===e?e+t:e)+r}(e,c,l);if(!n.stylesheets[u]){const i=t&&t.createElement("style"),a=function(e,t,r,n){const o=[];if(n[gC]=t,n["data-priority"]=String(r),e)for(const t in n)e.setAttribute(t,n[t]);return{elementAttributes:n,insertRule:function(t){return(null==e?void 0:e.sheet)?e.sheet.insertRule(t,e.sheet.cssRules.length):o.push(t)},element:e,bucketName:t,cssRules(){return(null==e?void 0:e.sheet)?Array.from(e.sheet.cssRules).map((e=>e.cssText)):o}}}(i,e,l,Object.assign({},n.styleElementAttributes,s&&{media:c}));n.stylesheets[u]=a,(null==t?void 0:t.head)&&i&&t.head.insertBefore(i,function(e,t,r,n,o={}){var i,a;const s=mC[r],c=null!==(i=o.m)&&void 0!==i?i:"",l=null!==(a=o.p)&&void 0!==a?a:0;let u=e=>s-mC[e.getAttribute(gC)],d=e.head.querySelectorAll(`[${gC}]`);if("m"===r){const t=e.head.querySelectorAll(`[${gC}="${r}"]`);t.length&&(d=t,u=e=>n.compareMediaQueries(c,e.media))}const h=d.length;let p=h-1;for(;p>=0;){const e=d.item(p);if((function(e,t,r){var n,o;return t+(null!==(n=r.m)&&void 0!==n?n:"")===e.getAttribute(gC)+(null!==(o=e.media)&&void 0!==o?o:"")}(f=e,r,o)?l-Number(f.getAttribute("data-priority")):u(f))>0)return e.nextSibling;p--}var f;return h>0?d.item(0):t?t.nextSibling:null}(t,r,e,n,o))}return n.stylesheets[u]}function vC(e,t){try{e.insertRule(t)}catch(e){}}let bC=0;const wC=(e,t)=>e<t?-1:e>t?1:0;function CC(e=("undefined"==typeof document?void 0:document),t={}){const{classNameHashSalt:r,unstable_filterCSSRule:n,insertionPoint:o,styleElementAttributes:i,compareMediaQueries:a=wC}=t,s={classNameHashSalt:r,insertionCache:{},stylesheets:{},styleElementAttributes:Object.freeze(i),compareMediaQueries:a,id:"d"+bC++,insertCSSRules(t){for(const i in t){const a=t[i];for(let t=0,c=a.length;t<c;t++){const[c,l]=(r=a[t],Array.isArray(r)?r:[r]),u=yC(i,e,o||null,s,l);s.insertionCache[c]||(s.insertionCache[c]=i,n?n(c)&&vC(u,c):vC(u,c))}}var r}};return s}const AC=n.createContext(CC());function kC(){return n.useContext(AC)}function SC(e,t){var r;const n=e;var o;return Boolean((null==n||null===(r=n.ownerDocument)||void 0===r?void 0:r.defaultView)&&n instanceof n.ownerDocument.defaultView[null!==(o=null==t?void 0:t.constructorName)&&void 0!==o?o:"HTMLElement"])}var TC="undefined"!=typeof WeakRef,IC=class{constructor(e){TC&&"object"==typeof e?this._weakRef=new WeakRef(e):this._instance=e}deref(){var e,t;let r;return this._weakRef?(r=null==(e=this._weakRef)?void 0:e.deref(),r||delete this._weakRef):(r=this._instance,(null==(t=null==r?void 0:r.isDisposed)?void 0:t.call(r))&&delete this._instance),r}},xC="keyborg:focusin",_C=!1,EC=0,PC=class{constructor(e,t){this._isNavigatingWithKeyboard_DO_NOT_USE=!1,this._onFocusIn=e=>{if(this._isMouseOrTouchUsedTimer)return;if(this.isNavigatingWithKeyboard)return;const t=e.detail;t.relatedTarget&&(t.isFocusedProgrammatically||void 0===t.isFocusedProgrammatically||(this.isNavigatingWithKeyboard=!0))},this._onMouseDown=e=>{0===e.buttons||0===e.clientX&&0===e.clientY&&0===e.screenX&&0===e.screenY||this._onMouseOrTouch()},this._onMouseOrTouch=()=>{const e=this._win;e&&(this._isMouseOrTouchUsedTimer&&e.clearTimeout(this._isMouseOrTouchUsedTimer),this._isMouseOrTouchUsedTimer=e.setTimeout((()=>{delete this._isMouseOrTouchUsedTimer}),1e3)),this.isNavigatingWithKeyboard=!1},this._onKeyDown=e=>{this.isNavigatingWithKeyboard?this._shouldDismissKeyboardNavigation(e)&&this._scheduleDismiss():this._shouldTriggerKeyboardNavigation(e)&&(this.isNavigatingWithKeyboard=!0)},this.id="c"+ ++EC,this._win=e;const r=e.document;if(t){const e=t.triggerKeys,r=t.dismissKeys;(null==e?void 0:e.length)&&(this._triggerKeys=new Set(e)),(null==r?void 0:r.length)&&(this._dismissKeys=new Set(r))}r.addEventListener(xC,this._onFocusIn,!0),r.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("keydown",this._onKeyDown,!0),r.addEventListener("touchstart",this._onMouseOrTouch,!0),r.addEventListener("touchend",this._onMouseOrTouch,!0),r.addEventListener("touchcancel",this._onMouseOrTouch,!0),function(e){const t=e;_C||(_C=function(e){const t=e.HTMLElement,r=t.prototype.focus;let n=!1;return t.prototype.focus=function(){n=!0},e.document.createElement("button").focus(),t.prototype.focus=r,n}(t));const r=t.HTMLElement.prototype.focus;if(r.__keyborgNativeFocus)return;t.HTMLElement.prototype.focus=c;const n=new Set,o=e=>{const t=e.target;if(!t)return;const r=new CustomEvent("keyborg:focusout",{cancelable:!0,bubbles:!0,composed:!0,detail:{originalEvent:e}});t.dispatchEvent(r)},i=e=>{const t=e.target;if(!t)return;let r=e.composedPath()[0];const s=new Set;for(;r;)r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?(s.add(r),r=r.host):r=r.parentNode;for(const e of n){const t=e.deref();t&&s.has(t)||(n.delete(e),t&&(t.removeEventListener("focusin",i,!0),t.removeEventListener("focusout",o,!0)))}a(t,e.relatedTarget||void 0)},a=(e,t,r)=>{var a;const c=e.shadowRoot;if(c){for(const e of n)if(e.deref()===c)return;return c.addEventListener("focusin",i,!0),c.addEventListener("focusout",o,!0),void n.add(new IC(c))}const l={relatedTarget:t,originalEvent:r},u=new CustomEvent(xC,{cancelable:!0,bubbles:!0,composed:!0,detail:l});u.details=l,(_C||s.lastFocusedProgrammatically)&&(l.isFocusedProgrammatically=e===(null==(a=s.lastFocusedProgrammatically)?void 0:a.deref()),s.lastFocusedProgrammatically=void 0),e.dispatchEvent(u)},s=t.__keyborgData={focusInHandler:i,focusOutHandler:o,shadowTargets:n};function c(){const e=t.__keyborgData;return e&&(e.lastFocusedProgrammatically=new IC(this)),r.apply(this,arguments)}t.document.addEventListener("focusin",t.__keyborgData.focusInHandler,!0),t.document.addEventListener("focusout",t.__keyborgData.focusOutHandler,!0);let l=t.document.activeElement;for(;l&&l.shadowRoot;)a(l),l=l.shadowRoot.activeElement;c.__keyborgNativeFocus=r}(e)}get isNavigatingWithKeyboard(){return this._isNavigatingWithKeyboard_DO_NOT_USE}set isNavigatingWithKeyboard(e){this._isNavigatingWithKeyboard_DO_NOT_USE!==e&&(this._isNavigatingWithKeyboard_DO_NOT_USE=e,this.update())}dispose(){const e=this._win;if(e){this._isMouseOrTouchUsedTimer&&(e.clearTimeout(this._isMouseOrTouchUsedTimer),this._isMouseOrTouchUsedTimer=void 0),this._dismissTimer&&(e.clearTimeout(this._dismissTimer),this._dismissTimer=void 0),function(e){const t=e,r=t.HTMLElement.prototype,n=r.focus.__keyborgNativeFocus,o=t.__keyborgData;if(o){t.document.removeEventListener("focusin",o.focusInHandler,!0),t.document.removeEventListener("focusout",o.focusOutHandler,!0);for(const e of o.shadowTargets){const t=e.deref();t&&(t.removeEventListener("focusin",o.focusInHandler,!0),t.removeEventListener("focusout",o.focusOutHandler,!0))}o.shadowTargets.clear(),delete t.__keyborgData}n&&(r.focus=n)}(e);const t=e.document;t.removeEventListener(xC,this._onFocusIn,!0),t.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("keydown",this._onKeyDown,!0),t.removeEventListener("touchstart",this._onMouseOrTouch,!0),t.removeEventListener("touchend",this._onMouseOrTouch,!0),t.removeEventListener("touchcancel",this._onMouseOrTouch,!0),delete this._win}}isDisposed(){return!!this._win}update(){var e,t;const r=null==(t=null==(e=this._win)?void 0:e.__keyborg)?void 0:t.refs;if(r)for(const e of Object.keys(r))RC.update(r[e],this.isNavigatingWithKeyboard)}_shouldTriggerKeyboardNavigation(e){var t;if("Tab"===e.key)return!0;const r=null==(t=this._win)?void 0:t.document.activeElement,n=!this._triggerKeys||this._triggerKeys.has(e.keyCode),o=r&&("INPUT"===r.tagName||"TEXTAREA"===r.tagName||r.isContentEditable);return n&&!o}_shouldDismissKeyboardNavigation(e){var t;return null==(t=this._dismissKeys)?void 0:t.has(e.keyCode)}_scheduleDismiss(){const e=this._win;if(e){this._dismissTimer&&(e.clearTimeout(this._dismissTimer),this._dismissTimer=void 0);const t=e.document.activeElement;this._dismissTimer=e.setTimeout((()=>{this._dismissTimer=void 0;const r=e.document.activeElement;t&&r&&t===r&&(this.isNavigatingWithKeyboard=!1)}),500)}}},RC=class e{constructor(e,t){this._cb=[],this._id="k"+ ++EC,this._win=e;const r=e.__keyborg;r?(this._core=r.core,r.refs[this._id]=this):(this._core=new PC(e,t),e.__keyborg={core:this._core,refs:{[this._id]:this}})}static create(t,r){return new e(t,r)}static dispose(e){e.dispose()}static update(e,t){e._cb.forEach((e=>e(t)))}dispose(){var e;const t=null==(e=this._win)?void 0:e.__keyborg;(null==t?void 0:t.refs[this._id])&&(delete t.refs[this._id],0===Object.keys(t.refs).length&&(t.core.dispose(),delete this._win.__keyborg)),this._cb=[],delete this._core,delete this._win}isNavigatingWithKeyboard(){var e;return!!(null==(e=this._core)?void 0:e.isNavigatingWithKeyboard)}subscribe(e){this._cb.push(e)}unsubscribe(e){const t=this._cb.indexOf(e);t>=0&&this._cb.splice(t,1)}setVal(e){this._core&&(this._core.isNavigatingWithKeyboard=e)}};const OC="data-fui-focus-visible";function MC(e,t){if(NC(e))return()=>{};const r={current:void 0},n=(o=t,RC.create(o,undefined));var o;function i(e){n.isNavigatingWithKeyboard()&&SC(e)&&(r.current=e,e.setAttribute(OC,""))}function a(){r.current&&(r.current.removeAttribute(OC),r.current=void 0)}n.subscribe((e=>{e?i(t.document.activeElement):a()}));const s=e=>{a(),i(e.composedPath()[0])},c=t=>{(!t.relatedTarget||SC(t.relatedTarget)&&!e.contains(t.relatedTarget))&&a()};return e.addEventListener(xC,s),e.addEventListener("focusout",c),e.focusVisible=!0,e.contains(t.document.activeElement)&&i(t.document.activeElement),()=>{var t;a(),e.removeEventListener(xC,s),e.removeEventListener("focusout",c),delete e.focusVisible,t=n,RC.dispose(t)}}function NC(e){return!!e&&(!!e.focusVisible||NC(null==e?void 0:e.parentElement))}function BC(e={}){const t=tC(),r=n.useRef(null);var o;const i=null!==(o=e.targetDocument)&&void 0!==o?o:t.targetDocument;return n.useEffect((()=>{if((null==i?void 0:i.defaultView)&&r.current)return MC(r.current,i.defaultView)}),[r,i]),r}function LC(e,t){const{defaultProps:r,elementType:o}=t,i=function(e){return"string"==typeof e||"number"==typeof e||Array.isArray(e)||n.isValidElement(e)?{children:e}:e}(e),a={...r,...i,[Dw]:o,[Uw]:null==i?void 0:i.className};return i&&"function"==typeof i.children&&(a[Fw]=i.children,a.children=null==r?void 0:r.children),a}const HC=(...e)=>{const t={};for(const r of e){const e=Array.isArray(r)?r:Object.keys(r);for(const r of e)t[r]=1}return t},$C=HC(["onAuxClick","onAnimationEnd","onAnimationStart","onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),qC=HC(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","ref","role","style","tabIndex","title","translate","spellCheck","name"]),FC=HC(["itemID","itemProp","itemRef","itemScope","itemType"]),DC=HC(qC,$C,FC),UC=HC(DC,["form"]),jC=HC(DC,["height","loop","muted","preload","src","width"]),zC=HC(jC,["poster"]),KC=HC(DC,["start"]),WC=HC(DC,["value"]),GC=HC(DC,["download","href","hrefLang","media","rel","target","type"]),VC=HC(DC,["dateTime"]),YC=HC(DC,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","type","value"]),QC={label:UC,audio:jC,video:zC,ol:KC,li:WC,a:GC,button:YC,input:HC(YC,["accept","alt","autoCorrect","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","minLength","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),textarea:HC(YC,["autoCapitalize","cols","dirname","form","maxLength","placeholder","readOnly","required","rows","wrap"]),select:HC(YC,["form","multiple","required"]),option:HC(DC,["selected","value"]),table:HC(DC,["cellPadding","cellSpacing"]),tr:DC,th:HC(DC,["colSpan","rowSpan","scope"]),td:HC(DC,["colSpan","headers","rowSpan","scope"]),colGroup:HC(DC,["span"]),col:HC(DC,["span"]),fieldset:HC(DC,["disabled","form"]),form:HC(DC,["acceptCharset","action","encType","encType","method","noValidate","target"]),iframe:HC(DC,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),img:HC(DC,["alt","crossOrigin","height","src","srcSet","useMap","width"]),time:VC,dialog:HC(DC,["open","onCancel","onClose"])};const JC=(e,t,r)=>{var n;return function(e,t,r){const n=e&&QC[e]||DC;return n.as=1,function(e,t,r){const n=Array.isArray(t),o={},i=Object.keys(e);for(const a of i)!(!n&&t[a]||n&&t.indexOf(a)>=0||0===a.indexOf("data-")||0===a.indexOf("aria-"))||r&&-1!==(null==r?void 0:r.indexOf(a))||(o[a]=e[a]);return o}(t,n,r)}(null!==(n=t.as)&&void 0!==n?n:e,t,r)};function XC(...e){const t=n.useCallback((r=>{t.current=r;for(const t of e)"function"==typeof t?t(r):t&&(t.current=r)}),[...e]);return t}const ZC=Yw()?n.useLayoutEffect:n.useEffect,eA={current:0},tA=n.createContext(void 0);const rA=n.createContext(void 0);function nA(e="fui-",t){const r=null!==(s=n.useContext(tA))&&void 0!==s?s:eA,i=n.useContext(rA)||"",a=o.useId;var s;if(a){const r=a(),o=n.useMemo((()=>r.replace(/:/g,"")),[r]);return t||`${i}${e}${o}`}return n.useMemo((()=>t||`${i}${e}${++r.current}`),[i,e,t,r])}rA.Provider;const oA=()=>{const e={};return function(t,r){void 0===e[t.id]&&(t.insertCSSRules(r),e[t.id]=!0)}};function iA(e,t,r=[]){return"___"+function(e){const t=e.length;if(7===t)return e;for(let r=t;r<7;r++)e+="0";return e}(Zt(e+t))}function aA(e,t){let r="",n="";for(const o in e){const i=e[o];if(0===i){n+=o+" ";continue}const a=Array.isArray(i),s="rtl"===t?(a?i[1]:i)+" ":(a?i[0]:i)+" ";r+=s,n+=s}return[r.slice(0,-1),n.slice(0,-1)]}function sA(e,t){const r={};for(const n in e){const[o,i]=aA(e[n],t);if(""===i){r[n]="";continue}const a=iA(i,t),s=a+(""===o?"":" "+o);fC[a]=[e[n],t],r[n]=s}return r}function cA(e,t,r=oA){const n=r();let o=null,i=null;return function(r){const{dir:a,renderer:s}=r,c="ltr"===a;return c?null===o&&(o=sA(e,a)):null===i&&(i=sA(e,a)),n(s,t),c?o:i}}const lA={},uA="fui-FluentProvider",dA=cA({root:{sj55zd:"f19n0e5",De3pzq:"fxugw4r",fsow6f:["f1o700av","fes3tcz"],Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"}},{d:[".f19n0e5{color:var(--colorNeutralForeground1);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f1o700av{text-align:left;}",".fes3tcz{text-align:right;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}"]}),hA=o.useInsertionEffect?o.useInsertionEffect:ZC,pA={},fA={},gA=(e,t)=>{const r=tC(),o=n.useContext(rC),i=null!==(a=n.useContext(cC))&&void 0!==a?a:{};var a;const s=n.useContext(iC)||pA,{applyStylesToPortals:c=!0,customStyleHooks_unstable:l,dir:u=r.dir,targetDocument:d=r.targetDocument,theme:h,overrides_unstable:p={}}=e,f=mA(o,h),g=mA(i,p),m=mA(s,l),y=kC();var v;const{styleTagId:b,rule:w}=(e=>{const{targetDocument:t,theme:r,rendererAttributes:o}=e,i=n.useRef(),a=nA(uA),s=o,c=n.useMemo((()=>function(e,t){return t?`${e} { ${Object.keys(t).reduce(((e,r)=>`${e}--${r}: ${t[r]}; `),"")} }`:`${e} {}`}(`.${a}`,r)),[r,a]);return function(e,t){n.useState((()=>{if(!e)return;const r=e.getElementById(t);r&&e.head.append(r)}))}(t,a),hA((()=>{const e=null==t?void 0:t.getElementById(a);return e?i.current=e:(i.current=((e,t)=>{if(!(null==e?void 0:e.head))return;const r=e.createElement("style");return Object.keys(t).forEach((e=>{r.setAttribute(e,t[e])})),e.head.appendChild(r),r})(t,{...s,id:a}),i.current&&((e,t)=>{const r=e.sheet;r&&(r.cssRules.length>0&&r.deleteRule(0),r.insertRule(t,0))})(i.current,c)),()=>{var e;null===(e=i.current)||void 0===e||e.remove()}}),[a,t,c,s]),{styleTagId:a,rule:c}})({theme:f,targetDocument:d,rendererAttributes:null!==(v=y.styleElementAttributes)&&void 0!==v?v:fA});return{applyStylesToPortals:c,customStyleHooks_unstable:m,dir:u,targetDocument:d,theme:f,overrides_unstable:g,themeClassName:b,components:{root:"div"},root:LC(JC("div",{...e,dir:u,ref:XC(t,BC({targetDocument:d}))}),{elementType:"div"}),serverStyleProps:{cssRule:w,attributes:{...y.styleElementAttributes,id:b}}}};function mA(e,t){return e&&t?{...e,...t}:e||t}const yA=n.forwardRef(((e,t)=>{const r=gA(e,t);(e=>{const t=kC(),r=dA({dir:e.dir,renderer:t});e.root.className=function(){let e=null,t="",r="";const n=new Array(arguments.length);for(let e=0;e<arguments.length;e++){const o=arguments[e];if("string"==typeof o&&""!==o){const i=o.indexOf("___");if(-1===i)t+=o+" ";else{const a=o.substr(i,10);i>0&&(t+=o.slice(0,i)),r+=a,n[e]=a}}}if(""===r)return t.slice(0,-1);const o=lA[r];if(void 0!==o)return t+o;const i=[];for(let t=0;t<arguments.length;t++){const r=n[t];if(r){const t=fC[r];t&&(i.push(t[0]),e=t[1])}}const a=Object.assign.apply(Object,[{}].concat(i)),[s,c]=aA(a,e),l=iA(c,e,n),u=l+" "+s;return lA[r]=u,fC[l]=[a,e],t+u}(uA,e.themeClassName,r.root,e.root.className)})(r);const o=function(e){const{applyStylesToPortals:t,customStyleHooks_unstable:r,dir:o,root:i,targetDocument:a,theme:s,themeClassName:c,overrides_unstable:l}=e,u=n.useMemo((()=>({dir:o,targetDocument:a})),[o,a]),[d]=n.useState((()=>({}))),h=n.useMemo((()=>({textDirection:o})),[o]);return{customStyleHooks_unstable:r,overrides_unstable:l,provider:u,textDirection:o,iconDirection:h,tooltip:d,theme:s,themeClassName:t?i.className:c}}(r);return((e,t)=>Gw(eC,{value:t.provider,children:Gw(nC,{value:t.theme,children:Gw(oC,{value:t.themeClassName,children:Gw(aC,{value:t.customStyleHooks_unstable,children:Gw(sC,{value:t.tooltip,children:Gw(Jw,{dir:t.textDirection,children:Gw(uC,{value:t.iconDirection,children:Gw(lC,{value:t.overrides_unstable,children:Vw(e.root,{children:[Yw()?null:Gw("style",{dangerouslySetInnerHTML:{__html:e.serverStyleProps.cssRule},...e.serverStyleProps.attributes}),e.root.children]})})})})})})})})}))(r,o)}));yA.displayName="FluentProvider";const vA="#242424",bA="#424242",wA="#616161",CA="#bdbdbd",AA="#e0e0e0",kA="#e6e6e6",SA="#ebebeb",TA="#f0f0f0",IA="#f5f5f5",xA="#fafafa",_A="rgba(255, 255, 255, 0.4)",EA="rgba(255, 255, 255, 0.5)",PA="rgba(0, 0, 0, 0.05)",RA="rgba(0, 0, 0, 0.1)",OA="#ffffff",MA={shade50:"#200205",shade40:"#3b0509",shade30:"#6e0811",shade20:"#960b18",shade10:"#b10e1c",primary:"#c50f1f",tint10:"#cc2635",tint20:"#d33f4c",tint30:"#dc626d",tint40:"#eeacb2",tint50:"#f6d1d5",tint60:"#fdf3f4"},NA={shade50:"#031403",shade40:"#052505",shade30:"#094509",shade20:"#0c5e0c",shade10:"#0e700e",primary:"#107c10",tint10:"#218c21",tint20:"#359b35",tint30:"#54b054",tint40:"#9fd89f",tint50:"#c9eac9",tint60:"#f1faf1"},BA={red:{shade50:"#210809",shade40:"#3f1011",shade30:"#751d1f",shade20:"#9f282b",shade10:"#bc2f32",primary:"#d13438",tint10:"#d7494c",tint20:"#dc5e62",tint30:"#e37d80",tint40:"#f1bbbc",tint50:"#f8dadb",tint60:"#fdf6f6"},green:NA,darkOrange:{shade50:"#230900",shade40:"#411200",shade30:"#7a2101",shade20:"#a62d01",shade10:"#c43501",primary:"#da3b01",tint10:"#de501c",tint20:"#e36537",tint30:"#e9835e",tint40:"#f4bfab",tint50:"#f9dcd1",tint60:"#fdf6f3"},yellow:{shade50:"#282400",shade40:"#4c4400",shade30:"#817400",shade20:"#c0ad00",shade10:"#e4cc00",primary:"#fde300",tint10:"#fde61e",tint20:"#fdea3d",tint30:"#feee66",tint40:"#fef7b2",tint50:"#fffad6",tint60:"#fffef5"},berry:{shade50:"#1f091d",shade40:"#3a1136",shade30:"#6d2064",shade20:"#932b88",shade10:"#af33a1",primary:"#c239b3",tint10:"#c94cbc",tint20:"#d161c4",tint30:"#da7ed0",tint40:"#edbbe7",tint50:"#f5daf2",tint60:"#fdf5fc"},lightGreen:{shade50:"#031a02",shade40:"#063004",shade30:"#0b5a08",shade20:"#0e7a0b",shade10:"#11910d",primary:"#13a10e",tint10:"#27ac22",tint20:"#3db838",tint30:"#5ec75a",tint40:"#a7e3a5",tint50:"#cef0cd",tint60:"#f2fbf2"},marigold:{shade50:"#251a00",shade40:"#463100",shade30:"#835b00",shade20:"#b27c00",shade10:"#d39300",primary:"#eaa300",tint10:"#edad1c",tint20:"#efb839",tint30:"#f2c661",tint40:"#f9e2ae",tint50:"#fcefd3",tint60:"#fefbf4"}},LA={darkRed:{shade50:"#130204",shade40:"#230308",shade30:"#420610",shade20:"#590815",shade10:"#690a19",primary:"#750b1c",tint10:"#861b2c",tint20:"#962f3f",tint30:"#ac4f5e",tint40:"#d69ca5",tint50:"#e9c7cd",tint60:"#f9f0f2"},cranberry:MA,pumpkin:{shade50:"#200d03",shade40:"#3d1805",shade30:"#712d09",shade20:"#9a3d0c",shade10:"#b6480e",primary:"#ca5010",tint10:"#d06228",tint20:"#d77440",tint30:"#df8e64",tint40:"#efc4ad",tint50:"#f7dfd2",tint60:"#fdf7f4"},peach:{shade50:"#291600",shade40:"#4d2a00",shade30:"#8f4e00",shade20:"#c26a00",shade10:"#e67e00",primary:"#ff8c00",tint10:"#ff9a1f",tint20:"#ffa83d",tint30:"#ffba66",tint40:"#ffddb3",tint50:"#ffedd6",tint60:"#fffaf5"},gold:{shade50:"#1f1900",shade40:"#3a2f00",shade30:"#6c5700",shade20:"#937700",shade10:"#ae8c00",primary:"#c19c00",tint10:"#c8a718",tint20:"#d0b232",tint30:"#dac157",tint40:"#ecdfa5",tint50:"#f5eece",tint60:"#fdfbf2"},brass:{shade50:"#181202",shade40:"#2e2103",shade30:"#553e06",shade20:"#745408",shade10:"#89640a",primary:"#986f0b",tint10:"#a47d1e",tint20:"#b18c34",tint30:"#c1a256",tint40:"#e0cea2",tint50:"#efe4cb",tint60:"#fbf8f2"},brown:{shade50:"#170e07",shade40:"#2b1a0e",shade30:"#50301a",shade20:"#6c4123",shade10:"#804d29",primary:"#8e562e",tint10:"#9c663f",tint20:"#a97652",tint30:"#bb8f6f",tint40:"#ddc3b0",tint50:"#edded3",tint60:"#faf7f4"},forest:{shade50:"#0c1501",shade40:"#162702",shade30:"#294903",shade20:"#376304",shade10:"#427505",primary:"#498205",tint10:"#599116",tint20:"#6ba02b",tint30:"#85b44c",tint40:"#bdd99b",tint50:"#dbebc7",tint60:"#f6faf0"},seafoam:{shade50:"#002111",shade40:"#003d20",shade30:"#00723b",shade20:"#009b51",shade10:"#00b85f",primary:"#00cc6a",tint10:"#19d279",tint20:"#34d889",tint30:"#5ae0a0",tint40:"#a8f0cd",tint50:"#cff7e4",tint60:"#f3fdf8"},darkGreen:{shade50:"#021102",shade40:"#032003",shade30:"#063b06",shade20:"#085108",shade10:"#0a5f0a",primary:"#0b6a0b",tint10:"#1a7c1a",tint20:"#2d8e2d",tint30:"#4da64d",tint40:"#9ad29a",tint50:"#c6e7c6",tint60:"#f0f9f0"},lightTeal:{shade50:"#001d1f",shade40:"#00373a",shade30:"#00666d",shade20:"#008b94",shade10:"#00a5af",primary:"#00b7c3",tint10:"#18bfca",tint20:"#32c8d1",tint30:"#58d3db",tint40:"#a6e9ed",tint50:"#cef3f5",tint60:"#f2fcfd"},teal:{shade50:"#001516",shade40:"#012728",shade30:"#02494c",shade20:"#026467",shade10:"#037679",primary:"#038387",tint10:"#159195",tint20:"#2aa0a4",tint30:"#4cb4b7",tint40:"#9bd9db",tint50:"#c7ebec",tint60:"#f0fafa"},steel:{shade50:"#000f12",shade40:"#001b22",shade30:"#00333f",shade20:"#004555",shade10:"#005265",primary:"#005b70",tint10:"#0f6c81",tint20:"#237d92",tint30:"#4496a9",tint40:"#94c8d4",tint50:"#c3e1e8",tint60:"#eff7f9"},blue:{shade50:"#001322",shade40:"#002440",shade30:"#004377",shade20:"#005ba1",shade10:"#006cbf",primary:"#0078d4",tint10:"#1a86d9",tint20:"#3595de",tint30:"#5caae5",tint40:"#a9d3f2",tint50:"#d0e7f8",tint60:"#f3f9fd"},royalBlue:{shade50:"#000c16",shade40:"#00172a",shade30:"#002c4e",shade20:"#003b6a",shade10:"#00467e",primary:"#004e8c",tint10:"#125e9a",tint20:"#286fa8",tint30:"#4a89ba",tint40:"#9abfdc",tint50:"#c7dced",tint60:"#f0f6fa"},cornflower:{shade50:"#0d1126",shade40:"#182047",shade30:"#2c3c85",shade20:"#3c51b4",shade10:"#4760d5",primary:"#4f6bed",tint10:"#637cef",tint20:"#778df1",tint30:"#93a4f4",tint40:"#c8d1fa",tint50:"#e1e6fc",tint60:"#f7f9fe"},navy:{shade50:"#00061d",shade40:"#000c36",shade30:"#001665",shade20:"#001e89",shade10:"#0023a2",primary:"#0027b4",tint10:"#173bbd",tint20:"#3050c6",tint30:"#546fd2",tint40:"#a3b2e8",tint50:"#ccd5f3",tint60:"#f2f4fc"},lavender:{shade50:"#120f25",shade40:"#221d46",shade30:"#3f3682",shade20:"#5649b0",shade10:"#6656d1",primary:"#7160e8",tint10:"#8172eb",tint20:"#9184ee",tint30:"#a79cf1",tint40:"#d2ccf8",tint50:"#e7e4fb",tint60:"#f9f8fe"},purple:{shade50:"#0f0717",shade40:"#1c0e2b",shade30:"#341a51",shade20:"#46236e",shade10:"#532982",primary:"#5c2e91",tint10:"#6b3f9e",tint20:"#7c52ab",tint30:"#9470bd",tint40:"#c6b1de",tint50:"#e0d3ed",tint60:"#f7f4fb"},grape:{shade50:"#160418",shade40:"#29072e",shade30:"#4c0d55",shade20:"#671174",shade10:"#7a1589",primary:"#881798",tint10:"#952aa4",tint20:"#a33fb1",tint30:"#b55fc1",tint40:"#d9a7e0",tint50:"#eaceef",tint60:"#faf2fb"},lilac:{shade50:"#1c0b1f",shade40:"#35153a",shade30:"#63276d",shade20:"#863593",shade10:"#9f3faf",primary:"#b146c2",tint10:"#ba58c9",tint20:"#c36bd1",tint30:"#cf87da",tint40:"#e6bfed",tint50:"#f2dcf5",tint60:"#fcf6fd"},pink:{shade50:"#24091b",shade40:"#441232",shade30:"#80215d",shade20:"#ad2d7e",shade10:"#cd3595",primary:"#e43ba6",tint10:"#e750b0",tint20:"#ea66ba",tint30:"#ef85c8",tint40:"#f7c0e3",tint50:"#fbddf0",tint60:"#fef6fb"},magenta:{shade50:"#1f0013",shade40:"#390024",shade30:"#6b0043",shade20:"#91005a",shade10:"#ac006b",primary:"#bf0077",tint10:"#c71885",tint20:"#ce3293",tint30:"#d957a8",tint40:"#eca5d1",tint50:"#f5cee6",tint60:"#fcf2f9"},plum:{shade50:"#13000c",shade40:"#240017",shade30:"#43002b",shade20:"#5a003b",shade10:"#6b0045",primary:"#77004d",tint10:"#87105d",tint20:"#98246f",tint30:"#ad4589",tint40:"#d696c0",tint50:"#e9c4dc",tint60:"#faf0f6"},beige:{shade50:"#141313",shade40:"#252323",shade30:"#444241",shade20:"#5d5958",shade10:"#6e6968",primary:"#7a7574",tint10:"#8a8584",tint20:"#9a9594",tint30:"#afabaa",tint40:"#d7d4d4",tint50:"#eae8e8",tint60:"#faf9f9"},mink:{shade50:"#0f0e0e",shade40:"#1c1b1a",shade30:"#343231",shade20:"#474443",shade10:"#54514f",primary:"#5d5a58",tint10:"#706d6b",tint20:"#84817e",tint30:"#9e9b99",tint40:"#cecccb",tint50:"#e5e4e3",tint60:"#f8f8f8"},platinum:{shade50:"#111314",shade40:"#1f2426",shade30:"#3b4447",shade20:"#505c60",shade10:"#5f6d71",primary:"#69797e",tint10:"#79898d",tint20:"#89989d",tint30:"#a0adb2",tint40:"#cdd6d8",tint50:"#e4e9ea",tint60:"#f8f9fa"},anchor:{shade50:"#090a0b",shade40:"#111315",shade30:"#202427",shade20:"#2b3135",shade10:"#333a3f",primary:"#394146",tint10:"#4d565c",tint20:"#626c72",tint30:"#808a90",tint40:"#bcc3c7",tint50:"#dbdfe1",tint60:"#f6f7f8"}},HA={cranberry:MA,green:NA,orange:{shade50:"#271002",shade40:"#4a1e04",shade30:"#8a3707",shade20:"#bc4b09",shade10:"#de590b",primary:"#f7630c",tint10:"#f87528",tint20:"#f98845",tint30:"#faa06b",tint40:"#fdcfb4",tint50:"#fee5d7",tint60:"#fff9f5"}},$A={success:"green",warning:"orange",danger:"cranberry"},qA=["red","green","darkOrange","yellow","berry","lightGreen","marigold"].reduce(((e,t)=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),n={[`colorPalette${r}Background1`]:BA[t].tint60,[`colorPalette${r}Background2`]:BA[t].tint40,[`colorPalette${r}Background3`]:BA[t].primary,[`colorPalette${r}Foreground1`]:BA[t].shade10,[`colorPalette${r}Foreground2`]:BA[t].shade30,[`colorPalette${r}Foreground3`]:BA[t].primary,[`colorPalette${r}BorderActive`]:BA[t].primary,[`colorPalette${r}Border1`]:BA[t].tint40,[`colorPalette${r}Border2`]:BA[t].primary};return Object.assign(e,n)}),{});qA.colorPaletteYellowForeground1=BA.yellow.shade30,qA.colorPaletteRedForegroundInverted=BA.red.tint20,qA.colorPaletteGreenForegroundInverted=BA.green.tint20,qA.colorPaletteYellowForegroundInverted=BA.yellow.tint40;const FA=["darkRed","cranberry","pumpkin","peach","gold","brass","brown","forest","seafoam","darkGreen","lightTeal","teal","steel","blue","royalBlue","cornflower","navy","lavender","purple","grape","lilac","pink","magenta","plum","beige","mink","platinum","anchor"].reduce(((e,t)=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),n={[`colorPalette${r}Background2`]:LA[t].tint40,[`colorPalette${r}Foreground2`]:LA[t].shade30,[`colorPalette${r}BorderActive`]:LA[t].primary};return Object.assign(e,n)}),{}),DA={...qA,...FA},UA=Object.entries($A).reduce(((e,[t,r])=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),o={[`colorStatus${n}Background1`]:HA[r].tint60,[`colorStatus${n}Background2`]:HA[r].tint40,[`colorStatus${n}Background3`]:HA[r].primary,[`colorStatus${n}Foreground1`]:HA[r].shade10,[`colorStatus${n}Foreground2`]:HA[r].shade30,[`colorStatus${n}Foreground3`]:HA[r].primary,[`colorStatus${n}ForegroundInverted`]:HA[r].tint30,[`colorStatus${n}BorderActive`]:HA[r].primary,[`colorStatus${n}Border1`]:HA[r].tint40,[`colorStatus${n}Border2`]:HA[r].primary};return Object.assign(e,o)}),{});UA.colorStatusDangerBackground3Hover=HA[$A.danger].shade10,UA.colorStatusDangerBackground3Pressed=HA[$A.danger].shade20,UA.colorStatusWarningForeground1=HA[$A.warning].shade20,UA.colorStatusWarningForeground3=HA[$A.warning].shade20,UA.colorStatusWarningBorder2=HA[$A.warning].shade20;const jA={borderRadiusNone:"0",borderRadiusSmall:"2px",borderRadiusMedium:"4px",borderRadiusLarge:"6px",borderRadiusXLarge:"8px",borderRadiusCircular:"10000px"},zA={fontSizeBase100:"10px",fontSizeBase200:"12px",fontSizeBase300:"14px",fontSizeBase400:"16px",fontSizeBase500:"20px",fontSizeBase600:"24px",fontSizeHero700:"28px",fontSizeHero800:"32px",fontSizeHero900:"40px",fontSizeHero1000:"68px"},KA={lineHeightBase100:"14px",lineHeightBase200:"16px",lineHeightBase300:"20px",lineHeightBase400:"22px",lineHeightBase500:"28px",lineHeightBase600:"32px",lineHeightHero700:"36px",lineHeightHero800:"40px",lineHeightHero900:"52px",lineHeightHero1000:"92px"},WA={fontWeightRegular:400,fontWeightMedium:500,fontWeightSemibold:600,fontWeightBold:700},GA={fontFamilyBase:"'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif",fontFamilyMonospace:"Consolas, 'Courier New', Courier, monospace",fontFamilyNumeric:"Bahnschrift, 'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif"},VA={strokeWidthThin:"1px",strokeWidthThick:"2px",strokeWidthThicker:"3px",strokeWidthThickest:"4px"};function YA(e,t,r=""){return{[`shadow2${r}`]:`0 0 2px ${e}, 0 1px 2px ${t}`,[`shadow4${r}`]:`0 0 2px ${e}, 0 2px 4px ${t}`,[`shadow8${r}`]:`0 0 2px ${e}, 0 4px 8px ${t}`,[`shadow16${r}`]:`0 0 2px ${e}, 0 8px 16px ${t}`,[`shadow28${r}`]:`0 0 8px ${e}, 0 14px 28px ${t}`,[`shadow64${r}`]:`0 0 8px ${e}, 0 32px 64px ${t}`}}const QA={durationUltraFast:"50ms",durationFaster:"100ms",durationFast:"150ms",durationNormal:"200ms",durationGentle:"250ms",durationSlow:"300ms",durationSlower:"400ms",durationUltraSlow:"500ms"},JA={curveAccelerateMax:"cubic-bezier(0.9,0.1,1,0.2)",curveAccelerateMid:"cubic-bezier(1,0,1,1)",curveAccelerateMin:"cubic-bezier(0.8,0,0.78,1)",curveDecelerateMax:"cubic-bezier(0.1,0.9,0.2,1)",curveDecelerateMid:"cubic-bezier(0,0,0,1)",curveDecelerateMin:"cubic-bezier(0.33,0,0.1,1)",curveEasyEaseMax:"cubic-bezier(0.8,0,0.2,1)",curveEasyEase:"cubic-bezier(0.33,0,0.67,1)",curveLinear:"cubic-bezier(0,0,1,1)"},XA="10px",ZA="12px",ek="16px",tk="20px",rk="24px",nk="32px",ok={spacingHorizontalNone:"0",spacingHorizontalXXS:"2px",spacingHorizontalXS:"4px",spacingHorizontalSNudge:"6px",spacingHorizontalS:"8px",spacingHorizontalMNudge:XA,spacingHorizontalM:ZA,spacingHorizontalL:ek,spacingHorizontalXL:tk,spacingHorizontalXXL:rk,spacingHorizontalXXXL:nk},ik={spacingVerticalNone:"0",spacingVerticalXXS:"2px",spacingVerticalXS:"4px",spacingVerticalSNudge:"6px",spacingVerticalS:"8px",spacingVerticalMNudge:XA,spacingVerticalM:ZA,spacingVerticalL:ek,spacingVerticalXL:tk,spacingVerticalXXL:rk,spacingVerticalXXXL:nk},ak=(()=>{const e=(e=>({colorNeutralForeground1:vA,colorNeutralForeground1Hover:vA,colorNeutralForeground1Pressed:vA,colorNeutralForeground1Selected:vA,colorNeutralForeground2:bA,colorNeutralForeground2Hover:vA,colorNeutralForeground2Pressed:vA,colorNeutralForeground2Selected:vA,colorNeutralForeground2BrandHover:e[80],colorNeutralForeground2BrandPressed:e[70],colorNeutralForeground2BrandSelected:e[80],colorNeutralForeground3:wA,colorNeutralForeground3Hover:bA,colorNeutralForeground3Pressed:bA,colorNeutralForeground3Selected:bA,colorNeutralForeground3BrandHover:e[80],colorNeutralForeground3BrandPressed:e[70],colorNeutralForeground3BrandSelected:e[80],colorNeutralForeground4:"#707070",colorNeutralForegroundDisabled:CA,colorNeutralForegroundInvertedDisabled:_A,colorBrandForegroundLink:e[70],colorBrandForegroundLinkHover:e[60],colorBrandForegroundLinkPressed:e[40],colorBrandForegroundLinkSelected:e[70],colorNeutralForeground2Link:bA,colorNeutralForeground2LinkHover:vA,colorNeutralForeground2LinkPressed:vA,colorNeutralForeground2LinkSelected:vA,colorCompoundBrandForeground1:e[80],colorCompoundBrandForeground1Hover:e[70],colorCompoundBrandForeground1Pressed:e[60],colorBrandForeground1:e[80],colorBrandForeground2:e[70],colorBrandForeground2Hover:e[60],colorBrandForeground2Pressed:e[30],colorNeutralForeground1Static:vA,colorNeutralForegroundStaticInverted:OA,colorNeutralForegroundInverted:OA,colorNeutralForegroundInvertedHover:OA,colorNeutralForegroundInvertedPressed:OA,colorNeutralForegroundInvertedSelected:OA,colorNeutralForegroundInverted2:OA,colorNeutralForegroundOnBrand:OA,colorNeutralForegroundInvertedLink:OA,colorNeutralForegroundInvertedLinkHover:OA,colorNeutralForegroundInvertedLinkPressed:OA,colorNeutralForegroundInvertedLinkSelected:OA,colorBrandForegroundInverted:e[100],colorBrandForegroundInvertedHover:e[110],colorBrandForegroundInvertedPressed:e[100],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:OA,colorNeutralBackground1Hover:IA,colorNeutralBackground1Pressed:AA,colorNeutralBackground1Selected:SA,colorNeutralBackground2:xA,colorNeutralBackground2Hover:TA,colorNeutralBackground2Pressed:"#dbdbdb",colorNeutralBackground2Selected:kA,colorNeutralBackground3:IA,colorNeutralBackground3Hover:SA,colorNeutralBackground3Pressed:"#d6d6d6",colorNeutralBackground3Selected:AA,colorNeutralBackground4:TA,colorNeutralBackground4Hover:xA,colorNeutralBackground4Pressed:IA,colorNeutralBackground4Selected:OA,colorNeutralBackground5:SA,colorNeutralBackground5Hover:IA,colorNeutralBackground5Pressed:TA,colorNeutralBackground5Selected:xA,colorNeutralBackground6:kA,colorNeutralBackgroundInverted:"#292929",colorNeutralBackgroundStatic:"#333333",colorNeutralBackgroundAlpha:EA,colorNeutralBackgroundAlpha2:"rgba(255, 255, 255, 0.8)",colorSubtleBackground:"transparent",colorSubtleBackgroundHover:IA,colorSubtleBackgroundPressed:AA,colorSubtleBackgroundSelected:SA,colorSubtleBackgroundLightAlphaHover:"rgba(255, 255, 255, 0.7)",colorSubtleBackgroundLightAlphaPressed:EA,colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:RA,colorSubtleBackgroundInvertedPressed:"rgba(0, 0, 0, 0.3)",colorSubtleBackgroundInvertedSelected:"rgba(0, 0, 0, 0.2)",colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:TA,colorNeutralBackgroundInvertedDisabled:"rgba(255, 255, 255, 0.1)",colorNeutralStencil1:kA,colorNeutralStencil2:xA,colorNeutralStencil1Alpha:RA,colorNeutralStencil2Alpha:PA,colorBackgroundOverlay:"rgba(0, 0, 0, 0.4)",colorScrollbarOverlay:"rgba(0, 0, 0, 0.5)",colorBrandBackground:e[80],colorBrandBackgroundHover:e[70],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[80],colorCompoundBrandBackgroundHover:e[70],colorCompoundBrandBackgroundPressed:e[60],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[160],colorBrandBackground2Hover:e[150],colorBrandBackground2Pressed:e[130],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:OA,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:xA,colorNeutralCardBackgroundHover:OA,colorNeutralCardBackgroundPressed:IA,colorNeutralCardBackgroundSelected:SA,colorNeutralCardBackgroundDisabled:TA,colorNeutralStrokeAccessible:wA,colorNeutralStrokeAccessibleHover:"#575757",colorNeutralStrokeAccessiblePressed:"#4d4d4d",colorNeutralStrokeAccessibleSelected:e[80],colorNeutralStroke1:"#d1d1d1",colorNeutralStroke1Hover:"#c7c7c7",colorNeutralStroke1Pressed:"#b3b3b3",colorNeutralStroke1Selected:CA,colorNeutralStroke2:AA,colorNeutralStroke3:TA,colorNeutralStrokeSubtle:AA,colorNeutralStrokeOnBrand:OA,colorNeutralStrokeOnBrand2:OA,colorNeutralStrokeOnBrand2Hover:OA,colorNeutralStrokeOnBrand2Pressed:OA,colorNeutralStrokeOnBrand2Selected:OA,colorBrandStroke1:e[80],colorBrandStroke2:e[140],colorBrandStroke2Hover:e[120],colorBrandStroke2Pressed:e[80],colorBrandStroke2Contrast:e[140],colorCompoundBrandStroke:e[80],colorCompoundBrandStrokeHover:e[70],colorCompoundBrandStrokePressed:e[60],colorNeutralStrokeDisabled:AA,colorNeutralStrokeInvertedDisabled:_A,colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:PA,colorNeutralStrokeAlpha2:"rgba(255, 255, 255, 0.2)",colorStrokeFocus1:OA,colorStrokeFocus2:"#000000",colorNeutralShadowAmbient:"rgba(0,0,0,0.12)",colorNeutralShadowKey:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.06)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.07)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.20)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.24)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))({10:"#061724",20:"#082338",30:"#0a2e4a",40:"#0c3b5e",50:"#0e4775",60:"#0f548c",70:"#115ea3",80:"#0f6cbd",90:"#2886de",100:"#479ef5",110:"#62abf5",120:"#77b7f7",130:"#96c6fa",140:"#b4d6fa",150:"#cfe4fa",160:"#ebf3fc"});return{...jA,...zA,...KA,...GA,...WA,...VA,...ok,...ik,...QA,...JA,...e,...DA,...UA,...YA(e.colorNeutralShadowAmbient,e.colorNeutralShadowKey),...YA(e.colorBrandShadowAmbient,e.colorBrandShadowKey,"Brand")}})();var sk=document.getElementById("container"),ck=sk?(0,i.H)(sk):void 0;Office.onReady((function(){null==ck||ck.render(n.createElement(yA,{theme:ak},n.createElement(qw,null)))}))},71354:function(e){e.exports=function(e){var t=e[1],r=e[3];if(!r)return t;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),i="/*# ".concat(o," */");return[t].concat([i]).join("\n")}return[t].join("\n")}},73404:function(e,t,r){e.exports=r(3072)},74848:function(e,t,r){e.exports=r(21020)},76314:function(e){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,n,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(n)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(a[c]=!0)}for(var l=0;l<e.length;l++){var u=[].concat(e[l]);n&&a[u[0]]||(void 0!==i&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=i),r&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=r):u[2]=r),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),t.push(u))}},t}},77659:function(e){var t={};e.exports=function(e,r){var n=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},85072:function(e){var t=[];function r(e){for(var r=-1,n=0;n<t.length;n++)if(t[n].identifier===e){r=n;break}return r}function n(e,n){for(var i={},a=[],s=0;s<e.length;s++){var c=e[s],l=n.base?c[0]+n.base:c[0],u=i[l]||0,d="".concat(l," ").concat(u);i[l]=u+1;var h=r(d),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var f=o(p,n);n.byIndex=s,t.splice(s,0,{identifier:d,updater:f,references:1})}a.push(d)}return a}function o(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,o){var i=n(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var s=r(i[a]);t[s].references--}for(var c=n(e,o),l=0;l<i.length;l++){var u=r(i[l]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}i=c}}},96674:function(e,t,r){var n=r(71354),o=r.n(n),i=r(76314),a=r.n(i)()(o());a.push([e.id,'@-webkit-keyframes notyf-fadeinup{0%{opacity:0;transform:translateY(25%)}to{opacity:1;transform:translateY(0)}}@keyframes notyf-fadeinup{0%{opacity:0;transform:translateY(25%)}to{opacity:1;transform:translateY(0)}}@-webkit-keyframes notyf-fadeinleft{0%{opacity:0;transform:translateX(25%)}to{opacity:1;transform:translateX(0)}}@keyframes notyf-fadeinleft{0%{opacity:0;transform:translateX(25%)}to{opacity:1;transform:translateX(0)}}@-webkit-keyframes notyf-fadeoutright{0%{opacity:1;transform:translateX(0)}to{opacity:0;transform:translateX(25%)}}@keyframes notyf-fadeoutright{0%{opacity:1;transform:translateX(0)}to{opacity:0;transform:translateX(25%)}}@-webkit-keyframes notyf-fadeoutdown{0%{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(25%)}}@keyframes notyf-fadeoutdown{0%{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(25%)}}@-webkit-keyframes ripple{0%{transform:scale(0) translateY(-45%) translateX(13%)}to{transform:scale(1) translateY(-45%) translateX(13%)}}@keyframes ripple{0%{transform:scale(0) translateY(-45%) translateX(13%)}to{transform:scale(1) translateY(-45%) translateX(13%)}}.notyf{position:fixed;top:0;left:0;height:100%;width:100%;color:#fff;z-index:9999;display:flex;flex-direction:column;align-items:flex-end;justify-content:flex-end;pointer-events:none;box-sizing:border-box;padding:20px}.notyf__icon--error,.notyf__icon--success{height:21px;width:21px;background:#fff;border-radius:50%;display:block;margin:0 auto;position:relative}.notyf__icon--error:after,.notyf__icon--error:before{content:"";background:currentColor;display:block;position:absolute;width:3px;border-radius:3px;left:9px;height:12px;top:5px}.notyf__icon--error:after{transform:rotate(-45deg)}.notyf__icon--error:before{transform:rotate(45deg)}.notyf__icon--success:after,.notyf__icon--success:before{content:"";background:currentColor;display:block;position:absolute;width:3px;border-radius:3px}.notyf__icon--success:after{height:6px;transform:rotate(-45deg);top:9px;left:6px}.notyf__icon--success:before{height:11px;transform:rotate(45deg);top:5px;left:10px}.notyf__toast{display:block;overflow:hidden;pointer-events:auto;-webkit-animation:notyf-fadeinup .3s ease-in forwards;animation:notyf-fadeinup .3s ease-in forwards;box-shadow:0 3px 7px 0 rgba(0,0,0,.25);position:relative;padding:0 15px;border-radius:2px;max-width:300px;transform:translateY(25%);box-sizing:border-box;flex-shrink:0}.notyf__toast--disappear{transform:translateY(0);-webkit-animation:notyf-fadeoutdown .3s forwards;animation:notyf-fadeoutdown .3s forwards;-webkit-animation-delay:.25s;animation-delay:.25s}.notyf__toast--disappear .notyf__icon,.notyf__toast--disappear .notyf__message{-webkit-animation:notyf-fadeoutdown .3s forwards;animation:notyf-fadeoutdown .3s forwards;opacity:1;transform:translateY(0)}.notyf__toast--disappear .notyf__dismiss{-webkit-animation:notyf-fadeoutright .3s forwards;animation:notyf-fadeoutright .3s forwards;opacity:1;transform:translateX(0)}.notyf__toast--disappear .notyf__message{-webkit-animation-delay:.05s;animation-delay:.05s}.notyf__toast--upper{margin-bottom:20px}.notyf__toast--lower{margin-top:20px}.notyf__toast--dismissible .notyf__wrapper{padding-right:30px}.notyf__ripple{height:400px;width:400px;position:absolute;transform-origin:bottom right;right:0;top:0;border-radius:50%;transform:scale(0) translateY(-51%) translateX(13%);z-index:5;-webkit-animation:ripple .4s ease-out forwards;animation:ripple .4s ease-out forwards}.notyf__wrapper{display:flex;align-items:center;padding-top:17px;padding-bottom:17px;padding-right:15px;border-radius:3px;position:relative;z-index:10}.notyf__icon{width:22px;text-align:center;font-size:1.3em;opacity:0;-webkit-animation:notyf-fadeinup .3s forwards;animation:notyf-fadeinup .3s forwards;-webkit-animation-delay:.3s;animation-delay:.3s;margin-right:13px}.notyf__dismiss{position:absolute;top:0;right:0;height:100%;width:26px;margin-right:-15px;-webkit-animation:notyf-fadeinleft .3s forwards;animation:notyf-fadeinleft .3s forwards;-webkit-animation-delay:.35s;animation-delay:.35s;opacity:0}.notyf__dismiss-btn{background-color:rgba(0,0,0,.25);border:none;cursor:pointer;transition:opacity .2s ease,background-color .2s ease;outline:none;opacity:.35;height:100%;width:100%}.notyf__dismiss-btn:after,.notyf__dismiss-btn:before{content:"";background:#fff;height:12px;width:2px;border-radius:3px;position:absolute;left:calc(50% - 1px);top:calc(50% - 5px)}.notyf__dismiss-btn:after{transform:rotate(-45deg)}.notyf__dismiss-btn:before{transform:rotate(45deg)}.notyf__dismiss-btn:hover{opacity:.7;background-color:rgba(0,0,0,.15)}.notyf__dismiss-btn:active{opacity:.8}.notyf__message{vertical-align:middle;position:relative;opacity:0;-webkit-animation:notyf-fadeinup .3s forwards;animation:notyf-fadeinup .3s forwards;-webkit-animation-delay:.25s;animation-delay:.25s;line-height:1.5em}@media only screen and (max-width:480px){.notyf{padding:0}.notyf__ripple{height:600px;width:600px;-webkit-animation-duration:.5s;animation-duration:.5s}.notyf__toast{max-width:none;border-radius:0;box-shadow:0 -2px 7px 0 rgba(0,0,0,.13);width:100%}.notyf__dismiss{width:56px}}',"",{version:3,sources:["webpack://./node_modules/notyf/notyf.min.css"],names:[],mappings:"AAAA,kCAAkC,GAAG,SAAS,CAAC,yBAAyB,CAAC,GAAG,SAAS,CAAC,uBAAuB,CAAC,CAAC,0BAA0B,GAAG,SAAS,CAAC,yBAAyB,CAAC,GAAG,SAAS,CAAC,uBAAuB,CAAC,CAAC,oCAAoC,GAAG,SAAS,CAAC,yBAAyB,CAAC,GAAG,SAAS,CAAC,uBAAuB,CAAC,CAAC,4BAA4B,GAAG,SAAS,CAAC,yBAAyB,CAAC,GAAG,SAAS,CAAC,uBAAuB,CAAC,CAAC,sCAAsC,GAAG,SAAS,CAAC,uBAAuB,CAAC,GAAG,SAAS,CAAC,yBAAyB,CAAC,CAAC,8BAA8B,GAAG,SAAS,CAAC,uBAAuB,CAAC,GAAG,SAAS,CAAC,yBAAyB,CAAC,CAAC,qCAAqC,GAAG,SAAS,CAAC,uBAAuB,CAAC,GAAG,SAAS,CAAC,yBAAyB,CAAC,CAAC,6BAA6B,GAAG,SAAS,CAAC,uBAAuB,CAAC,GAAG,SAAS,CAAC,yBAAyB,CAAC,CAAC,0BAA0B,GAAG,mDAAmD,CAAC,GAAG,mDAAmD,CAAC,CAAC,kBAAkB,GAAG,mDAAmD,CAAC,GAAG,mDAAmD,CAAC,CAAC,OAAO,cAAc,CAAC,KAAK,CAAC,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,UAAU,CAAC,YAAY,CAAC,YAAY,CAAC,qBAAqB,CAAC,oBAAoB,CAAC,wBAAwB,CAAC,mBAAmB,CAAC,qBAAqB,CAAC,YAAY,CAAC,0CAA0C,WAAW,CAAC,UAAU,CAAC,eAAe,CAAC,iBAAiB,CAAC,aAAa,CAAC,aAAa,CAAC,iBAAiB,CAAC,qDAAqD,UAAU,CAAC,uBAAuB,CAAC,aAAa,CAAC,iBAAiB,CAAC,SAAS,CAAC,iBAAiB,CAAC,QAAQ,CAAC,WAAW,CAAC,OAAO,CAAC,0BAA0B,wBAAwB,CAAC,2BAA2B,uBAAuB,CAAC,yDAAyD,UAAU,CAAC,uBAAuB,CAAC,aAAa,CAAC,iBAAiB,CAAC,SAAS,CAAC,iBAAiB,CAAC,4BAA4B,UAAU,CAAC,wBAAwB,CAAC,OAAO,CAAC,QAAQ,CAAC,6BAA6B,WAAW,CAAC,uBAAuB,CAAC,OAAO,CAAC,SAAS,CAAC,cAAc,aAAa,CAAC,eAAe,CAAC,mBAAmB,CAAC,qDAAqD,CAAC,6CAA6C,CAAC,sCAAsC,CAAC,iBAAiB,CAAC,cAAc,CAAC,iBAAiB,CAAC,eAAe,CAAC,yBAAyB,CAAC,qBAAqB,CAAC,aAAa,CAAC,yBAAyB,uBAAuB,CAAC,gDAAgD,CAAC,wCAAwC,CAAC,4BAA4B,CAAC,oBAAoB,CAAC,+EAA+E,gDAAgD,CAAC,wCAAwC,CAAC,SAAS,CAAC,uBAAuB,CAAC,yCAAyC,iDAAiD,CAAC,yCAAyC,CAAC,SAAS,CAAC,uBAAuB,CAAC,yCAAyC,4BAA4B,CAAC,oBAAoB,CAAC,qBAAqB,kBAAkB,CAAC,qBAAqB,eAAe,CAAC,2CAA2C,kBAAkB,CAAC,eAAe,YAAY,CAAC,WAAW,CAAC,iBAAiB,CAAC,6BAA6B,CAAC,OAAO,CAAC,KAAK,CAAC,iBAAiB,CAAC,mDAAmD,CAAC,SAAS,CAAC,8CAA8C,CAAC,sCAAsC,CAAC,gBAAgB,YAAY,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,UAAU,CAAC,aAAa,UAAU,CAAC,iBAAiB,CAAC,eAAe,CAAC,SAAS,CAAC,6CAA6C,CAAC,qCAAqC,CAAC,2BAA2B,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,gBAAgB,iBAAiB,CAAC,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,UAAU,CAAC,kBAAkB,CAAC,+CAA+C,CAAC,uCAAuC,CAAC,4BAA4B,CAAC,oBAAoB,CAAC,SAAS,CAAC,oBAAoB,gCAAgC,CAAC,WAAW,CAAC,cAAc,CAAC,qDAAqD,CAAC,YAAY,CAAC,WAAW,CAAC,WAAW,CAAC,UAAU,CAAC,qDAAqD,UAAU,CAAC,eAAe,CAAC,WAAW,CAAC,SAAS,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,oBAAoB,CAAC,mBAAmB,CAAC,0BAA0B,wBAAwB,CAAC,2BAA2B,uBAAuB,CAAC,0BAA0B,UAAU,CAAC,gCAAgC,CAAC,2BAA2B,UAAU,CAAC,gBAAgB,qBAAqB,CAAC,iBAAiB,CAAC,SAAS,CAAC,6CAA6C,CAAC,qCAAqC,CAAC,4BAA4B,CAAC,oBAAoB,CAAC,iBAAiB,CAAC,yCAAyC,OAAO,SAAS,CAAC,eAAe,YAAY,CAAC,WAAW,CAAC,8BAA8B,CAAC,sBAAsB,CAAC,cAAc,cAAc,CAAC,eAAe,CAAC,uCAAuC,CAAC,UAAU,CAAC,gBAAgB,UAAU,CAAC",sourcesContent:['@-webkit-keyframes notyf-fadeinup{0%{opacity:0;transform:translateY(25%)}to{opacity:1;transform:translateY(0)}}@keyframes notyf-fadeinup{0%{opacity:0;transform:translateY(25%)}to{opacity:1;transform:translateY(0)}}@-webkit-keyframes notyf-fadeinleft{0%{opacity:0;transform:translateX(25%)}to{opacity:1;transform:translateX(0)}}@keyframes notyf-fadeinleft{0%{opacity:0;transform:translateX(25%)}to{opacity:1;transform:translateX(0)}}@-webkit-keyframes notyf-fadeoutright{0%{opacity:1;transform:translateX(0)}to{opacity:0;transform:translateX(25%)}}@keyframes notyf-fadeoutright{0%{opacity:1;transform:translateX(0)}to{opacity:0;transform:translateX(25%)}}@-webkit-keyframes notyf-fadeoutdown{0%{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(25%)}}@keyframes notyf-fadeoutdown{0%{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(25%)}}@-webkit-keyframes ripple{0%{transform:scale(0) translateY(-45%) translateX(13%)}to{transform:scale(1) translateY(-45%) translateX(13%)}}@keyframes ripple{0%{transform:scale(0) translateY(-45%) translateX(13%)}to{transform:scale(1) translateY(-45%) translateX(13%)}}.notyf{position:fixed;top:0;left:0;height:100%;width:100%;color:#fff;z-index:9999;display:flex;flex-direction:column;align-items:flex-end;justify-content:flex-end;pointer-events:none;box-sizing:border-box;padding:20px}.notyf__icon--error,.notyf__icon--success{height:21px;width:21px;background:#fff;border-radius:50%;display:block;margin:0 auto;position:relative}.notyf__icon--error:after,.notyf__icon--error:before{content:"";background:currentColor;display:block;position:absolute;width:3px;border-radius:3px;left:9px;height:12px;top:5px}.notyf__icon--error:after{transform:rotate(-45deg)}.notyf__icon--error:before{transform:rotate(45deg)}.notyf__icon--success:after,.notyf__icon--success:before{content:"";background:currentColor;display:block;position:absolute;width:3px;border-radius:3px}.notyf__icon--success:after{height:6px;transform:rotate(-45deg);top:9px;left:6px}.notyf__icon--success:before{height:11px;transform:rotate(45deg);top:5px;left:10px}.notyf__toast{display:block;overflow:hidden;pointer-events:auto;-webkit-animation:notyf-fadeinup .3s ease-in forwards;animation:notyf-fadeinup .3s ease-in forwards;box-shadow:0 3px 7px 0 rgba(0,0,0,.25);position:relative;padding:0 15px;border-radius:2px;max-width:300px;transform:translateY(25%);box-sizing:border-box;flex-shrink:0}.notyf__toast--disappear{transform:translateY(0);-webkit-animation:notyf-fadeoutdown .3s forwards;animation:notyf-fadeoutdown .3s forwards;-webkit-animation-delay:.25s;animation-delay:.25s}.notyf__toast--disappear .notyf__icon,.notyf__toast--disappear .notyf__message{-webkit-animation:notyf-fadeoutdown .3s forwards;animation:notyf-fadeoutdown .3s forwards;opacity:1;transform:translateY(0)}.notyf__toast--disappear .notyf__dismiss{-webkit-animation:notyf-fadeoutright .3s forwards;animation:notyf-fadeoutright .3s forwards;opacity:1;transform:translateX(0)}.notyf__toast--disappear .notyf__message{-webkit-animation-delay:.05s;animation-delay:.05s}.notyf__toast--upper{margin-bottom:20px}.notyf__toast--lower{margin-top:20px}.notyf__toast--dismissible .notyf__wrapper{padding-right:30px}.notyf__ripple{height:400px;width:400px;position:absolute;transform-origin:bottom right;right:0;top:0;border-radius:50%;transform:scale(0) translateY(-51%) translateX(13%);z-index:5;-webkit-animation:ripple .4s ease-out forwards;animation:ripple .4s ease-out forwards}.notyf__wrapper{display:flex;align-items:center;padding-top:17px;padding-bottom:17px;padding-right:15px;border-radius:3px;position:relative;z-index:10}.notyf__icon{width:22px;text-align:center;font-size:1.3em;opacity:0;-webkit-animation:notyf-fadeinup .3s forwards;animation:notyf-fadeinup .3s forwards;-webkit-animation-delay:.3s;animation-delay:.3s;margin-right:13px}.notyf__dismiss{position:absolute;top:0;right:0;height:100%;width:26px;margin-right:-15px;-webkit-animation:notyf-fadeinleft .3s forwards;animation:notyf-fadeinleft .3s forwards;-webkit-animation-delay:.35s;animation-delay:.35s;opacity:0}.notyf__dismiss-btn{background-color:rgba(0,0,0,.25);border:none;cursor:pointer;transition:opacity .2s ease,background-color .2s ease;outline:none;opacity:.35;height:100%;width:100%}.notyf__dismiss-btn:after,.notyf__dismiss-btn:before{content:"";background:#fff;height:12px;width:2px;border-radius:3px;position:absolute;left:calc(50% - 1px);top:calc(50% - 5px)}.notyf__dismiss-btn:after{transform:rotate(-45deg)}.notyf__dismiss-btn:before{transform:rotate(45deg)}.notyf__dismiss-btn:hover{opacity:.7;background-color:rgba(0,0,0,.15)}.notyf__dismiss-btn:active{opacity:.8}.notyf__message{vertical-align:middle;position:relative;opacity:0;-webkit-animation:notyf-fadeinup .3s forwards;animation:notyf-fadeinup .3s forwards;-webkit-animation-delay:.25s;animation-delay:.25s;line-height:1.5em}@media only screen and (max-width:480px){.notyf{padding:0}.notyf__ripple{height:600px;width:600px;-webkit-animation-duration:.5s;animation-duration:.5s}.notyf__toast{max-width:none;border-radius:0;box-shadow:0 -2px 7px 0 rgba(0,0,0,.13);width:100%}.notyf__dismiss{width:56px}}'],sourceRoot:""}]),t.A=a},97825:function(e){e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var o=void 0!==r.layer;o&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,o&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}}},function(e){var t=function(t){return e(e.s=t)};t(56839),t(39046)}]);
//# sourceMappingURL=taskpane.js.map